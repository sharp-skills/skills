{"d": [{"url": "https://api.github.com/repos/knex/knex/issues/1833", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/1833/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/1833/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/1833/events", "html_url": "https://github.com/knex/knex/issues/1833", "id": 195940904, "node_id": "MDU6SXNzdWUxOTU5NDA5MDQ=", "number": 1833, "title": "Reconnecting after database server disconnect/reconnect", "user": {"login": "ty10r", "id": 4532146, "node_id": "MDQ6VXNlcjQ1MzIxNDY=", "avatar_url": "https://avatars.githubusercontent.com/u/4532146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ty10r", "html_url": "https://github.com/ty10r", "followers_url": "https://api.github.com/users/ty10r/followers", "following_url": "https://api.github.com/users/ty10r/following{/other_user}", "gists_url": "https://api.github.com/users/ty10r/gists{/gist_id}", "starred_url": "https://api.github.com/users/ty10r/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ty10r/subscriptions", "organizations_url": "https://api.github.com/users/ty10r/orgs", "repos_url": "https://api.github.com/users/ty10r/repos", "events_url": "https://api.github.com/users/ty10r/events{/privacy}", "received_events_url": "https://api.github.com/users/ty10r/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 303314920, "node_id": "MDU6TGFiZWwzMDMzMTQ5MjA=", "url": "https://api.github.com/repos/knex/knex/labels/more%20information%20requested", "name": "more information requested", "color": "d4c5f9", "default": false, "description": ""}, {"id": 722495428, "node_id": "MDU6TGFiZWw3MjI0OTU0Mjg=", "url": "https://api.github.com/repos/knex/knex/labels/help%20wanted", "name": "help wanted", "color": "75eaad", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 74, "created_at": "2016-12-15T23:10:02Z", "updated_at": "2021-08-03T23:03:45Z", "closed_at": "2018-11-06T08:42:11Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I searched through the issues to find if others are having trouble attempting to reconnect.\r\n\r\nIt's been a very long time since these two:\r\nhttps://github.com/tgriesser/knex/issues/1341\r\nhttps://github.com/tgriesser/knex/issues/936\r\n\r\nMost of the suggestions I have seen in the issues so far are relying on `pool2` and include configuration for `requestTimeout`.\r\n\r\nI am on version `0.12.2` of knex, which no longer uses `pool2`. I also can no longer see implementation of `ping` in `src/client.js`.\r\n\r\nI'm running tests where I use docker to run these steps:\r\n\r\n1) Spin up postgres db in container.\r\n2) Start knex/connect to postgres.\r\n3) Run a test query, evaluate success.\r\n4) Stop postgres db in container.\r\n5) Run test query again, evaluate failure (with config: `{pool: {acquireTimeoutMillis: XXXX}, acquireConnectionTimeout: XXXX)\r\n6) Restart postgres db in container.\r\n7) Run test query again, evaluate success.\r\n\r\nStep 7 is failing in the same way step 5 does.\r\n\r\nI assumed knex would automatically attempt to reconnect. Is there a way I can cause a reconnection?\r\n\r\nIf you'd like, I can post this question instead at one of the past conversations on reconnection. I thought it was worth having a new conversation since most of the other conversations include only answers from before switching to `generic-pool`.", "closed_by": {"login": "elhigu", "id": 696345, "node_id": "MDQ6VXNlcjY5NjM0NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/696345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elhigu", "html_url": "https://github.com/elhigu", "followers_url": "https://api.github.com/users/elhigu/followers", "following_url": "https://api.github.com/users/elhigu/following{/other_user}", "gists_url": "https://api.github.com/users/elhigu/gists{/gist_id}", "starred_url": "https://api.github.com/users/elhigu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elhigu/subscriptions", "organizations_url": "https://api.github.com/users/elhigu/orgs", "repos_url": "https://api.github.com/users/elhigu/repos", "events_url": "https://api.github.com/users/elhigu/events{/privacy}", "received_events_url": "https://api.github.com/users/elhigu/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/1833/reactions", "total_count": 18, "+1": 18, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/1833/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/2321", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/2321/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/2321/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/2321/events", "html_url": "https://github.com/knex/knex/issues/2321", "id": 273333591, "node_id": "MDU6SXNzdWUyNzMzMzM1OTE=", "number": 2321, "title": "Can't add new command when connection is in closed state", "user": {"login": "tuananh", "id": 627278, "node_id": "MDQ6VXNlcjYyNzI3OA==", "avatar_url": "https://avatars.githubusercontent.com/u/627278?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tuananh", "html_url": "https://github.com/tuananh", "followers_url": "https://api.github.com/users/tuananh/followers", "following_url": "https://api.github.com/users/tuananh/following{/other_user}", "gists_url": "https://api.github.com/users/tuananh/gists{/gist_id}", "starred_url": "https://api.github.com/users/tuananh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tuananh/subscriptions", "organizations_url": "https://api.github.com/users/tuananh/orgs", "repos_url": "https://api.github.com/users/tuananh/repos", "events_url": "https://api.github.com/users/tuananh/events{/privacy}", "received_events_url": "https://api.github.com/users/tuananh/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 44, "created_at": "2017-11-13T07:26:40Z", "updated_at": "2019-10-08T10:40:47Z", "closed_at": "2017-11-19T16:43:29Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "This happened to me today when i upgrade to `0.14.0`. Not sure when the bug was introduced.\r\n\r\nAlso, i saw this along with the above message: `This socket has been ended by the other party`\r\n\r\nPreviously working version seems to be 0.13.0\r\n\r\nnode 8.9.1, knex 0.14.0, \"mysql2\": \"1.4.2\"", "closed_by": {"login": "elhigu", "id": 696345, "node_id": "MDQ6VXNlcjY5NjM0NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/696345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elhigu", "html_url": "https://github.com/elhigu", "followers_url": "https://api.github.com/users/elhigu/followers", "following_url": "https://api.github.com/users/elhigu/following{/other_user}", "gists_url": "https://api.github.com/users/elhigu/gists{/gist_id}", "starred_url": "https://api.github.com/users/elhigu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elhigu/subscriptions", "organizations_url": "https://api.github.com/users/elhigu/orgs", "repos_url": "https://api.github.com/users/elhigu/repos", "events_url": "https://api.github.com/users/elhigu/events{/privacy}", "received_events_url": "https://api.github.com/users/elhigu/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/2321/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/2321/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/385", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/385/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/385/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/385/events", "html_url": "https://github.com/knex/knex/issues/385", "id": 38159332, "node_id": "MDU6SXNzdWUzODE1OTMzMg==", "number": 385, "title": "Cannot create multiple PKs (mixin .increments with .primary)", "user": {"login": "hsz", "id": 108333, "node_id": "MDQ6VXNlcjEwODMzMw==", "avatar_url": "https://avatars.githubusercontent.com/u/108333?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hsz", "html_url": "https://github.com/hsz", "followers_url": "https://api.github.com/users/hsz/followers", "following_url": "https://api.github.com/users/hsz/following{/other_user}", "gists_url": "https://api.github.com/users/hsz/gists{/gist_id}", "starred_url": "https://api.github.com/users/hsz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hsz/subscriptions", "organizations_url": "https://api.github.com/users/hsz/orgs", "repos_url": "https://api.github.com/users/hsz/repos", "events_url": "https://api.github.com/users/hsz/events{/privacy}", "received_events_url": "https://api.github.com/users/hsz/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 232918327, "node_id": "MDU6TGFiZWwyMzI5MTgzMjc=", "url": "https://api.github.com/repos/knex/knex/labels/PR%20please", "name": "PR please", "color": "bfe5bf", "default": false, "description": null}, {"id": 2613875219, "node_id": "MDU6TGFiZWwyNjEzODc1MjE5", "url": "https://api.github.com/repos/knex/knex/labels/high%20priority", "name": "high priority", "color": "0277C3", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [{"login": "OlivierCavadenti", "id": 10152806, "node_id": "MDQ6VXNlcjEwMTUyODA2", "avatar_url": "https://avatars.githubusercontent.com/u/10152806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OlivierCavadenti", "html_url": "https://github.com/OlivierCavadenti", "followers_url": "https://api.github.com/users/OlivierCavadenti/followers", "following_url": "https://api.github.com/users/OlivierCavadenti/following{/other_user}", "gists_url": "https://api.github.com/users/OlivierCavadenti/gists{/gist_id}", "starred_url": "https://api.github.com/users/OlivierCavadenti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OlivierCavadenti/subscriptions", "organizations_url": "https://api.github.com/users/OlivierCavadenti/orgs", "repos_url": "https://api.github.com/users/OlivierCavadenti/repos", "events_url": "https://api.github.com/users/OlivierCavadenti/events{/privacy}", "received_events_url": "https://api.github.com/users/OlivierCavadenti/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 36, "created_at": "2014-07-18T09:06:46Z", "updated_at": "2022-01-16T00:59:30Z", "closed_at": "2022-01-03T19:55:24Z", "assignee": {"login": "OlivierCavadenti", "id": 10152806, "node_id": "MDQ6VXNlcjEwMTUyODA2", "avatar_url": "https://avatars.githubusercontent.com/u/10152806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OlivierCavadenti", "html_url": "https://github.com/OlivierCavadenti", "followers_url": "https://api.github.com/users/OlivierCavadenti/followers", "following_url": "https://api.github.com/users/OlivierCavadenti/following{/other_user}", "gists_url": "https://api.github.com/users/OlivierCavadenti/gists{/gist_id}", "starred_url": "https://api.github.com/users/OlivierCavadenti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OlivierCavadenti/subscriptions", "organizations_url": "https://api.github.com/users/OlivierCavadenti/orgs", "repos_url": "https://api.github.com/users/OlivierCavadenti/repos", "events_url": "https://api.github.com/users/OlivierCavadenti/events{/privacy}", "received_events_url": "https://api.github.com/users/OlivierCavadenti/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I want to create a table basing on following MySQL dump:\n\n```\nCREATE TABLE `my_table` (\n  `cmdId` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `deviceId` char(16) NOT NULL,\n  `fnNumber` int(10) unsigned DEFAULT NULL,\n  `chNumber` int(10) unsigned DEFAULT NULL,\n  `cmd` varchar(50) DEFAULT NULL,\n  `cmdDate` datetime DEFAULT NULL,\n  `delivered` tinyint(1) DEFAULT NULL,\n  PRIMARY KEY (`cmdId`,`deviceId`),\n  KEY `deviceId` (`deviceId`),\n  CONSTRAINT `tblcommands_ibfk_1` FOREIGN KEY (`deviceId`) REFERENCES `second_table` (`deviceId`) ON DELETE NO ACTION ON UPDATE NO ACTION\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n```\n\nMy knex looks like:\n\n```\nknex.schema.createTable('my_table', function(t) {\n    t.primary(['cmdId', 'deviceId']);\n    t.increments('cmdId');\n    t.string('deviceId', 16).notNullable().references('second_table.deviceId');\n    t.integer('fnNumber').unsigned();\n    t.integer('chNumber').unsigned();\n    t.string('cmd96', 50);\n    t.dateTime('cmdDate');\n    t.boolean('delivered');\n});\n```\n\nHowever there is a problem with primary keys. I get following error:\n\n```\nError: Multiple primary key defined\n```\n\nI assume that `increments` method already creates PK and `primary` method creates another one which causes an error.\n\nIs it possible to achieve this format of table ?\n", "closed_by": {"login": "OlivierCavadenti", "id": 10152806, "node_id": "MDQ6VXNlcjEwMTUyODA2", "avatar_url": "https://avatars.githubusercontent.com/u/10152806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OlivierCavadenti", "html_url": "https://github.com/OlivierCavadenti", "followers_url": "https://api.github.com/users/OlivierCavadenti/followers", "following_url": "https://api.github.com/users/OlivierCavadenti/following{/other_user}", "gists_url": "https://api.github.com/users/OlivierCavadenti/gists{/gist_id}", "starred_url": "https://api.github.com/users/OlivierCavadenti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OlivierCavadenti/subscriptions", "organizations_url": "https://api.github.com/users/OlivierCavadenti/orgs", "repos_url": "https://api.github.com/users/OlivierCavadenti/repos", "events_url": "https://api.github.com/users/OlivierCavadenti/events{/privacy}", "received_events_url": "https://api.github.com/users/OlivierCavadenti/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/385/reactions", "total_count": 9, "+1": 9, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/385/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/519", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/519/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/519/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/519/events", "html_url": "https://github.com/knex/knex/issues/519", "id": 44816649, "node_id": "MDU6SXNzdWU0NDgxNjY0OQ==", "number": 519, "title": "Conflict with Postgresql jsonb operators", "user": {"login": "metainfa", "id": 7137988, "node_id": "MDQ6VXNlcjcxMzc5ODg=", "avatar_url": "https://avatars.githubusercontent.com/u/7137988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/metainfa", "html_url": "https://github.com/metainfa", "followers_url": "https://api.github.com/users/metainfa/followers", "following_url": "https://api.github.com/users/metainfa/following{/other_user}", "gists_url": "https://api.github.com/users/metainfa/gists{/gist_id}", "starred_url": "https://api.github.com/users/metainfa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/metainfa/subscriptions", "organizations_url": "https://api.github.com/users/metainfa/orgs", "repos_url": "https://api.github.com/users/metainfa/repos", "events_url": "https://api.github.com/users/metainfa/events{/privacy}", "received_events_url": "https://api.github.com/users/metainfa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 33, "created_at": "2014-10-03T15:47:50Z", "updated_at": "2018-07-31T20:57:55Z", "closed_at": "2015-08-25T07:52:51Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Hi!\n\nI have sql:\n\n``` sql\nSELECT id, name, price, files->'photos'->0->>'name' as photo, annotation\nFROM product\nWHERE tags ?& array['17']\nORDER BY (tags->>'17')::int\nLIMIT 10\n\n```\n## If i run this sql direct in postgresql client it work fine\n## If i run this sql through node-postgres it work fine again:\n\n``` javascript\nvar pg = require('pg');\n\nvar connPg = \"postgres://user:password@localhost/mydbname\";\nvar clientPg = new pg.Client(connPg);\nvar sqlProductsByTags = [\n  \"SELECT id, name, price, files->'photos'->0->>'name' as photo, annotation \",\n  \"FROM product \",\n  \"WHERE tags ?& array['17'] \",\n  \"ORDER BY (tags->>'17')::int \",\n  \"LIMIT 10 \"\n];\n\nclientPg.connect(function(err) {\n  if(err) {\n    return console.error('could not connect to postgres', err);\n  }\n  //console.log('SQL = ' + sqlProductsByTags.join(''));\n\n  clientPg.query(sqlProductsByTags.join(''), function(err, result) {\n    if(err) {\n      return console.error('error select products by tags', err);\n    }\n\n    for(var i = 0, max = result.rows.length; i < max; i++) {\n      console.log('name: ' +  result.rows[i].name);\n    }\n\n    clientPg.end();\n  });\n});\n```\n## If i run raw sql by knex, it fail with error (below listed):\n\n``` javascript\nvar connPg = \"postgres://user:password@localhost/mydbname\"; \nvar pg = require('knex')({\n  client: 'pg',\n  connection: connPg\n});\nvar sqlProductsByTags = [\n  \"SELECT id, name, price, files->'photos'->0->>'name' as photo, annotation \",\n  \"FROM product \",\n  \"WHERE tags ?& array['17'] \",\n  \"ORDER BY (tags->>'17')::int \",\n  \"LIMIT 10 \"\n];\n\npg.raw(sqlProductsByTags.join(''))\n```\n\nThis Error\n\n``` sh\n{ [error: syntax error (at or near \"$1\")]\n  name: 'error',\n  length: 142,\n  severity: 'ERROR',\n  code: '42601',\n  detail: undefined,\n  hint: undefined,\n  position: '98',\n  internalPosition: undefined,\n  internalQuery: undefined,\n  where: undefined,\n  file: 'scan.l',\n  line: '1053',\n  routine: 'scanner_yyerror' }\n```\n\nI think that it fail because of i used jsonb operator '?&', precise only one symbol '?'\n[Reference to PostgreSQL JSONB operators](http://www.postgresql.org/docs/9.4/static/functions-json.html)\n", "closed_by": {"login": "rhys-vdw", "id": 822105, "node_id": "MDQ6VXNlcjgyMjEwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/822105?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rhys-vdw", "html_url": "https://github.com/rhys-vdw", "followers_url": "https://api.github.com/users/rhys-vdw/followers", "following_url": "https://api.github.com/users/rhys-vdw/following{/other_user}", "gists_url": "https://api.github.com/users/rhys-vdw/gists{/gist_id}", "starred_url": "https://api.github.com/users/rhys-vdw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rhys-vdw/subscriptions", "organizations_url": "https://api.github.com/users/rhys-vdw/orgs", "repos_url": "https://api.github.com/users/rhys-vdw/repos", "events_url": "https://api.github.com/users/rhys-vdw/events{/privacy}", "received_events_url": "https://api.github.com/users/rhys-vdw/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/519/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/519/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/3003", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/3003/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/3003/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/3003/events", "html_url": "https://github.com/knex/knex/issues/3003", "id": 400542289, "node_id": "MDU6SXNzdWU0MDA1NDIyODk=", "number": 3003, "title": "migrate:make fails with TypeScript", "user": {"login": "eioo", "id": 26361964, "node_id": "MDQ6VXNlcjI2MzYxOTY0", "avatar_url": "https://avatars.githubusercontent.com/u/26361964?v=4", "gravatar_id": "", "url": "https://api.github.com/users/eioo", "html_url": "https://github.com/eioo", "followers_url": "https://api.github.com/users/eioo/followers", "following_url": "https://api.github.com/users/eioo/following{/other_user}", "gists_url": "https://api.github.com/users/eioo/gists{/gist_id}", "starred_url": "https://api.github.com/users/eioo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/eioo/subscriptions", "organizations_url": "https://api.github.com/users/eioo/orgs", "repos_url": "https://api.github.com/users/eioo/repos", "events_url": "https://api.github.com/users/eioo/events{/privacy}", "received_events_url": "https://api.github.com/users/eioo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 75390800, "node_id": "MDU6TGFiZWw3NTM5MDgwMA==", "url": "https://api.github.com/repos/knex/knex/labels/migrations", "name": "migrations", "color": "eb6420", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 28, "created_at": "2019-01-18T02:10:19Z", "updated_at": "2024-10-09T08:59:31Z", "closed_at": "2019-06-14T06:44:03Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "# Environment\r\n\r\nKnex version: 0.16.3 (Using TypeScript knexfile)\r\nDatabase + version: PostgreSQL 10.5\r\nOS: Windows 10 Pro 64 Bit\r\n\r\n# Bug\r\n\r\nWhen running `knex migrate:make somename`, this is the output:\r\n```\r\nRequiring external module ts-node/register\r\nUsing environment: development\r\nTypeError [ERR_INVALID_ARG_TYPE]: The \"path\" argument must be of type string. Received type undefined\r\n    at assertPath (path.js:39:11)\r\n    at Object.resolve (path.js:166:7)\r\n    at directories.map.directory (X:\\Code\\node\\knextest\\node_modules\\knex\\lib\\migrate\\MigrationGenerator.js:82:28)\r\n    at Array.map (<anonymous>)\r\n    at MigrationGenerator._absoluteConfigDirs (X:\\Code\\node\\knextest\\node_modules\\knex\\lib\\migrate\\MigrationGenerator.js:81:24)\r\n    at MigrationGenerator._ensureFolder (X:\\Code\\node\\knextest\\node_modules\\knex\\lib\\migrate\\MigrationGenerator.js:41:23)\r\n    at MigrationGenerator.make (X:\\Code\\node\\knextest\\node_modules\\knex\\lib\\migrate\\MigrationGenerator.js:35:17)\r\n    at Migrator.make (X:\\Code\\node\\knextest\\node_modules\\knex\\lib\\migrate\\Migrator.js:122:27)\r\n    at Command.commander.command.description.option.action (X:\\Code\\node\\knextest\\node_modules\\knex\\bin\\cli.js:179:10)\r\n    at Command.listener (X:\\Code\\node\\knextest\\node_modules\\commander\\index.js:315:8)\r\n    at Command.emit (events.js:182:13)\r\n    at Command.parseArgs (X:\\Code\\node\\knextest\\node_modules\\commander\\index.js:654:12)\r\n    at Command.parse (X:\\Code\\node\\knextest\\node_modules\\commander\\index.js:474:21)\r\n    at Liftoff.invoke (X:\\Code\\node\\knextest\\node_modules\\knex\\bin\\cli.js:278:13)\r\n    at Liftoff.execute (X:\\Code\\node\\knextest\\node_modules\\liftoff\\index.js:203:12)\r\n    at module.exports (X:\\Code\\node\\knextest\\node_modules\\flagged-respawn\\index.js:51:3)\r\n```\r\n\r\nThis is the content of my `knexfile.ts`:\r\n\r\n```ts\r\nmodule.exports = {\r\n  development: {\r\n    client: 'pg',\r\n    connection: {\r\n      host: 'localhost',\r\n      database: 'postgres',\r\n      user: 'postgres',\r\n      password: 'pw',\r\n    },\r\n    migrations: {\r\n      directory: 'migrations',\r\n    },\r\n  },\r\n};\r\n```\r\n\r\nSome additional details:\r\n- `knex migrate:make somename` works if I change knexfile extension to `.js`. (knex 0.16.3)\r\n- `knex migrate:make somename` works like it should with TypeScript knexfile when using knex 0.15.1 and `@types/knex` 0.15.1 package.\r\n- I have not tried different database engines or the versions between knex 0.15.1 - 0.16.3.", "closed_by": {"login": "kibertoad", "id": 1847934, "node_id": "MDQ6VXNlcjE4NDc5MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1847934?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kibertoad", "html_url": "https://github.com/kibertoad", "followers_url": "https://api.github.com/users/kibertoad/followers", "following_url": "https://api.github.com/users/kibertoad/following{/other_user}", "gists_url": "https://api.github.com/users/kibertoad/gists{/gist_id}", "starred_url": "https://api.github.com/users/kibertoad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kibertoad/subscriptions", "organizations_url": "https://api.github.com/users/kibertoad/orgs", "repos_url": "https://api.github.com/users/kibertoad/repos", "events_url": "https://api.github.com/users/kibertoad/events{/privacy}", "received_events_url": "https://api.github.com/users/kibertoad/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/3003/reactions", "total_count": 13, "+1": 13, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/3003/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/1276", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/1276/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/1276/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/1276/events", "html_url": "https://github.com/knex/knex/issues/1276", "id": 140667706, "node_id": "MDU6SXNzdWUxNDA2Njc3MDY=", "number": 1276, "title": "If it's NULL, let it be NULL", "user": {"login": "aditbisa", "id": 16781093, "node_id": "MDQ6VXNlcjE2NzgxMDkz", "avatar_url": "https://avatars.githubusercontent.com/u/16781093?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aditbisa", "html_url": "https://github.com/aditbisa", "followers_url": "https://api.github.com/users/aditbisa/followers", "following_url": "https://api.github.com/users/aditbisa/following{/other_user}", "gists_url": "https://api.github.com/users/aditbisa/gists{/gist_id}", "starred_url": "https://api.github.com/users/aditbisa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aditbisa/subscriptions", "organizations_url": "https://api.github.com/users/aditbisa/orgs", "repos_url": "https://api.github.com/users/aditbisa/repos", "events_url": "https://api.github.com/users/aditbisa/events{/privacy}", "received_events_url": "https://api.github.com/users/aditbisa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 232918327, "node_id": "MDU6TGFiZWwyMzI5MTgzMjc=", "url": "https://api.github.com/repos/knex/knex/labels/PR%20please", "name": "PR please", "color": "bfe5bf", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 26, "created_at": "2016-03-14T13:05:32Z", "updated_at": "2019-05-23T08:23:45Z", "closed_at": "2018-10-19T14:21:39Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I have NULL data in DATE column. But when fetching using bookshelf (using knex), it's return `Thu Jan 01 1970 07:00:00 GMT+0700 (SE Asia Standard Time)` equal to `new Date(null)` or `new Date(0)`.\n\nAfter checking knex@0.10.0, I found `parseType` function:\n\n```\n// file: .\\knex\\lib\\dialects\\maria\\index.js\n// line: 117\nfunction parseType(value, type) {\n  switch (type) {\n    case 'DATETIME':\n    case 'TIMESTAMP':\n      return new Date(value);\n    case 'INTEGER':\n      return parseInt(value, 10);\n    default:\n      return value;\n  }\n}\n```\n\nIn regards to NULLABLE column type. IMHO, it's should respect the NULL data.\n\nBut with `parseType` function above, if the data is NULL will produce:\n- start of javascript Date Object for DATETIME and TIMESTAMP\n- and `NaN` for Integer\n", "closed_by": {"login": "kibertoad", "id": 1847934, "node_id": "MDQ6VXNlcjE4NDc5MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1847934?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kibertoad", "html_url": "https://github.com/kibertoad", "followers_url": "https://api.github.com/users/kibertoad/followers", "following_url": "https://api.github.com/users/kibertoad/following{/other_user}", "gists_url": "https://api.github.com/users/kibertoad/gists{/gist_id}", "starred_url": "https://api.github.com/users/kibertoad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kibertoad/subscriptions", "organizations_url": "https://api.github.com/users/kibertoad/orgs", "repos_url": "https://api.github.com/users/kibertoad/repos", "events_url": "https://api.github.com/users/kibertoad/events{/privacy}", "received_events_url": "https://api.github.com/users/kibertoad/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/1276/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/1276/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/2952", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/2952/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/2952/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/2952/events", "html_url": "https://github.com/knex/knex/issues/2952", "id": 390192256, "node_id": "MDU6SXNzdWUzOTAxOTIyNTY=", "number": 2952, "title": "knex migration doesn't find the config file", "user": {"login": "francoisromain", "id": 156539, "node_id": "MDQ6VXNlcjE1NjUzOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/156539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/francoisromain", "html_url": "https://github.com/francoisromain", "followers_url": "https://api.github.com/users/francoisromain/followers", "following_url": "https://api.github.com/users/francoisromain/following{/other_user}", "gists_url": "https://api.github.com/users/francoisromain/gists{/gist_id}", "starred_url": "https://api.github.com/users/francoisromain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/francoisromain/subscriptions", "organizations_url": "https://api.github.com/users/francoisromain/orgs", "repos_url": "https://api.github.com/users/francoisromain/repos", "events_url": "https://api.github.com/users/francoisromain/events{/privacy}", "received_events_url": "https://api.github.com/users/francoisromain/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 75390800, "node_id": "MDU6TGFiZWw3NTM5MDgwMA==", "url": "https://api.github.com/repos/knex/knex/labels/migrations", "name": "migrations", "color": "eb6420", "default": false, "description": null}, {"id": 303314920, "node_id": "MDU6TGFiZWwzMDMzMTQ5MjA=", "url": "https://api.github.com/repos/knex/knex/labels/more%20information%20requested", "name": "more information requested", "color": "d4c5f9", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [{"login": "kibertoad", "id": 1847934, "node_id": "MDQ6VXNlcjE4NDc5MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1847934?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kibertoad", "html_url": "https://github.com/kibertoad", "followers_url": "https://api.github.com/users/kibertoad/followers", "following_url": "https://api.github.com/users/kibertoad/following{/other_user}", "gists_url": "https://api.github.com/users/kibertoad/gists{/gist_id}", "starred_url": "https://api.github.com/users/kibertoad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kibertoad/subscriptions", "organizations_url": "https://api.github.com/users/kibertoad/orgs", "repos_url": "https://api.github.com/users/kibertoad/repos", "events_url": "https://api.github.com/users/kibertoad/events{/privacy}", "received_events_url": "https://api.github.com/users/kibertoad/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 25, "created_at": "2018-12-12T11:54:34Z", "updated_at": "2025-10-29T10:31:04Z", "closed_at": "2025-10-29T10:31:04Z", "assignee": {"login": "kibertoad", "id": 1847934, "node_id": "MDQ6VXNlcjE4NDc5MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1847934?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kibertoad", "html_url": "https://github.com/kibertoad", "followers_url": "https://api.github.com/users/kibertoad/followers", "following_url": "https://api.github.com/users/kibertoad/following{/other_user}", "gists_url": "https://api.github.com/users/kibertoad/gists{/gist_id}", "starred_url": "https://api.github.com/users/kibertoad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kibertoad/subscriptions", "organizations_url": "https://api.github.com/users/kibertoad/orgs", "repos_url": "https://api.github.com/users/kibertoad/repos", "events_url": "https://api.github.com/users/kibertoad/events{/privacy}", "received_events_url": "https://api.github.com/users/kibertoad/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "# Environment\r\n\r\nKnex version: 0.16.2\r\nDatabase + version: postgres 11\r\nOS: mac os 10.13.6\r\n\r\nSelect applicable tempalate from below.\r\nIf issue is about oracledb support tag @ atiertant. For MSSql tag @ smorey2 .\r\nRest of dialects doesn't need tags.\r\n\r\n# Bug\r\n\r\n1. Explain what kind of behaviour you are getting and how you think it should do\r\n\r\nthe knex config file: `/tools/knex/knex.js`\r\n```\r\nrequire('dotenv').config()\r\n\r\nconst connection = {\r\n  host: process.env.PGHOST,\r\n  port: process.env.PGPORT,\r\n  database: process.env.PGDATABASE,\r\n  user: process.env.PGUSER,\r\n  password: process.env.PGPASSWORD\r\n}\r\n\r\nconst knexConfig = {\r\n  client: 'pg',\r\n  connection,\r\n  migrations: {\r\n    directory: './tools/knex/migrations'\r\n  },\r\n  seeds: {\r\n    directory: './tools/knex/seeds'\r\n  }\r\n}\r\n\r\nmodule.exports = knexConfig\r\n```\r\nwhen I run `npx knex --knexfile=./tools/knex/config.js migrate:rollback`, \r\nit makes an error `Error: ENOENT: no such file or directory, scandir '/Volumes/HD/Documents/my-app/migrations'`\r\n\r\nfrom the config file it should look for migrations in `./tools/knex/migrations` and not in `./migrations`\r\n\r\nThis was working well in previous knex version 0.15.2\r\n", "closed_by": {"login": "mercmobily", "id": 2128734, "node_id": "MDQ6VXNlcjIxMjg3MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2128734?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mercmobily", "html_url": "https://github.com/mercmobily", "followers_url": "https://api.github.com/users/mercmobily/followers", "following_url": "https://api.github.com/users/mercmobily/following{/other_user}", "gists_url": "https://api.github.com/users/mercmobily/gists{/gist_id}", "starred_url": "https://api.github.com/users/mercmobily/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mercmobily/subscriptions", "organizations_url": "https://api.github.com/users/mercmobily/orgs", "repos_url": "https://api.github.com/users/mercmobily/repos", "events_url": "https://api.github.com/users/mercmobily/events{/privacy}", "received_events_url": "https://api.github.com/users/mercmobily/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/2952/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/2952/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/2312", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/2312/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/2312/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/2312/events", "html_url": "https://github.com/knex/knex/issues/2312", "id": 271945906, "node_id": "MDU6SXNzdWUyNzE5NDU5MDY=", "number": 2312, "title": "truncate() on SQLite does not reset the id value in the sqlite_sequence any longer", "user": {"login": "lehni", "id": 213275, "node_id": "MDQ6VXNlcjIxMzI3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/213275?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lehni", "html_url": "https://github.com/lehni", "followers_url": "https://api.github.com/users/lehni/followers", "following_url": "https://api.github.com/users/lehni/following{/other_user}", "gists_url": "https://api.github.com/users/lehni/gists{/gist_id}", "starred_url": "https://api.github.com/users/lehni/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lehni/subscriptions", "organizations_url": "https://api.github.com/users/lehni/orgs", "repos_url": "https://api.github.com/users/lehni/repos", "events_url": "https://api.github.com/users/lehni/events{/privacy}", "received_events_url": "https://api.github.com/users/lehni/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 232918327, "node_id": "MDU6TGFiZWwyMzI5MTgzMjc=", "url": "https://api.github.com/repos/knex/knex/labels/PR%20please", "name": "PR please", "color": "bfe5bf", "default": false, "description": null}, {"id": 722495138, "node_id": "MDU6TGFiZWw3MjI0OTUxMzg=", "url": "https://api.github.com/repos/knex/knex/labels/good%20first%20issue", "name": "good first issue", "color": "9435c4", "default": true, "description": null}, {"id": 722495428, "node_id": "MDU6TGFiZWw3MjI0OTU0Mjg=", "url": "https://api.github.com/repos/knex/knex/labels/help%20wanted", "name": "help wanted", "color": "75eaad", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 25, "created_at": "2017-11-07T19:01:39Z", "updated_at": "2021-12-07T17:39:54Z", "closed_at": "2021-12-01T22:37:55Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Upon upgrading to 0.14.0, I've realised that my primary keys don't get reset anymore when I use  `truncate()` with the SQLite dialect.\r\n\r\nIt looks like the code that's supposed to do the reseting in `truncate()` is actually producing an error:\r\n\r\nhttps://github.com/tgriesser/knex/blob/bf8aa4db100ed34756d1d77268e3b391d5d2b528/src/dialects/sqlite3/query/compiler.js#L89-L99\r\n\r\nIf you replace `noop` there with `(err) => { console.log(err) }`, you will see the errors logged:\r\n\r\n```\r\n{ Error: SQLITE_ERROR: no such column: dummy errno: 1, code: 'SQLITE_ERROR\u2019 }\r\n```\r\n\r\nIt looks like the table-name should be quoted in that SQL statement. If I manually add quotes, then the ids get reset again:\r\n\r\n```js\r\nsql: `delete from sqlite_sequence where name = \"${table}\"`\r\n```\r\n\r\nI'm not able to say if that's the correct fix for this issue.", "closed_by": {"login": "OlivierCavadenti", "id": 10152806, "node_id": "MDQ6VXNlcjEwMTUyODA2", "avatar_url": "https://avatars.githubusercontent.com/u/10152806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OlivierCavadenti", "html_url": "https://github.com/OlivierCavadenti", "followers_url": "https://api.github.com/users/OlivierCavadenti/followers", "following_url": "https://api.github.com/users/OlivierCavadenti/following{/other_user}", "gists_url": "https://api.github.com/users/OlivierCavadenti/gists{/gist_id}", "starred_url": "https://api.github.com/users/OlivierCavadenti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OlivierCavadenti/subscriptions", "organizations_url": "https://api.github.com/users/OlivierCavadenti/orgs", "repos_url": "https://api.github.com/users/OlivierCavadenti/repos", "events_url": "https://api.github.com/users/OlivierCavadenti/events{/privacy}", "received_events_url": "https://api.github.com/users/OlivierCavadenti/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/2312/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/2312/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/823", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/823/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/823/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/823/events", "html_url": "https://github.com/knex/knex/issues/823", "id": 76108135, "node_id": "MDU6SXNzdWU3NjEwODEzNQ==", "number": 823, "title": "There is no pool defined on the current client", "user": {"login": "cavinsmith", "id": 435258, "node_id": "MDQ6VXNlcjQzNTI1OA==", "avatar_url": "https://avatars.githubusercontent.com/u/435258?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cavinsmith", "html_url": "https://github.com/cavinsmith", "followers_url": "https://api.github.com/users/cavinsmith/followers", "following_url": "https://api.github.com/users/cavinsmith/following{/other_user}", "gists_url": "https://api.github.com/users/cavinsmith/gists{/gist_id}", "starred_url": "https://api.github.com/users/cavinsmith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cavinsmith/subscriptions", "organizations_url": "https://api.github.com/users/cavinsmith/orgs", "repos_url": "https://api.github.com/users/cavinsmith/repos", "events_url": "https://api.github.com/users/cavinsmith/events{/privacy}", "received_events_url": "https://api.github.com/users/cavinsmith/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": true, "assignees": [], "milestone": null, "comments": 24, "created_at": "2015-05-13T20:11:51Z", "updated_at": "2016-07-20T06:39:19Z", "closed_at": "2015-05-14T04:46:39Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Knex 0.8.4\npg 4.3.0\nPostgres 9.4\nCentos6 \n\nFYI: Knex 7.6 @ same conditions works perfeclty.\n", "closed_by": {"login": "tgriesser", "id": 154748, "node_id": "MDQ6VXNlcjE1NDc0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/154748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tgriesser", "html_url": "https://github.com/tgriesser", "followers_url": "https://api.github.com/users/tgriesser/followers", "following_url": "https://api.github.com/users/tgriesser/following{/other_user}", "gists_url": "https://api.github.com/users/tgriesser/gists{/gist_id}", "starred_url": "https://api.github.com/users/tgriesser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tgriesser/subscriptions", "organizations_url": "https://api.github.com/users/tgriesser/orgs", "repos_url": "https://api.github.com/users/tgriesser/repos", "events_url": "https://api.github.com/users/tgriesser/events{/privacy}", "received_events_url": "https://api.github.com/users/tgriesser/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/823/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/823/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/1137", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/1137/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/1137/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/1137/events", "html_url": "https://github.com/knex/knex/issues/1137", "id": 126608420, "node_id": "MDU6SXNzdWUxMjY2MDg0MjA=", "number": 1137, "title": "Error: Failed to load external module coffee-script/register,coffee-script", "user": {"login": "factoidforrest", "id": 581906, "node_id": "MDQ6VXNlcjU4MTkwNg==", "avatar_url": "https://avatars.githubusercontent.com/u/581906?v=4", "gravatar_id": "", "url": "https://api.github.com/users/factoidforrest", "html_url": "https://github.com/factoidforrest", "followers_url": "https://api.github.com/users/factoidforrest/followers", "following_url": "https://api.github.com/users/factoidforrest/following{/other_user}", "gists_url": "https://api.github.com/users/factoidforrest/gists{/gist_id}", "starred_url": "https://api.github.com/users/factoidforrest/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/factoidforrest/subscriptions", "organizations_url": "https://api.github.com/users/factoidforrest/orgs", "repos_url": "https://api.github.com/users/factoidforrest/repos", "events_url": "https://api.github.com/users/factoidforrest/events{/privacy}", "received_events_url": "https://api.github.com/users/factoidforrest/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 75390800, "node_id": "MDU6TGFiZWw3NTM5MDgwMA==", "url": "https://api.github.com/repos/knex/knex/labels/migrations", "name": "migrations", "color": "eb6420", "default": false, "description": null}, {"id": 232918327, "node_id": "MDU6TGFiZWwyMzI5MTgzMjc=", "url": "https://api.github.com/repos/knex/knex/labels/PR%20please", "name": "PR please", "color": "bfe5bf", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 21, "created_at": "2016-01-14T08:57:54Z", "updated_at": "2016-06-03T14:38:32Z", "closed_at": "2016-03-18T03:14:29Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Any idea what this error is about?  Happens on command: `knex migrate:latest`\n  Coffeescript is installed in the local node-modules.  If I open a node repl, I can require coffee-script register fine.  Node is installed through NVM..  All my knex config is coffeescript.\n", "closed_by": {"login": "rhys-vdw", "id": 822105, "node_id": "MDQ6VXNlcjgyMjEwNQ==", "avatar_url": "https://avatars.githubusercontent.com/u/822105?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rhys-vdw", "html_url": "https://github.com/rhys-vdw", "followers_url": "https://api.github.com/users/rhys-vdw/followers", "following_url": "https://api.github.com/users/rhys-vdw/following{/other_user}", "gists_url": "https://api.github.com/users/rhys-vdw/gists{/gist_id}", "starred_url": "https://api.github.com/users/rhys-vdw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rhys-vdw/subscriptions", "organizations_url": "https://api.github.com/users/rhys-vdw/orgs", "repos_url": "https://api.github.com/users/rhys-vdw/repos", "events_url": "https://api.github.com/users/rhys-vdw/events{/privacy}", "received_events_url": "https://api.github.com/users/rhys-vdw/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/1137/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/1137/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/852", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/852/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/852/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/852/events", "html_url": "https://github.com/knex/knex/issues/852", "id": 82672780, "node_id": "MDU6SXNzdWU4MjY3Mjc4MA==", "number": 852, "title": "SSL Query Parameter for Postgres", "user": {"login": "gregbty", "id": 680484, "node_id": "MDQ6VXNlcjY4MDQ4NA==", "avatar_url": "https://avatars.githubusercontent.com/u/680484?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gregbty", "html_url": "https://github.com/gregbty", "followers_url": "https://api.github.com/users/gregbty/followers", "following_url": "https://api.github.com/users/gregbty/following{/other_user}", "gists_url": "https://api.github.com/users/gregbty/gists{/gist_id}", "starred_url": "https://api.github.com/users/gregbty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gregbty/subscriptions", "organizations_url": "https://api.github.com/users/gregbty/orgs", "repos_url": "https://api.github.com/users/gregbty/repos", "events_url": "https://api.github.com/users/gregbty/events{/privacy}", "received_events_url": "https://api.github.com/users/gregbty/received_events", "type": "User", "user_view_type": "public", "site_admin": true}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 232918327, "node_id": "MDU6TGFiZWwyMzI5MTgzMjc=", "url": "https://api.github.com/repos/knex/knex/labels/PR%20please", "name": "PR please", "color": "bfe5bf", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 21, "created_at": "2015-05-30T02:46:27Z", "updated_at": "2021-05-26T05:25:34Z", "closed_at": "2019-08-24T09:23:57Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "It seems like #516 has surfaced again. When I use a config object it seems to work fine with the `ssl` option, however this doesn't work with a connection string:\n\nWorks:\n\n``` node\nconnection: {\n  host: \"host\",\n  port: \"port\",\n  user: \"user\",\n  password: \"password\",\n  database: \"database\",\n  ssl: true\n }\n```\n\nDoes not work:\n\n``` node\nconnection: \"postgres://user:password@host:port/database?ssl=true\"\n```\n", "closed_by": {"login": "kibertoad", "id": 1847934, "node_id": "MDQ6VXNlcjE4NDc5MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1847934?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kibertoad", "html_url": "https://github.com/kibertoad", "followers_url": "https://api.github.com/users/kibertoad/followers", "following_url": "https://api.github.com/users/kibertoad/following{/other_user}", "gists_url": "https://api.github.com/users/kibertoad/gists{/gist_id}", "starred_url": "https://api.github.com/users/kibertoad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kibertoad/subscriptions", "organizations_url": "https://api.github.com/users/kibertoad/orgs", "repos_url": "https://api.github.com/users/kibertoad/repos", "events_url": "https://api.github.com/users/kibertoad/events{/privacy}", "received_events_url": "https://api.github.com/users/kibertoad/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/852/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/852/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/2442", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/2442/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/2442/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/2442/events", "html_url": "https://github.com/knex/knex/issues/2442", "id": 292359358, "node_id": "MDU6SXNzdWUyOTIzNTkzNTg=", "number": 2442, "title": "Leaked exception if database crashes. (MySQL server has gone away)", "user": {"login": "conglq", "id": 14884100, "node_id": "MDQ6VXNlcjE0ODg0MTAw", "avatar_url": "https://avatars.githubusercontent.com/u/14884100?v=4", "gravatar_id": "", "url": "https://api.github.com/users/conglq", "html_url": "https://github.com/conglq", "followers_url": "https://api.github.com/users/conglq/followers", "following_url": "https://api.github.com/users/conglq/following{/other_user}", "gists_url": "https://api.github.com/users/conglq/gists{/gist_id}", "starred_url": "https://api.github.com/users/conglq/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/conglq/subscriptions", "organizations_url": "https://api.github.com/users/conglq/orgs", "repos_url": "https://api.github.com/users/conglq/repos", "events_url": "https://api.github.com/users/conglq/events{/privacy}", "received_events_url": "https://api.github.com/users/conglq/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 232918327, "node_id": "MDU6TGFiZWwyMzI5MTgzMjc=", "url": "https://api.github.com/repos/knex/knex/labels/PR%20please", "name": "PR please", "color": "bfe5bf", "default": false, "description": null}, {"id": 722495428, "node_id": "MDU6TGFiZWw3MjI0OTU0Mjg=", "url": "https://api.github.com/repos/knex/knex/labels/help%20wanted", "name": "help wanted", "color": "75eaad", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 20, "created_at": "2018-01-29T10:43:34Z", "updated_at": "2018-02-07T09:17:18Z", "closed_at": "2018-02-07T09:17:18Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "# Environment\r\n\r\nKnex version:0.14.2\r\nDatabase + version: mariaDb v10.2\r\nOS: Ubuntu\r\nNode: v9.3.0\r\n\r\nMy connection:\r\n```\r\nconst Knex = require('knex')({\r\n  client: 'mariasql',\r\n  connection: {\r\n    host: config.host,\r\n    user: config.user,\r\n    password: config.password,\r\n    db: config.database,\r\n    charset: 'utf8',\r\n    pool: { min: 2, max: 10 },\r\n    acquireConnectionTimeout: 30000\r\n  }\r\n});\r\n```\r\n\r\nAfter period of time my node app crash with error: \r\n```\r\nevents.js:136\r\n      throw er; // Unhandled 'error' event\r\n      ^\r\n\r\nError: MySQL server has gone away\r\n```\r\nPlease help me resolve this issue. Thanks all!", "closed_by": {"login": "elhigu", "id": 696345, "node_id": "MDQ6VXNlcjY5NjM0NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/696345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elhigu", "html_url": "https://github.com/elhigu", "followers_url": "https://api.github.com/users/elhigu/followers", "following_url": "https://api.github.com/users/elhigu/following{/other_user}", "gists_url": "https://api.github.com/users/elhigu/gists{/gist_id}", "starred_url": "https://api.github.com/users/elhigu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elhigu/subscriptions", "organizations_url": "https://api.github.com/users/elhigu/orgs", "repos_url": "https://api.github.com/users/elhigu/repos", "events_url": "https://api.github.com/users/elhigu/events{/privacy}", "received_events_url": "https://api.github.com/users/elhigu/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/2442/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/2442/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/1180", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/1180/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/1180/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/1180/events", "html_url": "https://github.com/knex/knex/issues/1180", "id": 130734693, "node_id": "MDU6SXNzdWUxMzA3MzQ2OTM=", "number": 1180, "title": "npm install from master broken", "user": {"login": "intensite", "id": 7981384, "node_id": "MDQ6VXNlcjc5ODEzODQ=", "avatar_url": "https://avatars.githubusercontent.com/u/7981384?v=4", "gravatar_id": "", "url": "https://api.github.com/users/intensite", "html_url": "https://github.com/intensite", "followers_url": "https://api.github.com/users/intensite/followers", "following_url": "https://api.github.com/users/intensite/following{/other_user}", "gists_url": "https://api.github.com/users/intensite/gists{/gist_id}", "starred_url": "https://api.github.com/users/intensite/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/intensite/subscriptions", "organizations_url": "https://api.github.com/users/intensite/orgs", "repos_url": "https://api.github.com/users/intensite/repos", "events_url": "https://api.github.com/users/intensite/events{/privacy}", "received_events_url": "https://api.github.com/users/intensite/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 232918327, "node_id": "MDU6TGFiZWwyMzI5MTgzMjc=", "url": "https://api.github.com/repos/knex/knex/labels/PR%20please", "name": "PR please", "color": "bfe5bf", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 18, "created_at": "2016-02-02T16:23:26Z", "updated_at": "2016-10-09T21:38:13Z", "closed_at": "2016-10-09T21:38:13Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Hello,\n\nIt appears that the change to remove the lib directory is causing issues when knex is installed from master using npm.\n\n```\nPS C:\\projets\\test_mssql> npm install\nnpm ERR! Windows_NT 6.1.7601\nnpm ERR! argv \"C:\\\\Program Files\\\\nodejs\\\\node.exe\" \"C:\\\\Program Files\\\\nodejs\\\\node_modules\\\\npm\\\\bin\\\\npm-cli.js\" \"install\"\nnpm ERR! node v4.2.3\nnpm ERR! npm  v2.14.7\nnpm ERR! path C:\\projets\\test_mssql\\node_modules\\knex\\lib\\bin\\cli.js\nnpm ERR! code ENOENT\nnpm ERR! errno -4058\nnpm ERR! syscall chmod\n\nnpm ERR! enoent ENOENT: no such file or directory, chmod 'C:\\projets\\test_mssql\\node_modules\\knex\\lib\\bin\\cli.js'\nnpm ERR! enoent This is most likely not a problem with npm itself\nnpm ERR! enoent and is related to npm not being able to find a file.\nnpm ERR! enoent\n\nnpm ERR! Please include the following file with any support request:\nnpm ERR!     C:\\projets\\test_mssql\\npm-debug.log\n```\n\nAs you can see this is from a Windows installation.  I am using the version from the master repo as I need MSSQL support.\n\nCan this commit be the cause: #1149 \n", "closed_by": {"login": "tgriesser", "id": 154748, "node_id": "MDQ6VXNlcjE1NDc0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/154748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tgriesser", "html_url": "https://github.com/tgriesser", "followers_url": "https://api.github.com/users/tgriesser/followers", "following_url": "https://api.github.com/users/tgriesser/following{/other_user}", "gists_url": "https://api.github.com/users/tgriesser/gists{/gist_id}", "starred_url": "https://api.github.com/users/tgriesser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tgriesser/subscriptions", "organizations_url": "https://api.github.com/users/tgriesser/orgs", "repos_url": "https://api.github.com/users/tgriesser/repos", "events_url": "https://api.github.com/users/tgriesser/events{/privacy}", "received_events_url": "https://api.github.com/users/tgriesser/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/1180/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/1180/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/269", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/269/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/269/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/269/events", "html_url": "https://github.com/knex/knex/issues/269", "id": 33296144, "node_id": "MDU6SXNzdWUzMzI5NjE0NA==", "number": 269, "title": "Chained update with increment?", "user": {"login": "imiric", "id": 1009277, "node_id": "MDQ6VXNlcjEwMDkyNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/1009277?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imiric", "html_url": "https://github.com/imiric", "followers_url": "https://api.github.com/users/imiric/followers", "following_url": "https://api.github.com/users/imiric/following{/other_user}", "gists_url": "https://api.github.com/users/imiric/gists{/gist_id}", "starred_url": "https://api.github.com/users/imiric/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imiric/subscriptions", "organizations_url": "https://api.github.com/users/imiric/orgs", "repos_url": "https://api.github.com/users/imiric/repos", "events_url": "https://api.github.com/users/imiric/events{/privacy}", "received_events_url": "https://api.github.com/users/imiric/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 232918327, "node_id": "MDU6TGFiZWwyMzI5MTgzMjc=", "url": "https://api.github.com/repos/knex/knex/labels/PR%20please", "name": "PR please", "color": "bfe5bf", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 17, "created_at": "2014-05-12T10:28:15Z", "updated_at": "2019-11-27T07:58:42Z", "closed_at": "2019-11-27T07:58:42Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Sorry if I'm missing something, but I can't seem to be able to use `.increment()` along with updating other fields on the table.\n\nFor instance, I'd want to do:\n\n``` js\nknex('products')\n  .whereIn('id', ids)\n  .update({'updated_at': new Date()})\n  .increment('count', 1);\n```\n\nBut running this I get:\n\n```\nPossibly unhandled Error: The query type has already been set to update\n```\n\nI understand why it happens, I just think it would be nice to be able to add other fields to the update.\n\nAlternatively, maybe we could remove `.increment()` altogether and somehow in the `.update()` itself be able to reference the table's columns. Maybe something like:\n\n``` js\nknex('products')\n  .whereIn('id', ids)\n  .update({\n    'updated_at': new Date(),\n    'count': function() {\n      return this + 1;\n    }\n  });\n```\n\nYeah, not sure about the \"this + 1\" part, but maybe have another way of saying \"the existing column value\". This would avoid the need for `.increment()` and `.decrement()`.\n\nI realize I could write this using `.raw()`, but it would be nice to have it in the library.\n\nWhat do you think?\n", "closed_by": {"login": "elhigu", "id": 696345, "node_id": "MDQ6VXNlcjY5NjM0NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/696345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elhigu", "html_url": "https://github.com/elhigu", "followers_url": "https://api.github.com/users/elhigu/followers", "following_url": "https://api.github.com/users/elhigu/following{/other_user}", "gists_url": "https://api.github.com/users/elhigu/gists{/gist_id}", "starred_url": "https://api.github.com/users/elhigu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elhigu/subscriptions", "organizations_url": "https://api.github.com/users/elhigu/orgs", "repos_url": "https://api.github.com/users/elhigu/repos", "events_url": "https://api.github.com/users/elhigu/events{/privacy}", "received_events_url": "https://api.github.com/users/elhigu/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/269/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/269/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/3870", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/3870/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/3870/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/3870/events", "html_url": "https://github.com/knex/knex/issues/3870", "id": 629972754, "node_id": "MDU6SXNzdWU2Mjk5NzI3NTQ=", "number": 3870, "title": "postProcessResponse not called for streamed queries ?", "user": {"login": "mlarcher", "id": 1116431, "node_id": "MDQ6VXNlcjExMTY0MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1116431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mlarcher", "html_url": "https://github.com/mlarcher", "followers_url": "https://api.github.com/users/mlarcher/followers", "following_url": "https://api.github.com/users/mlarcher/following{/other_user}", "gists_url": "https://api.github.com/users/mlarcher/gists{/gist_id}", "starred_url": "https://api.github.com/users/mlarcher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mlarcher/subscriptions", "organizations_url": "https://api.github.com/users/mlarcher/orgs", "repos_url": "https://api.github.com/users/mlarcher/repos", "events_url": "https://api.github.com/users/mlarcher/events{/privacy}", "received_events_url": "https://api.github.com/users/mlarcher/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 722495428, "node_id": "MDU6TGFiZWw3MjI0OTU0Mjg=", "url": "https://api.github.com/repos/knex/knex/labels/help%20wanted", "name": "help wanted", "color": "75eaad", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 16, "created_at": "2020-06-03T12:57:14Z", "updated_at": "2020-08-18T08:50:16Z", "closed_at": "2020-08-18T08:50:16Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "# Environment\r\n\r\nKnex version: 0.21.1\r\nDatabase + version: postgres 11\r\nOS: node:14.2.0 docker container\r\n\r\n# Feature discussion / request\r\n\r\nIt seems that `postProcessResponse` is not called on the resulting rows when using `.stream()` on a query. Can someone tell me if this is a bug or the intended behavior, and if there is a known workaround by any chance ?", "closed_by": {"login": "mlarcher", "id": 1116431, "node_id": "MDQ6VXNlcjExMTY0MzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1116431?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mlarcher", "html_url": "https://github.com/mlarcher", "followers_url": "https://api.github.com/users/mlarcher/followers", "following_url": "https://api.github.com/users/mlarcher/following{/other_user}", "gists_url": "https://api.github.com/users/mlarcher/gists{/gist_id}", "starred_url": "https://api.github.com/users/mlarcher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mlarcher/subscriptions", "organizations_url": "https://api.github.com/users/mlarcher/orgs", "repos_url": "https://api.github.com/users/mlarcher/repos", "events_url": "https://api.github.com/users/mlarcher/events{/privacy}", "received_events_url": "https://api.github.com/users/mlarcher/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/3870/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/3870/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/1901", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/1901/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/1901/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/1901/events", "html_url": "https://github.com/knex/knex/issues/1901", "id": 205945425, "node_id": "MDU6SXNzdWUyMDU5NDU0MjU=", "number": 1901, "title": "ORACLE: Stored procedure issue using \"raw()\"", "user": {"login": "electrotype", "id": 1643012, "node_id": "MDQ6VXNlcjE2NDMwMTI=", "avatar_url": "https://avatars.githubusercontent.com/u/1643012?v=4", "gravatar_id": "", "url": "https://api.github.com/users/electrotype", "html_url": "https://github.com/electrotype", "followers_url": "https://api.github.com/users/electrotype/followers", "following_url": "https://api.github.com/users/electrotype/following{/other_user}", "gists_url": "https://api.github.com/users/electrotype/gists{/gist_id}", "starred_url": "https://api.github.com/users/electrotype/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/electrotype/subscriptions", "organizations_url": "https://api.github.com/users/electrotype/orgs", "repos_url": "https://api.github.com/users/electrotype/repos", "events_url": "https://api.github.com/users/electrotype/events{/privacy}", "received_events_url": "https://api.github.com/users/electrotype/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 337215310, "node_id": "MDU6TGFiZWwzMzcyMTUzMTA=", "url": "https://api.github.com/repos/knex/knex/labels/Oracle", "name": "Oracle", "color": "207de5", "default": false, "description": ""}, {"id": 722495428, "node_id": "MDU6TGFiZWw3MjI0OTU0Mjg=", "url": "https://api.github.com/repos/knex/knex/labels/help%20wanted", "name": "help wanted", "color": "75eaad", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 16, "created_at": "2017-02-07T16:39:36Z", "updated_at": "2025-02-03T22:38:16Z", "closed_at": "2019-09-22T20:32:08Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Knex version : 0.12.6\r\n\r\nI get what it seems to be a Bluebird error when I try to execute an Oracle stored procedure using `raw()` :\r\n```\r\nknex.raw(\"BEGIN MY.STORED.PROCEDURE(?, ?, ?); END;\",\r\n    [\r\n        { \"dir\": oracledb.BIND_IN, \"type\": oracledb.NUMBER, \"val\": 13036 },\r\n        { \"dir\": oracledb.BIND_OUT, \"type\": oracledb.NUMBER },\r\n        { \"dir\": oracledb.BIND_OUT, \"type\": oracledb.NUMBER }\r\n    ]).then((result) => {\r\n        console.log(\"Success : \" + JSON.stringify(result));\r\n    }).catch((err) => {\r\n        console.log(\"Error : \" + err);\r\n    });\r\n```\r\n\r\nThis results in the error :\r\n\r\n> Error : TypeError: BEGIN MY.STORED.PROCEDURE(:1, :2, :3); END; - expecting an array or an iterable object but got [object Null]\r\n\r\nIf I debug, I see that the request works, Oracle response is correct. Here's a screenshot of a breakpoint in file `node_modules/knex/lib/dialects/oracledb/index.js`, line `162` :\r\n\r\n![](http://i.imgur.com/qEHpAcT.png)\r\n\r\nThe `err` is null, there are no `rows` or `resultSet` in the `results` object but a [outBinds](https://github.com/oracle/node-oracledb/blob/master/doc/api.md#execoutbinds) array, containing the OUT parameters of the stored procedure call.\r\n\r\nThe error actually occures when line `205` is reached :\r\n\r\n`resultResolve(results);`\r\n\r\n\r\n\r\n\r\n\r\n\r\n", "closed_by": {"login": "kibertoad", "id": 1847934, "node_id": "MDQ6VXNlcjE4NDc5MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1847934?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kibertoad", "html_url": "https://github.com/kibertoad", "followers_url": "https://api.github.com/users/kibertoad/followers", "following_url": "https://api.github.com/users/kibertoad/following{/other_user}", "gists_url": "https://api.github.com/users/kibertoad/gists{/gist_id}", "starred_url": "https://api.github.com/users/kibertoad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kibertoad/subscriptions", "organizations_url": "https://api.github.com/users/kibertoad/orgs", "repos_url": "https://api.github.com/users/kibertoad/repos", "events_url": "https://api.github.com/users/kibertoad/events{/privacy}", "received_events_url": "https://api.github.com/users/kibertoad/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/1901/reactions", "total_count": 3, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 1, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/1901/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/24", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/24/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/24/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/24/events", "html_url": "https://github.com/knex/knex/issues/24", "id": 16642307, "node_id": "MDU6SXNzdWUxNjY0MjMwNw==", "number": 24, "title": "Foreign Key", "user": {"login": "firmstepgit", "id": 167373, "node_id": "MDQ6VXNlcjE2NzM3Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/167373?v=4", "gravatar_id": "", "url": "https://api.github.com/users/firmstepgit", "html_url": "https://github.com/firmstepgit", "followers_url": "https://api.github.com/users/firmstepgit/followers", "following_url": "https://api.github.com/users/firmstepgit/following{/other_user}", "gists_url": "https://api.github.com/users/firmstepgit/gists{/gist_id}", "starred_url": "https://api.github.com/users/firmstepgit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/firmstepgit/subscriptions", "organizations_url": "https://api.github.com/users/firmstepgit/orgs", "repos_url": "https://api.github.com/users/firmstepgit/repos", "events_url": "https://api.github.com/users/firmstepgit/events{/privacy}", "received_events_url": "https://api.github.com/users/firmstepgit/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 16, "created_at": "2013-07-11T17:08:39Z", "updated_at": "2015-06-23T17:03:58Z", "closed_at": "2013-07-17T14:27:20Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Thanks for a really nicely implemented project. Annotated source code is always a deity-send. I have a few questions:\n\nIs there a way to create foreign keys to other tables? The source code has a function `foreign` with the comment \"Specify a foreign key for the table.\" within the `SchemaBuilder`, but there doesn't seem to be a way to specify a table and column for the foreign key, and the documentation doesn't mention anything.\n\nIs there a way to specify that two or more columns must be unique together?\n\nIs there a way to define indexes on non-integer columns?\n\nThanks!\n", "closed_by": {"login": "tgriesser", "id": 154748, "node_id": "MDQ6VXNlcjE1NDc0OA==", "avatar_url": "https://avatars.githubusercontent.com/u/154748?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tgriesser", "html_url": "https://github.com/tgriesser", "followers_url": "https://api.github.com/users/tgriesser/followers", "following_url": "https://api.github.com/users/tgriesser/following{/other_user}", "gists_url": "https://api.github.com/users/tgriesser/gists{/gist_id}", "starred_url": "https://api.github.com/users/tgriesser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tgriesser/subscriptions", "organizations_url": "https://api.github.com/users/tgriesser/orgs", "repos_url": "https://api.github.com/users/tgriesser/repos", "events_url": "https://api.github.com/users/tgriesser/events{/privacy}", "received_events_url": "https://api.github.com/users/tgriesser/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/24/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/24/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/2752", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/2752/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/2752/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/2752/events", "html_url": "https://github.com/knex/knex/pull/2752", "id": 347610178, "node_id": "MDExOlB1bGxSZXF1ZXN0MjA2MTg3NzI0", "number": 2752, "title": "WIP: Fix charset table compiler for MySQL", "user": {"login": "emilgoldsmith", "id": 18149242, "node_id": "MDQ6VXNlcjE4MTQ5MjQy", "avatar_url": "https://avatars.githubusercontent.com/u/18149242?v=4", "gravatar_id": "", "url": "https://api.github.com/users/emilgoldsmith", "html_url": "https://github.com/emilgoldsmith", "followers_url": "https://api.github.com/users/emilgoldsmith/followers", "following_url": "https://api.github.com/users/emilgoldsmith/following{/other_user}", "gists_url": "https://api.github.com/users/emilgoldsmith/gists{/gist_id}", "starred_url": "https://api.github.com/users/emilgoldsmith/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/emilgoldsmith/subscriptions", "organizations_url": "https://api.github.com/users/emilgoldsmith/orgs", "repos_url": "https://api.github.com/users/emilgoldsmith/repos", "events_url": "https://api.github.com/users/emilgoldsmith/events{/privacy}", "received_events_url": "https://api.github.com/users/emilgoldsmith/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 104525689, "node_id": "MDU6TGFiZWwxMDQ1MjU2ODk=", "url": "https://api.github.com/repos/knex/knex/labels/MySQL", "name": "MySQL", "color": "207de5", "default": false, "description": null}, {"id": 266955583, "node_id": "MDU6TGFiZWwyNjY5NTU1ODM=", "url": "https://api.github.com/repos/knex/knex/labels/needs%20changes", "name": "needs changes", "color": "5319e7", "default": false, "description": ""}, {"id": 722495428, "node_id": "MDU6TGFiZWw3MjI0OTU0Mjg=", "url": "https://api.github.com/repos/knex/knex/labels/help%20wanted", "name": "help wanted", "color": "75eaad", "default": true, "description": null}, {"id": 2613533509, "node_id": "MDU6TGFiZWwyNjEzNTMzNTA5", "url": "https://api.github.com/repos/knex/knex/labels/needs%20rebasing", "name": "needs rebasing", "color": "6C1B0D", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [{"login": "OlivierCavadenti", "id": 10152806, "node_id": "MDQ6VXNlcjEwMTUyODA2", "avatar_url": "https://avatars.githubusercontent.com/u/10152806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OlivierCavadenti", "html_url": "https://github.com/OlivierCavadenti", "followers_url": "https://api.github.com/users/OlivierCavadenti/followers", "following_url": "https://api.github.com/users/OlivierCavadenti/following{/other_user}", "gists_url": "https://api.github.com/users/OlivierCavadenti/gists{/gist_id}", "starred_url": "https://api.github.com/users/OlivierCavadenti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OlivierCavadenti/subscriptions", "organizations_url": "https://api.github.com/users/OlivierCavadenti/orgs", "repos_url": "https://api.github.com/users/OlivierCavadenti/repos", "events_url": "https://api.github.com/users/OlivierCavadenti/events{/privacy}", "received_events_url": "https://api.github.com/users/OlivierCavadenti/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 8, "created_at": "2018-08-04T11:01:36Z", "updated_at": "2025-08-25T20:20:01Z", "closed_at": "2025-08-24T14:25:11Z", "assignee": {"login": "OlivierCavadenti", "id": 10152806, "node_id": "MDQ6VXNlcjEwMTUyODA2", "avatar_url": "https://avatars.githubusercontent.com/u/10152806?v=4", "gravatar_id": "", "url": "https://api.github.com/users/OlivierCavadenti", "html_url": "https://github.com/OlivierCavadenti", "followers_url": "https://api.github.com/users/OlivierCavadenti/followers", "following_url": "https://api.github.com/users/OlivierCavadenti/following{/other_user}", "gists_url": "https://api.github.com/users/OlivierCavadenti/gists{/gist_id}", "starred_url": "https://api.github.com/users/OlivierCavadenti/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/OlivierCavadenti/subscriptions", "organizations_url": "https://api.github.com/users/OlivierCavadenti/orgs", "repos_url": "https://api.github.com/users/OlivierCavadenti/repos", "events_url": "https://api.github.com/users/OlivierCavadenti/events{/privacy}", "received_events_url": "https://api.github.com/users/OlivierCavadenti/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "NONE", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/knex/knex/pulls/2752", "html_url": "https://github.com/knex/knex/pull/2752", "diff_url": "https://github.com/knex/knex/pull/2752.diff", "patch_url": "https://github.com/knex/knex/pull/2752.patch", "merged_at": null}, "body": "This looks to resolve #2742. \r\n\r\nI didn't find it super intuitive or clear exactly where to place the files themselves and especially the tests so please feel free to either push a commit to my branch fixing it or telling me where you'd like them for consistency. I also know this may be a slightly controversial approach but I think it's pretty solid as in case we don't find anything we are still just defaulting to old behaviour.\r\n\r\nI'm going on holiday for the next two weeks so I'm sorry if I'm not too responsive. I already am running my fork on the project I use knex in so it's not a big hurry for a fix for me as my fork fixes my issue, but of course it'd be nice to go back to using the npm distribution", "closed_by": {"login": "mercmobily", "id": 2128734, "node_id": "MDQ6VXNlcjIxMjg3MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2128734?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mercmobily", "html_url": "https://github.com/mercmobily", "followers_url": "https://api.github.com/users/mercmobily/followers", "following_url": "https://api.github.com/users/mercmobily/following{/other_user}", "gists_url": "https://api.github.com/users/mercmobily/gists{/gist_id}", "starred_url": "https://api.github.com/users/mercmobily/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mercmobily/subscriptions", "organizations_url": "https://api.github.com/users/mercmobily/orgs", "repos_url": "https://api.github.com/users/mercmobily/repos", "events_url": "https://api.github.com/users/mercmobily/events{/privacy}", "received_events_url": "https://api.github.com/users/mercmobily/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/2752/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/2752/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/knex/knex/issues/1789", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/1789/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/1789/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/1789/events", "html_url": "https://github.com/knex/knex/issues/1789", "id": 190482341, "node_id": "MDU6SXNzdWUxOTA0ODIzNDE=", "number": 1789, "title": "Knex - OracleDB - knex raw query only returns 100 rows", "user": {"login": "tejzpr", "id": 2813811, "node_id": "MDQ6VXNlcjI4MTM4MTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2813811?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tejzpr", "html_url": "https://github.com/tejzpr", "followers_url": "https://api.github.com/users/tejzpr/followers", "following_url": "https://api.github.com/users/tejzpr/following{/other_user}", "gists_url": "https://api.github.com/users/tejzpr/gists{/gist_id}", "starred_url": "https://api.github.com/users/tejzpr/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tejzpr/subscriptions", "organizations_url": "https://api.github.com/users/tejzpr/orgs", "repos_url": "https://api.github.com/users/tejzpr/repos", "events_url": "https://api.github.com/users/tejzpr/events{/privacy}", "received_events_url": "https://api.github.com/users/tejzpr/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 14, "created_at": "2016-11-19T07:28:47Z", "updated_at": "2025-08-27T01:26:45Z", "closed_at": "2025-08-27T01:26:45Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "While using knex.raw() with oracledb driver knex returns only only 100 rows even if I pass .limit(1000). This is because, by default oracledb driver returns only 100 rows according to their [documentation ](https://github.com/oracle/node-oracledb/blob/master/doc/api.md#propdbmaxrows).", "closed_by": {"login": "mercmobily", "id": 2128734, "node_id": "MDQ6VXNlcjIxMjg3MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2128734?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mercmobily", "html_url": "https://github.com/mercmobily", "followers_url": "https://api.github.com/users/mercmobily/followers", "following_url": "https://api.github.com/users/mercmobily/following{/other_user}", "gists_url": "https://api.github.com/users/mercmobily/gists{/gist_id}", "starred_url": "https://api.github.com/users/mercmobily/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mercmobily/subscriptions", "organizations_url": "https://api.github.com/users/mercmobily/orgs", "repos_url": "https://api.github.com/users/mercmobily/repos", "events_url": "https://api.github.com/users/mercmobily/events{/privacy}", "received_events_url": "https://api.github.com/users/mercmobily/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/1789/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/1789/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/knex/knex/issues/1846", "repository_url": "https://api.github.com/repos/knex/knex", "labels_url": "https://api.github.com/repos/knex/knex/issues/1846/labels{/name}", "comments_url": "https://api.github.com/repos/knex/knex/issues/1846/comments", "events_url": "https://api.github.com/repos/knex/knex/issues/1846/events", "html_url": "https://github.com/knex/knex/issues/1846", "id": 198135775, "node_id": "MDU6SXNzdWUxOTgxMzU3NzU=", "number": 1846, "title": "Specifying --knexfile with knex migrations bug", "user": {"login": "warrenhodg", "id": 12410545, "node_id": "MDQ6VXNlcjEyNDEwNTQ1", "avatar_url": "https://avatars.githubusercontent.com/u/12410545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/warrenhodg", "html_url": "https://github.com/warrenhodg", "followers_url": "https://api.github.com/users/warrenhodg/followers", "following_url": "https://api.github.com/users/warrenhodg/following{/other_user}", "gists_url": "https://api.github.com/users/warrenhodg/gists{/gist_id}", "starred_url": "https://api.github.com/users/warrenhodg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/warrenhodg/subscriptions", "organizations_url": "https://api.github.com/users/warrenhodg/orgs", "repos_url": "https://api.github.com/users/warrenhodg/repos", "events_url": "https://api.github.com/users/warrenhodg/events{/privacy}", "received_events_url": "https://api.github.com/users/warrenhodg/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 23356638, "node_id": "MDU6TGFiZWwyMzM1NjYzOA==", "url": "https://api.github.com/repos/knex/knex/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 13, "created_at": "2016-12-30T11:22:19Z", "updated_at": "2018-12-04T12:27:38Z", "closed_at": "2018-12-04T12:27:38Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "On my production server, I keep my knexfile.js in /etc/myapp.\r\n\r\nWhen running knex --knexfile /etc/myapp/knexfile.js, it complains : \"No local knex install found in : /etc/myapp\".\r\n\r\nThe migrations are in the local installation directory /apps/myapp, from where I am running the utility.\r\n\r\nEven specifying a --cwd $(pwd) option does not seem to solve the issue.\r\n\r\nRunning without the --knexfile works fine. ", "closed_by": {"login": "elhigu", "id": 696345, "node_id": "MDQ6VXNlcjY5NjM0NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/696345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elhigu", "html_url": "https://github.com/elhigu", "followers_url": "https://api.github.com/users/elhigu/followers", "following_url": "https://api.github.com/users/elhigu/following{/other_user}", "gists_url": "https://api.github.com/users/elhigu/gists{/gist_id}", "starred_url": "https://api.github.com/users/elhigu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elhigu/subscriptions", "organizations_url": "https://api.github.com/users/elhigu/orgs", "repos_url": "https://api.github.com/users/elhigu/repos", "events_url": "https://api.github.com/users/elhigu/events{/privacy}", "received_events_url": "https://api.github.com/users/elhigu/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/knex/knex/issues/1846/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/knex/knex/issues/1846/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}]}