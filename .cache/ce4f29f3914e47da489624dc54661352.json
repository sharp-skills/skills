{"d": [{"url": "https://api.github.com/repos/TanStack/query/issues/6318", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/6318/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/6318/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/6318/events", "html_url": "https://github.com/TanStack/query/issues/6318", "id": 1979599975, "node_id": "I_kwDODGBpm851_kxn", "number": 6318, "title": "[vue-query]: Fresh Vue3 project + Tanstack - Typescript errors, This is likely not a portable.", "user": {"login": "cadriel", "id": 205520, "node_id": "MDQ6VXNlcjIwNTUyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/205520?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cadriel", "html_url": "https://github.com/cadriel", "followers_url": "https://api.github.com/users/cadriel/followers", "following_url": "https://api.github.com/users/cadriel/following{/other_user}", "gists_url": "https://api.github.com/users/cadriel/gists{/gist_id}", "starred_url": "https://api.github.com/users/cadriel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cadriel/subscriptions", "organizations_url": "https://api.github.com/users/cadriel/orgs", "repos_url": "https://api.github.com/users/cadriel/repos", "events_url": "https://api.github.com/users/cadriel/events{/privacy}", "received_events_url": "https://api.github.com/users/cadriel/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 2009304499, "node_id": "MDU6TGFiZWwyMDA5MzA0NDk5", "url": "https://api.github.com/repos/TanStack/query/labels/types", "name": "types", "color": "3babed", "default": false, "description": ""}, {"id": 4766674394, "node_id": "LA_kwDODGBpm88AAAABHB2t2g", "url": "https://api.github.com/repos/TanStack/query/labels/has%20workaround", "name": "has workaround", "color": "A1825F", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 34, "created_at": "2023-11-06T16:49:37Z", "updated_at": "2024-09-15T15:39:39Z", "closed_at": "2024-09-15T15:39:33Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\r\n\r\nWith a fresh Vue3 installation with `@tanstack/vue-query` installed - VSCode produces typescript errors, as seen in the screenshot.\r\n\r\nIt's not clear to me if this is an issue with `tanstack-query`, `vue3` - or `typescript`. There seems to be various issues around that suggest it might be any of them.\r\n\r\nIts worth noting that the project still runs and produces expected results.\r\n\r\n`tanstack/vue-query` does not have this issue on V4. It only occurs after moving to V5.\r\n\r\n### Your minimal, reproducible example\r\n\r\nhttps://github.com/cadriel/tanstack-query-issue\r\n\r\n### Steps to reproduce\r\n\r\n1. Clone the example project. https://github.com/cadriel/tanstack-query-issue\r\n2. Open the project in VSCode - ensure you've installed and configured the Vue dev tools (Volar, etc..)\r\n3. See the error as per the screenshot above.\r\n\r\n### Expected behavior\r\n\r\nI'd expect to not see any errors in VSCode, and for the types to be correctly inferred.\r\n\r\n### How often does this bug happen?\r\n\r\nEvery time\r\n\r\n### Screenshots or Videos\r\n\r\n<img width=\"1213\" alt=\"Screenshot 2023-11-06 at 10 38 54 AM\" src=\"https://github.com/TanStack/query/assets/205520/154269fb-5920-40a1-82e2-0a7b207cb1d1\">\r\n\r\n### Platform\r\n\r\nmacOS, VSCode.\r\n\r\n### Tanstack Query adapter\r\n\r\nvue-query\r\n\r\n### TanStack Query version\r\n\r\nV5+\r\n\r\n### TypeScript version\r\n\r\nV5.2.2 (as per `npm create vue@latest`)\r\n\r\n### Additional context\r\n\r\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/6318/reactions", "total_count": 15, "+1": 14, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/6318/timeline", "performed_via_github_app": null, "state_reason": "not_planned"}, {"url": "https://api.github.com/repos/TanStack/query/issues/3582", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/3582/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/3582/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/3582/events", "html_url": "https://github.com/TanStack/query/issues/3582", "id": 1223984493, "node_id": "I_kwDODGBpm85I9IVt", "number": 3582, "title": "React Native: Queries not executing on v4", "user": {"login": "sandergo90", "id": 1516413, "node_id": "MDQ6VXNlcjE1MTY0MTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1516413?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sandergo90", "html_url": "https://github.com/sandergo90", "followers_url": "https://api.github.com/users/sandergo90/followers", "following_url": "https://api.github.com/users/sandergo90/following{/other_user}", "gists_url": "https://api.github.com/users/sandergo90/gists{/gist_id}", "starred_url": "https://api.github.com/users/sandergo90/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sandergo90/subscriptions", "organizations_url": "https://api.github.com/users/sandergo90/orgs", "repos_url": "https://api.github.com/users/sandergo90/repos", "events_url": "https://api.github.com/users/sandergo90/events{/privacy}", "received_events_url": "https://api.github.com/users/sandergo90/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 2402858545, "node_id": "MDU6TGFiZWwyNDAyODU4NTQ1", "url": "https://api.github.com/repos/TanStack/query/labels/released%20on%20@beta", "name": "released on @beta", "color": "ededed", "default": false, "description": null}, {"id": 3540262994, "node_id": "LA_kwDODGBpm87TBCBS", "url": "https://api.github.com/repos/TanStack/query/labels/v4", "name": "v4", "color": "87BFC3", "default": false, "description": ""}, {"id": 4110415589, "node_id": "LA_kwDODGBpm870__bl", "url": "https://api.github.com/repos/TanStack/query/labels/react-native", "name": "react-native", "color": "012B50", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 34, "created_at": "2022-05-03T11:42:26Z", "updated_at": "2023-01-06T07:37:47Z", "closed_at": "2022-05-12T07:54:16Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\n\nHi,\r\n\r\nI'm trying out 4.0.0-beta.7 to implement offline support in our application.\r\n\r\nEverything is upgraded including all the breaking changes, but my queries are not being executed anymore.\r\nTo be sure it's not a problem inside my application, I've created a fresh expo app with just the App.tsx file.\r\n\r\nWhen opening the app, my queries remain in a loading state. If I use the refetch of the `useQuery`,  and run this in a `useEffect`, I'm able to execute the query.\n\n### Your minimal, reproducible example\n\nCouldn't get react-query to work in expo snack\n\n### Steps to reproduce\n\n1. Create a react-native application with the following package.json file\r\n\r\n```\r\n{\r\n  \"name\": \"reactqueryv4\",\r\n  \"version\": \"1.0.0\",\r\n  \"main\": \"node_modules/expo/AppEntry.js\",\r\n  \"scripts\": {\r\n    \"start\": \"expo start\",\r\n    \"android\": \"expo start --android\",\r\n    \"ios\": \"expo start --ios\",\r\n    \"web\": \"expo start --web\",\r\n    \"eject\": \"expo eject\"\r\n  },\r\n  \"dependencies\": {\r\n    \"expo\": \"~44.0.0\",\r\n    \"expo-status-bar\": \"~1.2.0\",\r\n    \"react\": \"17.0.1\",\r\n    \"react-dom\": \"17.0.1\",\r\n    \"react-native\": \"0.64.3\",\r\n    \"react-native-web\": \"0.17.1\",\r\n    \"react-query\": \"4.0.0-beta.7\"\r\n  },\r\n  \"devDependencies\": {\r\n    \"@babel/core\": \"^7.12.9\",\r\n    \"@types/react\": \"~17.0.21\",\r\n    \"@types/react-native\": \"~0.64.12\",\r\n    \"typescript\": \"~4.3.5\"\r\n  },\r\n  \"private\": true\r\n}\r\n```\r\n2. Create a query with a simple async function\r\n```\r\nimport { Text, View } from \"react-native\";\r\nimport { QueryClient, QueryClientProvider, useQuery } from \"react-query\";\r\n\r\nexport default function App() {\r\n  const queryClient = new QueryClient();\r\n\r\n  return (\r\n    <QueryClientProvider client={queryClient}>\r\n      <Todos />\r\n    </QueryClientProvider>\r\n  );\r\n}\r\n\r\nfunction Todos() {\r\n  // Queries\r\n  const query = useQuery([\"todos\"], async () => {\r\n    console.log(\"this should log but doesn't\");\r\n\r\n    return Promise.resolve(\"ok\");\r\n  });\r\n\r\n  console.log(query.data);\r\n\r\n  return (\r\n    <View>\r\n      <Text>lol</Text>\r\n    </View>\r\n  );\r\n}\r\n```\r\n3. Open your application and you will see undefined query data, a status loading and no console.log.\n\n### Expected behavior\n\nI expect this query to be executed. If I change my package.json to the latest v3 version, my query get's executed as it should.\n\n### How often does this bug happen?\n\nEvery time\n\n### Screenshots or Videos\n\n_No response_\n\n### Platform\n\n- iOS, Android\n\n### react-query version\n\n4.0.0-beta.7\n\n### TypeScript version\n\n_No response_\n\n### Additional context\n\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/3582/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/3582/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/5847", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/5847/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/5847/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/5847/events", "html_url": "https://github.com/TanStack/query/issues/5847", "id": 1838451303, "node_id": "I_kwDODGBpm85tlIpn", "number": 5847, "title": "resumePausedMutations are not running after switching from offline to online after version 4.24.3 up to 4.32.6(latest)", "user": {"login": "timabilov", "id": 17686230, "node_id": "MDQ6VXNlcjE3Njg2MjMw", "avatar_url": "https://avatars.githubusercontent.com/u/17686230?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timabilov", "html_url": "https://github.com/timabilov", "followers_url": "https://api.github.com/users/timabilov/followers", "following_url": "https://api.github.com/users/timabilov/following{/other_user}", "gists_url": "https://api.github.com/users/timabilov/gists{/gist_id}", "starred_url": "https://api.github.com/users/timabilov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timabilov/subscriptions", "organizations_url": "https://api.github.com/users/timabilov/orgs", "repos_url": "https://api.github.com/users/timabilov/repos", "events_url": "https://api.github.com/users/timabilov/events{/privacy}", "received_events_url": "https://api.github.com/users/timabilov/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 4420036382, "node_id": "LA_kwDODGBpm88AAAABB3RnHg", "url": "https://api.github.com/repos/TanStack/query/labels/package:%20query-core", "name": "package: query-core", "color": "BFDADC", "default": false, "description": ""}, {"id": 4766674394, "node_id": "LA_kwDODGBpm88AAAABHB2t2g", "url": "https://api.github.com/repos/TanStack/query/labels/has%20workaround", "name": "has workaround", "color": "A1825F", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 31, "created_at": "2023-08-06T22:57:33Z", "updated_at": "2024-03-04T08:50:43Z", "closed_at": "2024-03-04T08:50:43Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\r\n\r\nhttps://github.com/TanStack/query/commit/8991d7c0193c91fb17a97998bdbcda4363943f35 this is the commit where it breaks (4.24.3)\r\n\r\nNot sure  if this is correct behaviour. But based on the commit above  i assume it is a bug indeed.\r\nPaused mutations get stuck when rehydrating(loading) mutations in offline mode and switching back online.\r\n\r\nBasically, when you reenter the exited app in **offline** mode it restores the mutations successfully, i see paused mutations in logs as a result of resumePausedMutations. \r\n\r\nBut when you get back online, paused mutations do not run.  This happens in latest 4.32.6. When i reload(React Native) my javascript it runs again.\r\nBut, i got to the version where it works and triaged this.\r\nbasically this is the commit where it starts breaking\r\nhttps://github.com/TanStack/query/commit/8991d7c0193c91fb17a97998bdbcda4363943f35\r\n\r\nShortly, 4.24.3 and upper version causes this bug \r\n\r\n\r\n### Your minimal, reproducible example\r\n\r\n\r\nRun https://github.com/TanStack/query/tree/main/examples/react/offline\r\n\r\n\r\n### Steps to reproduce\r\n1. Go to any movie\r\n2. Go offline/ turn off your wife\r\n3. Add comment (to verify, add it three times)\r\n4. Refresh the page\r\n5. ENABLE your WIFI and then wait\r\n6. Nothing happens, but expected this mutations to get unpaused\r\n7. Refresh the page and you see updates are applied now sequentially.\r\n\r\n\r\nThis happens in my React Native setup too.\r\n1.  Go offline\r\n2. Add todo (fire any mutation which will be paused)\r\n3.  Exit from app then enter again (both RN debug/release  mode)\r\n4. enable internet\r\n5. At the end i see 1 paused mutation pending in my logs.\r\nSo it stucks/waits here:\r\n```\r\nqueryClient.resumePausedMutations()\r\n```\r\n\r\n\r\n\r\n### Expected behavior\r\n\r\nAs a user, i am expecting all mutations to start running after resume, but no mutations are running in that case.\r\nIn logs they are all paused\r\n\r\n\r\n### How often does this bug happen?\r\n\r\nEvery time\r\n\r\n### Screenshots or Videos\r\n\r\n_No response_\r\n\r\n### Platform\r\n\r\nReact Native 0.70.6\r\n\r\n### Tanstack Query adapter\r\n\r\nreact-query\r\n\r\n### TanStack Query version\r\n\r\n4.32.6 (but started in 4.24.3!!)\r\n\r\n### TypeScript version\r\n\r\n_No response_\r\n\r\n### Additional context\r\n\r\nIf i will reload my javascript after 5th step, then it resumes mutations again and runs them correctly\r\n\r\nAlso, if you have **internet enabled before** entering the app, it works as expected.", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/5847/reactions", "total_count": 8, "+1": 7, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/5847/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/8677", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/8677/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/8677/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/8677/events", "html_url": "https://github.com/TanStack/query/issues/8677", "id": 2863994066, "node_id": "I_kwDODGBpm86qtRTS", "number": 8677, "title": "Maximum update depth exceeded", "user": {"login": "yWilliamLima", "id": 122046880, "node_id": "U_kgDOB0ZJoA", "avatar_url": "https://avatars.githubusercontent.com/u/122046880?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yWilliamLima", "html_url": "https://github.com/yWilliamLima", "followers_url": "https://api.github.com/users/yWilliamLima/followers", "following_url": "https://api.github.com/users/yWilliamLima/following{/other_user}", "gists_url": "https://api.github.com/users/yWilliamLima/gists{/gist_id}", "starred_url": "https://api.github.com/users/yWilliamLima/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yWilliamLima/subscriptions", "organizations_url": "https://api.github.com/users/yWilliamLima/orgs", "repos_url": "https://api.github.com/users/yWilliamLima/repos", "events_url": "https://api.github.com/users/yWilliamLima/events{/privacy}", "received_events_url": "https://api.github.com/users/yWilliamLima/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 4335258818, "node_id": "LA_kwDODGBpm88AAAABAmbMwg", "url": "https://api.github.com/repos/TanStack/query/labels/package:%20react-query", "name": "package: react-query", "color": "00D8FE", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 27, "created_at": "2025-02-19T17:35:36Z", "updated_at": "2025-06-12T14:21:36Z", "closed_at": "2025-05-25T21:09:53Z", "assignee": null, "author_association": "NONE", "type": {"id": 13396018, "node_id": "IT_kwDOBFKL8M4AzGgy", "name": "Bug", "description": "An unexpected problem or behavior", "color": "red", "created_at": "2024-02-07T14:44:29Z", "updated_at": "2024-07-26T13:32:42Z", "is_enabled": true}, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\n\nI am getting the error \"Maximum update depth exceeded\"\n\n### Your minimal, reproducible example\n\nhttps://stackblitz.com/~/github.com/yWilliamLima/test-error\n\n### Steps to reproduce\n\nIt usually occurs after a while of running whenever changing pages/routes\n\n### Expected behavior\n\nDo not return this error\n\n### How often does this bug happen?\n\nSometimes\n\n### Screenshots or Videos\n\n![Image](https://github.com/user-attachments/assets/5e92d643-836f-440d-9938-75c6f1c14823)\n![Image](https://github.com/user-attachments/assets/95d90699-3715-4645-9efa-c43e15689b84)\n\n### Platform\n\nOS: Windows 11\nBrowser: Chrome\nNode: 22.12.0\n\n### Tanstack Query adapter\n\nNone\n\n### TanStack Query version\n\n5.66.5\n\n### TypeScript version\n\n5.7.3\n\n### Additional context\n\nThe error in the console does not occur locally, only in stackblitz\nMaybe because of this error in the stackblitz console it doesn't happen, because it gives a refresh\nBecause it is a minimal example, it takes a while to occur, but in my project it occurs frequently", "closed_by": {"login": "Ephem", "id": 7420167, "node_id": "MDQ6VXNlcjc0MjAxNjc=", "avatar_url": "https://avatars.githubusercontent.com/u/7420167?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Ephem", "html_url": "https://github.com/Ephem", "followers_url": "https://api.github.com/users/Ephem/followers", "following_url": "https://api.github.com/users/Ephem/following{/other_user}", "gists_url": "https://api.github.com/users/Ephem/gists{/gist_id}", "starred_url": "https://api.github.com/users/Ephem/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Ephem/subscriptions", "organizations_url": "https://api.github.com/users/Ephem/orgs", "repos_url": "https://api.github.com/users/Ephem/repos", "events_url": "https://api.github.com/users/Ephem/events{/privacy}", "received_events_url": "https://api.github.com/users/Ephem/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/8677/reactions", "total_count": 17, "+1": 17, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/8677/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/5719", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/5719/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/5719/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/5719/events", "html_url": "https://github.com/TanStack/query/issues/5719", "id": 1806274368, "node_id": "I_kwDODGBpm85rqY9A", "number": 5719, "title": "Infinite render loop with v4.29.{22,23}", "user": {"login": "ddolcimascolo", "id": 5468291, "node_id": "MDQ6VXNlcjU0NjgyOTE=", "avatar_url": "https://avatars.githubusercontent.com/u/5468291?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ddolcimascolo", "html_url": "https://github.com/ddolcimascolo", "followers_url": "https://api.github.com/users/ddolcimascolo/followers", "following_url": "https://api.github.com/users/ddolcimascolo/following{/other_user}", "gists_url": "https://api.github.com/users/ddolcimascolo/gists{/gist_id}", "starred_url": "https://api.github.com/users/ddolcimascolo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ddolcimascolo/subscriptions", "organizations_url": "https://api.github.com/users/ddolcimascolo/orgs", "repos_url": "https://api.github.com/users/ddolcimascolo/repos", "events_url": "https://api.github.com/users/ddolcimascolo/events{/privacy}", "received_events_url": "https://api.github.com/users/ddolcimascolo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 26, "created_at": "2023-07-15T18:50:41Z", "updated_at": "2023-08-05T12:02:13Z", "closed_at": "2023-08-05T06:21:42Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\n\nRenovate is trying to update react-query from v4.29.19 to latest (this currently pulls v4.29.23) in our application monorepo containing multiple large React  apps and a helper package. We have lots of tests entering infinite render loop, with the usual `Maximum call stack exceeded` error that React is throwing.\r\n\r\nI can't give you more details yet, I'm opening the issue early to gather community feedback. I will be able to provide more information on Monday, but as I'm not expecting any breaking change in a patch release, I though it would be useful to keep you posted.\r\n\r\nI'm not even sure this is a problem with react-query, it's just that this _happens_ while upgrading this library.\r\n\r\nCheers,\r\nDavid \n\n### Your minimal, reproducible example\n\nTo be done\n\n### Steps to reproduce\n\nTo be done\n\n### Expected behavior\n\nTests pass as with v4.29.19\n\n### How often does this bug happen?\n\nEvery time\n\n### Screenshots or Videos\n\n_No response_\n\n### Platform\n\nLinux\r\nJSDOM through Jest tests\n\n### Tanstack Query adapter\n\nreact-query\n\n### TanStack Query version\n\nv4.29.23 \n\n### TypeScript version\n\n_No response_\n\n### Additional context\n\nThe problem is in unit tests only. ", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/5719/reactions", "total_count": 4, "+1": 4, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/5719/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/4396", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/4396/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/4396/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/4396/events", "html_url": "https://github.com/TanStack/query/issues/4396", "id": 1426986056, "node_id": "I_kwDODGBpm85VDhRI", "number": 4396, "title": "Migrating to V4 - React Query Devtools module parse failed", "user": {"login": "TommyNT", "id": 14999839, "node_id": "MDQ6VXNlcjE0OTk5ODM5", "avatar_url": "https://avatars.githubusercontent.com/u/14999839?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TommyNT", "html_url": "https://github.com/TommyNT", "followers_url": "https://api.github.com/users/TommyNT/followers", "following_url": "https://api.github.com/users/TommyNT/following{/other_user}", "gists_url": "https://api.github.com/users/TommyNT/gists{/gist_id}", "starred_url": "https://api.github.com/users/TommyNT/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TommyNT/subscriptions", "organizations_url": "https://api.github.com/users/TommyNT/orgs", "repos_url": "https://api.github.com/users/TommyNT/repos", "events_url": "https://api.github.com/users/TommyNT/events{/privacy}", "received_events_url": "https://api.github.com/users/TommyNT/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 2849861769, "node_id": "MDU6TGFiZWwyODQ5ODYxNzY5", "url": "https://api.github.com/repos/TanStack/query/labels/package:%20react-query-devtools", "name": "package: react-query-devtools", "color": "00D8FE", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 23, "created_at": "2022-10-28T09:37:57Z", "updated_at": "2022-11-13T07:50:12Z", "closed_at": "2022-11-13T07:50:12Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\r\n\r\nI have migrated to React Query V4. When I include `@tanstack/react-query-devtools` it displays error like below:\r\n````\r\nunitless.browser.esm.js:50 Uncaught Error: Module parse failed: Unexpected token (18:1274)\r\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\r\n|    * @author Kent C. Dodds <me@kentcdodds.com> (https://kentcdodds.com)\r\n|    */\r\n> const o={CASE_SENSITIVE_EQUAL:7,EQUAL:6,STARTS_WITH:5,WORD_STARTS_WITH:4,CONTAINS:3,ACRONYM:2,MATCHES:1,NO_MATCH:0};function s(e,n,t){return e=a(e,t),(n=a(n,t)).length>e.length?o.NO_MATCH:e===n?o.CASE_SENSITIVE_EQUAL:(e=e.toLowerCase())===(n=n.toLowerCase())?o.EQUAL:e.startsWith(n)?o.STARTS_WITH:e.includes(` ${n}`)?o.WORD_STARTS_WITH:e.includes(n)?o.CONTAINS:1===n.length?o.NO_MATCH:function(e){let n=\"\";return e.split(\" \").forEach((e=>{e.split(\"-\").forEach((e=>{n+=e.substr(0,1)}))})),n}(e).includes(n)?o.ACRONYM:function(e,n){let t=0,r=0;function s(e,n,r){for(let o=r,s=n.length;o<s;o++){if(n[o]===e)return t+=1,o+1}return-1}function a(e){const r=1/e,s=t/n.length;return o.MATCHES+s*r}const i=s(n[0],e,0);if(i<0)return o.NO_MATCH;r=i;for(let t=1,a=n.length;t<a;t++){r=s(n[t],e,r);if(!(r>-1))return o.NO_MATCH}return a(r-i)}(e,n)}function a(e,t){let{keepDiacritics:o}=t;return e=`${e}`,o||(e=e.replace(r,(e=>n[e]))),e}function i(e,n){let t=n;\"object\"==typeof n&&(t=n.accessor);const r=t(e);return null==r?[]:Array.isArray(r)?r:[String(r)]}const u={maxRanking:1/0,minRanking:-1/0};function c(e){return\"function\"==typeof e?u:{...u,...e}}e.compareItems=function(e,n){return e.rank===n.rank?0:e.rank>n.rank?-1:1},e.rankItem=function(e,n,t){if((t=t||{}).threshold=t.threshold??o.MATCHES,!t.accessors){const r=s(e,n,t);return{rankedValue:e,rank:r,accessorIndex:-1,accessorThreshold:t.threshold,passed:r>=t.threshold}}const r=function(e,n){const t=[];for(let r=0,o=n.length;r<o;r++){const o=n[r],s=c(o),a=i(e,o);for(let e=0,n=a.length;e<n;e++)t.push({itemValue:a[e],attributes:s})}return t}(e,t.accessors),a={rankedValue:e,rank:o.NO_MATCH,accessorIndex:-1,accessorThreshold:t.threshold,passed:!1};for(let e=0;e<r.length;e++){const i=r[e];let u=s(i.itemValue,n,t);const{minRanking:c,maxRanking:l,threshold:A=t.threshold}=i.attributes;u<c&&u>=o.MATCHES?u=c:u>l&&(u=l),u=Math.min(u,l),u>=A&&u>a.rank&&(a.rank=u,a.passed=!0,a.accessorIndex=e,a.accessorThreshold=A,a.rankedValue=i.itemValue)}return a},e.rankings=o,Object.defineProperty(e,\"__esModule\",{value:!0})}));\r\n| //# sourceMappingURL=index.production.js.map\r\n| \r\n    at ./node_modules/@tanstack/match-sorter-utils/build/umd/index.production.js (unitless.browser.esm.js:50:29)\r\n    at __webpack_require__ (bootstrap:63:1)\r\n    at ./node_modules/@tanstack/react-query-devtools/build/lib/devtools.js (devtools.js:8:24)\r\n    at __webpack_require__ (bootstrap:63:1)\r\n    at ./node_modules/@tanstack/react-query-devtools/build/lib/index.js (index.js:5:16)\r\n    at __webpack_require__ (bootstrap:63:1)\r\n    at ./formEfficiencyReport/src/App.tsx (App.tsx:1:1)\r\n    at __webpack_require__ (bootstrap:63:1)\r\n    at ./formEfficiencyReport/src/index.tsx (index.tsx:1:1)\r\n    at __webpack_require__ (bootstrap:63:1)\r\n````\r\n\r\n### Your minimal, reproducible example\r\n\r\nhttps://codesandbox.io/s/dry-lake-cyly62?file=/src/App.js\r\n\r\n### Steps to reproduce\r\n\r\nIn package.json:\r\n```\r\n\"@tanstack/react-query\": \"4.3.3\",\r\n    \"@tanstack/react-query-devtools\": \"4.3.3\",\r\n```\r\nIn webpack.config.js:\r\n```\r\nconst babelConfig = {\r\n  presets: [\r\n    [\r\n      '@babel/preset-env',\r\n      {\r\n        targets: {\r\n          browsers: [\r\n            '> 1%',\r\n            'last 2 chrome versions',\r\n            'last 2 firefox versions',\r\n            'last 2 safari versions',\r\n            'last 2 opera versions',\r\n            'not ie 11',\r\n            'not op_mini all',\r\n          ],\r\n        },\r\n      },\r\n    ],\r\n    '@babel/preset-react',\r\n    '@babel/preset-typescript',\r\n  ],\r\n  plugins: [\r\n    '@babel/plugin-proposal-optional-chaining',\r\n    '@babel/plugin-transform-runtime',\r\n    'styled-components',\r\n    '@babel/plugin-proposal-class-properties',\r\n  ],\r\n};\r\n```\r\n\r\n```\r\nrules: [\r\n      {\r\n        test: /\\.(ts|tsx|style.ts|style.tsx|js|jsx)$/,\r\n        resolve: {\r\n          extensions: ['.ts', '.tsx', '.style.ts', '.style.tsx', '.js', '.jsx'],\r\n        },\r\n        exclude: [/node_modules/, /tsconfig.json/],\r\n        use: {\r\n          loader: 'babel-loader',\r\n          options: { ...babelConfig },\r\n        },\r\n      },\r\n      {\r\n        test: /\\.(mjs)$/,\r\n        include: /node_modules/,\r\n        type: 'javascript/auto',\r\n      }]\r\n```\r\n\r\n### Expected behavior\r\n\r\nI expect to display React Query Devtools, but it displays error. When I'm not including devtools it works fine.\r\n\r\n### How often does this bug happen?\r\n\r\nEvery time\r\n\r\n### Screenshots or Videos\r\n\r\n_No response_\r\n\r\n### Platform\r\n\r\n- OS: Mac OS 12.3.1\r\n- Node 14.17.0\r\n- NPM 6.14.13\r\n\r\n### react-query version\r\n\r\n4.3.3\r\n\r\n### TypeScript version\r\n\r\n_No response_\r\n\r\n### Additional context\r\n\r\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/4396/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/4396/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/3706", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/3706/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/3706/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/3706/events", "html_url": "https://github.com/TanStack/query/issues/3706", "id": 1269585688, "node_id": "I_kwDODGBpm85LrFcY", "number": 3706, "title": "fetchQuery and useQuery options ", "user": {"login": "artem-malko", "id": 1823689, "node_id": "MDQ6VXNlcjE4MjM2ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1823689?v=4", "gravatar_id": "", "url": "https://api.github.com/users/artem-malko", "html_url": "https://github.com/artem-malko", "followers_url": "https://api.github.com/users/artem-malko/followers", "following_url": "https://api.github.com/users/artem-malko/following{/other_user}", "gists_url": "https://api.github.com/users/artem-malko/gists{/gist_id}", "starred_url": "https://api.github.com/users/artem-malko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/artem-malko/subscriptions", "organizations_url": "https://api.github.com/users/artem-malko/orgs", "repos_url": "https://api.github.com/users/artem-malko/repos", "events_url": "https://api.github.com/users/artem-malko/events{/privacy}", "received_events_url": "https://api.github.com/users/artem-malko/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 4420036382, "node_id": "LA_kwDODGBpm88AAAABB3RnHg", "url": "https://api.github.com/repos/TanStack/query/labels/package:%20query-core", "name": "package: query-core", "color": "BFDADC", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [{"login": "artem-malko", "id": 1823689, "node_id": "MDQ6VXNlcjE4MjM2ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1823689?v=4", "gravatar_id": "", "url": "https://api.github.com/users/artem-malko", "html_url": "https://github.com/artem-malko", "followers_url": "https://api.github.com/users/artem-malko/followers", "following_url": "https://api.github.com/users/artem-malko/following{/other_user}", "gists_url": "https://api.github.com/users/artem-malko/gists{/gist_id}", "starred_url": "https://api.github.com/users/artem-malko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/artem-malko/subscriptions", "organizations_url": "https://api.github.com/users/artem-malko/orgs", "repos_url": "https://api.github.com/users/artem-malko/repos", "events_url": "https://api.github.com/users/artem-malko/events{/privacy}", "received_events_url": "https://api.github.com/users/artem-malko/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 23, "created_at": "2022-06-13T15:08:04Z", "updated_at": "2024-03-12T07:37:15Z", "closed_at": "2024-03-12T07:37:15Z", "assignee": {"login": "artem-malko", "id": 1823689, "node_id": "MDQ6VXNlcjE4MjM2ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/1823689?v=4", "gravatar_id": "", "url": "https://api.github.com/users/artem-malko", "html_url": "https://github.com/artem-malko", "followers_url": "https://api.github.com/users/artem-malko/followers", "following_url": "https://api.github.com/users/artem-malko/following{/other_user}", "gists_url": "https://api.github.com/users/artem-malko/gists{/gist_id}", "starred_url": "https://api.github.com/users/artem-malko/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/artem-malko/subscriptions", "organizations_url": "https://api.github.com/users/artem-malko/orgs", "repos_url": "https://api.github.com/users/artem-malko/repos", "events_url": "https://api.github.com/users/artem-malko/events{/privacy}", "received_events_url": "https://api.github.com/users/artem-malko/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\n\nActually, I'm not sure, that it is a bug.\r\n\r\nSo, if I have a fetchQuery and my own query (which uses useQuery) for the one entity (newsItem in the example), and my own query has specific options (fetchQuery uses default options, own query overrides cacheTime and staleTime). My own query executes on the NewsItem component mount. But, if a data for newsItem is fetched via fetchQuery, my own query is not working for that case. So, in a queryCache that query has options from default, not from my own query.\r\n\r\nI understand, that my own query won't start its fetcher, if the data is in the cache. But it was quite unexpected, that options from my own query are not used. Check out the example from codesandbox.\n\n### Your minimal, reproducible example\n\nhttps://codesandbox.io/s/react-query-fetchquery-usequery-g18l4y\n\n### Steps to reproduce\n\n1. Go to the codesandbox example\r\n2. Click to the button with text: \"fetch newsitem with id ...\" In the ReactQuery devtools you will see, that there is a query with cacheTime and staleTime from default settings.\r\n3. Click to the button with text \"Toggle newsItemComp\". The NewsItem will be shown.\r\n4. Options from the query \"useNewsItem\", which is used there won't be applied.\n\n### Expected behavior\n\nAs a user, I expected that useQuery will rewrite options of the query in the reactQuery cache but i am seeing, that options from fetchQuery is used (default options).\r\n\n\n### How often does this bug happen?\n\nEvery time\n\n### Screenshots or Videos\n\n_No response_\n\n### Platform\n\nIt doesn't depend\n\n### react-query version\n\n4.0.0-beta.23\n\n### TypeScript version\n\n4.7.3\n\n### Additional context\n\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/3706/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/3706/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/3269", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/3269/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/3269/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/3269/events", "html_url": "https://github.com/TanStack/query/issues/3269", "id": 1125180982, "node_id": "I_kwDODGBpm85DEOY2", "number": 3269, "title": "`isFetching` returns wrong value when component is mounted with previously fetched key", "user": {"login": "kolbasan", "id": 10047316, "node_id": "MDQ6VXNlcjEwMDQ3MzE2", "avatar_url": "https://avatars.githubusercontent.com/u/10047316?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kolbasan", "html_url": "https://github.com/kolbasan", "followers_url": "https://api.github.com/users/kolbasan/followers", "following_url": "https://api.github.com/users/kolbasan/following{/other_user}", "gists_url": "https://api.github.com/users/kolbasan/gists{/gist_id}", "starred_url": "https://api.github.com/users/kolbasan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kolbasan/subscriptions", "organizations_url": "https://api.github.com/users/kolbasan/orgs", "repos_url": "https://api.github.com/users/kolbasan/repos", "events_url": "https://api.github.com/users/kolbasan/events{/privacy}", "received_events_url": "https://api.github.com/users/kolbasan/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 1548510206, "node_id": "MDU6TGFiZWwxNTQ4NTEwMjA2", "url": "https://api.github.com/repos/TanStack/query/labels/help%20wanted", "name": "help wanted", "color": "008672", "default": true, "description": "Extra attention is needed"}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 21, "created_at": "2022-02-06T11:46:23Z", "updated_at": "2022-04-03T07:33:16Z", "closed_at": "2022-04-03T07:33:16Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\r\n\r\nWe are using `useQuery` (with `refetchOnMount: false`) and the same query key is used for both parent and child components.\r\nThe parent has logic where only when `isFetching: true`  the child is rendered.\r\nFirst render (with key \"`a`\") and first key change (to key \"`b`\") are working as expected, however when we change the key back to previous value (to \"`a`\"): for a brief moment the parent gets `isFetching: true` while child get `isFetching: false`\r\n\r\n\r\n### Your minimal, reproducible example\r\n\r\nhttps://codesandbox.io/s/is-fetching-bug-hqv1v?file=/src/App.js\r\n\r\n### Steps to reproduce\r\n\r\nOn first render the console log looks this way:\r\n```\r\nparent isFetching=true \r\nchild isFetching=true \r\nStarting fetch \r\nparent isFetching=false \r\n```\r\nFirst time clicking \"Change key\" button we get:\r\n```\r\nparent isFetching=true \r\nchild isFetching=true \r\nStarting fetch \r\nparent isFetching=false \r\n```\r\nSecond time clicking \"Change key\" shows unexpected behavior:\r\n```\r\nparent isFetching=true \r\nchild isFetching=false \r\nStarting fetch \r\nparent isFetching=true \r\nchild isFetching=true \r\nparent isFetching=false \r\n```\r\n\r\n### Expected behavior\r\n\r\nWhen clicking the \"Change key\" for the second time, we expect the same result as the first time it was clicked:\r\n```\r\nparent isFetching=true \r\nchild isFetching=true \r\nStarting fetch \r\nparent isFetching=false \r\n```\r\nHowever for the parent and child get different values for `isFetching`\r\n\r\n### How often does this bug happen?\r\n\r\nEvery time\r\n\r\n### Screenshots or Videos\r\n\r\n_No response_\r\n\r\n### Platform\r\n\r\n- Chrome: Version 95\r\n\r\n### react-query version\r\n\r\nv3.34.12\r\n\r\n### TypeScript version\r\n\r\n_No response_\r\n\r\n### Additional context\r\n\r\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/3269/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/3269/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/2434", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/2434/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/2434/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/2434/events", "html_url": "https://github.com/TanStack/query/issues/2434", "id": 936646683, "node_id": "MDU6SXNzdWU5MzY2NDY2ODM=", "number": 2434, "title": "Infinate querying when query fails and using suspense + enabled flag", "user": {"login": "vimcaw", "id": 21964227, "node_id": "MDQ6VXNlcjIxOTY0MjI3", "avatar_url": "https://avatars.githubusercontent.com/u/21964227?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vimcaw", "html_url": "https://github.com/vimcaw", "followers_url": "https://api.github.com/users/vimcaw/followers", "following_url": "https://api.github.com/users/vimcaw/following{/other_user}", "gists_url": "https://api.github.com/users/vimcaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/vimcaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vimcaw/subscriptions", "organizations_url": "https://api.github.com/users/vimcaw/orgs", "repos_url": "https://api.github.com/users/vimcaw/repos", "events_url": "https://api.github.com/users/vimcaw/events{/privacy}", "received_events_url": "https://api.github.com/users/vimcaw/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 2039108783, "node_id": "MDU6TGFiZWwyMDM5MTA4Nzgz", "url": "https://api.github.com/repos/TanStack/query/labels/released", "name": "released", "color": "ededed", "default": false, "description": null}, {"id": 2477717738, "node_id": "MDU6TGFiZWwyNDc3NzE3NzM4", "url": "https://api.github.com/repos/TanStack/query/labels/suspense", "name": "suspense", "color": "dbff9e", "default": false, "description": ""}, {"id": 3619132867, "node_id": "LA_kwDODGBpm87Xt5XD", "url": "https://api.github.com/repos/TanStack/query/labels/released%20on%20@alpha", "name": "released on @alpha", "color": "ededed", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 21, "created_at": "2021-07-05T03:31:02Z", "updated_at": "2022-07-07T10:58:23Z", "closed_at": "2021-12-14T12:07:30Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Describe the bug**\r\nUsing suspense + enabled flag to delay querying, when a query fails will cause infinite querying.\r\n\r\n**To Reproduce**\r\n\r\nCore code:\r\n```ts\r\nfunction query() {\r\n  return new Promise((resolve, reject) => {\r\n    console.count(\"query\");\r\n    setTimeout(() => reject(\"Query Error\"), 1000);\r\n  });\r\n}\r\n\r\nfunction DataFetch() {\r\n  const [enabled, setEnabledStatus] = useState(false);\r\n  useQuery(\"mock\", query, { suspense: true, enabled, retry: 0 });\r\n\r\n  return <button onClick={() => setEnabledStatus(true)}>Start</button>;\r\n}\r\n```\r\n\r\nComplete code: https://codesandbox.io/s/react-query-bug-suspense-enabled-flag-2w762?file=/src/App.tsx\r\n\r\nSteps to reproduce the behavior:\r\n1. Click the `Start` Button\r\n2. Look at `Console`, you will see many queries.\r\n\r\n**Expected behavior**\r\nThrow Error and only query once.\r\n\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/21964227/124413644-a4c8a800-dd83-11eb-8159-6d27b8a2a7dd.png)\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: macOS\r\n - Browser: chrome\r\n - Version: 91.0.4472.114\r\n\r\n**Additional context**\r\nAfter removing the `enabled` or `suspense` flag, anything works well.\r\n", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/2434/reactions", "total_count": 8, "+1": 7, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/2434/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/4097", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/4097/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/4097/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/4097/events", "html_url": "https://github.com/TanStack/query/issues/4097", "id": 1354011995, "node_id": "I_kwDODGBpm85QtJVb", "number": 4097, "title": "Devtools are re-rerendering constantly on every cache update even when closed", "user": {"login": "pristas-peter", "id": 9489687, "node_id": "MDQ6VXNlcjk0ODk2ODc=", "avatar_url": "https://avatars.githubusercontent.com/u/9489687?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pristas-peter", "html_url": "https://github.com/pristas-peter", "followers_url": "https://api.github.com/users/pristas-peter/followers", "following_url": "https://api.github.com/users/pristas-peter/following{/other_user}", "gists_url": "https://api.github.com/users/pristas-peter/gists{/gist_id}", "starred_url": "https://api.github.com/users/pristas-peter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pristas-peter/subscriptions", "organizations_url": "https://api.github.com/users/pristas-peter/orgs", "repos_url": "https://api.github.com/users/pristas-peter/repos", "events_url": "https://api.github.com/users/pristas-peter/events{/privacy}", "received_events_url": "https://api.github.com/users/pristas-peter/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 1548510206, "node_id": "MDU6TGFiZWwxNTQ4NTEwMjA2", "url": "https://api.github.com/repos/TanStack/query/labels/help%20wanted", "name": "help wanted", "color": "008672", "default": true, "description": "Extra attention is needed"}, {"id": 2849861769, "node_id": "MDU6TGFiZWwyODQ5ODYxNzY5", "url": "https://api.github.com/repos/TanStack/query/labels/package:%20react-query-devtools", "name": "package: react-query-devtools", "color": "00D8FE", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [{"login": "dhirajarun", "id": 69076988, "node_id": "MDQ6VXNlcjY5MDc2OTg4", "avatar_url": "https://avatars.githubusercontent.com/u/69076988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dhirajarun", "html_url": "https://github.com/dhirajarun", "followers_url": "https://api.github.com/users/dhirajarun/followers", "following_url": "https://api.github.com/users/dhirajarun/following{/other_user}", "gists_url": "https://api.github.com/users/dhirajarun/gists{/gist_id}", "starred_url": "https://api.github.com/users/dhirajarun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dhirajarun/subscriptions", "organizations_url": "https://api.github.com/users/dhirajarun/orgs", "repos_url": "https://api.github.com/users/dhirajarun/repos", "events_url": "https://api.github.com/users/dhirajarun/events{/privacy}", "received_events_url": "https://api.github.com/users/dhirajarun/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 20, "created_at": "2022-08-29T09:53:28Z", "updated_at": "2022-11-01T07:11:52Z", "closed_at": "2022-11-01T07:11:52Z", "assignee": {"login": "dhirajarun", "id": 69076988, "node_id": "MDQ6VXNlcjY5MDc2OTg4", "avatar_url": "https://avatars.githubusercontent.com/u/69076988?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dhirajarun", "html_url": "https://github.com/dhirajarun", "followers_url": "https://api.github.com/users/dhirajarun/followers", "following_url": "https://api.github.com/users/dhirajarun/following{/other_user}", "gists_url": "https://api.github.com/users/dhirajarun/gists{/gist_id}", "starred_url": "https://api.github.com/users/dhirajarun/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dhirajarun/subscriptions", "organizations_url": "https://api.github.com/users/dhirajarun/orgs", "repos_url": "https://api.github.com/users/dhirajarun/repos", "events_url": "https://api.github.com/users/dhirajarun/events{/privacy}", "received_events_url": "https://api.github.com/users/dhirajarun/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\r\n\r\nWe are encountering performance issues with the app when using devtools with many queries (around 1000). We are using normalised cache keys, when for example fetch of list items updates data in each single fetch query via setQueryData. \r\n\r\nHowever in v4, by using `useSyncExternalStore` things got really slow (app freezes for a short time when doing updates).\r\n\r\nIs it possible to update devtools by batches, or is it even necessary to \"observe\" every query when the devtools are closed? \r\n\r\n### Your minimal, reproducible example\r\n\r\n-\r\n\r\n### Steps to reproduce\r\n\r\n-\r\n\r\n### Expected behavior\r\n\r\n-\r\n\r\n### How often does this bug happen?\r\n\r\n_No response_\r\n\r\n### Screenshots or Videos\r\n\r\n_No response_\r\n\r\n### Platform\r\n\r\n-\r\n\r\n### react-query version\r\n\r\nv4 3.2.1\r\n\r\n### TypeScript version\r\n\r\n4.7.4\r\n\r\n### Additional context\r\n\r\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/4097/reactions", "total_count": 2, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/4097/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/5671", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/5671/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/5671/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/5671/events", "html_url": "https://github.com/TanStack/query/issues/5671", "id": 1787127176, "node_id": "I_kwDODGBpm85qhWWI", "number": 5671, "title": "react-query-devtools is not working in nextjs v13", "user": {"login": "SeungYn", "id": 66045666, "node_id": "MDQ6VXNlcjY2MDQ1NjY2", "avatar_url": "https://avatars.githubusercontent.com/u/66045666?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SeungYn", "html_url": "https://github.com/SeungYn", "followers_url": "https://api.github.com/users/SeungYn/followers", "following_url": "https://api.github.com/users/SeungYn/following{/other_user}", "gists_url": "https://api.github.com/users/SeungYn/gists{/gist_id}", "starred_url": "https://api.github.com/users/SeungYn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SeungYn/subscriptions", "organizations_url": "https://api.github.com/users/SeungYn/orgs", "repos_url": "https://api.github.com/users/SeungYn/repos", "events_url": "https://api.github.com/users/SeungYn/events{/privacy}", "received_events_url": "https://api.github.com/users/SeungYn/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 2849861769, "node_id": "MDU6TGFiZWwyODQ5ODYxNzY5", "url": "https://api.github.com/repos/TanStack/query/labels/package:%20react-query-devtools", "name": "package: react-query-devtools", "color": "00D8FE", "default": false, "description": ""}, {"id": 4734627825, "node_id": "LA_kwDODGBpm88AAAABGjSv8Q", "url": "https://api.github.com/repos/TanStack/query/labels/v5", "name": "v5", "color": "81ABFA", "default": false, "description": ""}, {"id": 5704676085, "node_id": "LA_kwDODGBpm88AAAABVAZy9Q", "url": "https://api.github.com/repos/TanStack/query/labels/package:%20query-devtools", "name": "package: query-devtools", "color": "BFDADC", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 15, "created_at": "2023-07-04T04:35:42Z", "updated_at": "2023-10-11T20:50:46Z", "closed_at": "2023-07-15T09:36:31Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\n\nreact-query-devtools is not working in nextjs v13\r\ni'm useing nextjs v13.4.5\r\n\"@tanstack/react-query\": \"^5.0.0-alpha.71\",\r\n\"@tanstack/react-query-devtools\": \"^5.0.0-alpha.72\",\r\n\r\nbut error occurs as follows \"Attempted import error: 'template is not exported from 'solid-js/web' (imported as 'template')\"\r\n\r\nand It works fine without devtools\r\n\r\ncode\r\n```\r\n'use client';\r\nimport { ReactQueryDevtools } from '@tanstack/react-query-devtools';\r\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\r\nimport { ReactNode } from 'react';\r\n\r\nexport default function ReactQueryContext({\r\n  children,\r\n}: {\r\n  children: ReactNode;\r\n}) {\r\n  const queryClient = new QueryClient();\r\n  return (\r\n    <QueryClientProvider client={queryClient}>\r\n      {children}\r\n      <ReactQueryDevtools initialIsOpen={false} />\r\n    </QueryClientProvider>\r\n  );\r\n}\r\n\r\n```\r\n\r\nlibrary\r\n<img width=\"557\" alt=\"image\" src=\"https://github.com/TanStack/query/assets/66045666/b2948959-b452-4333-b3d3-ce647d1a463b\">\r\n\r\nresult\r\n<img width=\"600\" alt=\"image\" src=\"https://github.com/TanStack/query/assets/66045666/f543b206-4f42-418e-84b5-ea98052bea7b\">\r\n\r\n\n\n### Your minimal, reproducible example\n\n.\n\n### Steps to reproduce\n\nreact-query-devtools is not working in nextjs v13\r\ni'm useing nextjs v13.4.5\r\n\"@tanstack/react-query\": \"^5.0.0-alpha.71\",\r\n\"@tanstack/react-query-devtools\": \"^5.0.0-alpha.72\",\r\n\r\nbut error occurs as follows \"Attempted import error: 'template is not exported from 'solid-js/web' (imported as 'template')\"\r\n\r\nand It works fine without devtools\r\n\n\n### Expected behavior\n\nreact-query-devtools is not working in nextjs v13\r\ni'm useing nextjs v13.4.5\r\n\"@tanstack/react-query\": \"^5.0.0-alpha.71\",\r\n\"@tanstack/react-query-devtools\": \"^5.0.0-alpha.72\",\r\n\r\nbut error occurs as follows \"Attempted import error: 'template is not exported from 'solid-js/web' (imported as 'template')\"\r\n\r\nand It works fine without devtools\r\n\n\n### How often does this bug happen?\n\nNone\n\n### Screenshots or Videos\n\n_No response_\n\n### Platform\n\nmacOs\n\n### Tanstack Query adapter\n\nNone\n\n### TanStack Query version\n\nv5.0.0-alpha.71\n\n### TypeScript version\n\nv5.1.3\n\n### Additional context\n\n_No response_", "closed_by": {"login": "lachlancollins", "id": 1667261, "node_id": "MDQ6VXNlcjE2NjcyNjE=", "avatar_url": "https://avatars.githubusercontent.com/u/1667261?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lachlancollins", "html_url": "https://github.com/lachlancollins", "followers_url": "https://api.github.com/users/lachlancollins/followers", "following_url": "https://api.github.com/users/lachlancollins/following{/other_user}", "gists_url": "https://api.github.com/users/lachlancollins/gists{/gist_id}", "starred_url": "https://api.github.com/users/lachlancollins/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lachlancollins/subscriptions", "organizations_url": "https://api.github.com/users/lachlancollins/orgs", "repos_url": "https://api.github.com/users/lachlancollins/repos", "events_url": "https://api.github.com/users/lachlancollins/events{/privacy}", "received_events_url": "https://api.github.com/users/lachlancollins/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/5671/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/5671/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/5436", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/5436/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/5436/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/5436/events", "html_url": "https://github.com/TanStack/query/issues/5436", "id": 1717036323, "node_id": "I_kwDODGBpm85mV-Uj", "number": 5436, "title": "[v5 beta] Type inference for `useQuery` breaks when using `queryOptions` util and `select`", "user": {"login": "jakst", "id": 3687893, "node_id": "MDQ6VXNlcjM2ODc4OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/3687893?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakst", "html_url": "https://github.com/jakst", "followers_url": "https://api.github.com/users/jakst/followers", "following_url": "https://api.github.com/users/jakst/following{/other_user}", "gists_url": "https://api.github.com/users/jakst/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakst/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakst/subscriptions", "organizations_url": "https://api.github.com/users/jakst/orgs", "repos_url": "https://api.github.com/users/jakst/repos", "events_url": "https://api.github.com/users/jakst/events{/privacy}", "received_events_url": "https://api.github.com/users/jakst/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 2009304499, "node_id": "MDU6TGFiZWwyMDA5MzA0NDk5", "url": "https://api.github.com/repos/TanStack/query/labels/types", "name": "types", "color": "3babed", "default": false, "description": ""}, {"id": 4734627825, "node_id": "LA_kwDODGBpm88AAAABGjSv8Q", "url": "https://api.github.com/repos/TanStack/query/labels/v5", "name": "v5", "color": "81ABFA", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 15, "created_at": "2023-05-19T10:42:39Z", "updated_at": "2023-07-31T07:50:30Z", "closed_at": "2023-07-31T07:50:30Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\n\nWhen using the new `queryOptions` util from react-query v5, type inference seems to be a bit fragile. For example when spreading the resulting options object and adding a select statement to the query, the resulting data type is incorrect. More interestingly, the type seems to be inferred correctly if we also set the type `refetchInterval` option. I haven't tested around exactly which other options trigger this behaviour, but I believe this data point should be helpful enough in fixing the issue.\r\n\r\n```typescript\r\nimport { queryOptions } from '@tanstack/react-query'\r\n\r\nconst options = queryOptions({\r\n  queryKey: [\"key\"],\r\n  queryFn: () => Promise.resolve(1),\r\n});\r\n\r\n// Type inference breaks, so TS complains about return type of select()\r\nconst query1 = useQuery({\r\n  ...options,\r\n  select: (data) => data > 1\r\n});\r\n\r\n// Type inference works like it should, so query2.data has type boolean\r\nconst query2 = useQuery({\r\n  ...options,\r\n  select: (data) => data > 1,\r\n  refetchInterval: 1,\r\n});\r\n\r\n// When inlining the query options, types are correct even without refetchInterval\r\nconst query3 = useQuery({\r\n  queryKey: [\"key\"],\r\n  queryFn: () => Promise.resolve(1),\r\n  select: (data) => data > 1,\r\n});\r\n```\n\n### Your minimal, reproducible example\n\nhttps://codesandbox.io/p/sandbox/festive-platform-0krnf3?file=%2Fsrc%2FApp.tsx%3A21%2C28\n\n### Steps to reproduce\n\n* Open the codesandbox\r\n* See the ts errors in the editor\n\n### Expected behavior\n\nThe correct data type should be inferred from the return type of the select function in useQuery.\n\n### How often does this bug happen?\n\nEvery time\n\n### Screenshots or Videos\n\n_No response_\n\n### Platform\n\nv5.0.0-alpha.34\n\n### Tanstack Query adapter\n\nreact-query\n\n### TanStack Query version\n\nv5.0.0-alpha.34\n\n### TypeScript version\n\nv5.0.4\n\n### Additional context\n\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/5436/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/5436/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/3215", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/3215/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/3215/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/3215/events", "html_url": "https://github.com/TanStack/query/issues/3215", "id": 1109040018, "node_id": "I_kwDODGBpm85CGpuS", "number": 3215, "title": "NotifyManager breaks when a exception occurs in onSuccess callback", "user": {"login": "sin3hz", "id": 5888216, "node_id": "MDQ6VXNlcjU4ODgyMTY=", "avatar_url": "https://avatars.githubusercontent.com/u/5888216?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sin3hz", "html_url": "https://github.com/sin3hz", "followers_url": "https://api.github.com/users/sin3hz/followers", "following_url": "https://api.github.com/users/sin3hz/following{/other_user}", "gists_url": "https://api.github.com/users/sin3hz/gists{/gist_id}", "starred_url": "https://api.github.com/users/sin3hz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sin3hz/subscriptions", "organizations_url": "https://api.github.com/users/sin3hz/orgs", "repos_url": "https://api.github.com/users/sin3hz/repos", "events_url": "https://api.github.com/users/sin3hz/events{/privacy}", "received_events_url": "https://api.github.com/users/sin3hz/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 2039108783, "node_id": "MDU6TGFiZWwyMDM5MTA4Nzgz", "url": "https://api.github.com/repos/TanStack/query/labels/released", "name": "released", "color": "ededed", "default": false, "description": null}, {"id": 3619132867, "node_id": "LA_kwDODGBpm87Xt5XD", "url": "https://api.github.com/repos/TanStack/query/labels/released%20on%20@alpha", "name": "released on @alpha", "color": "ededed", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 14, "created_at": "2022-01-20T09:06:27Z", "updated_at": "2022-11-11T19:45:53Z", "closed_at": "2022-01-21T12:24:22Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\r\n\r\nWhen a exception occurs in `onSuccess` callback\r\n```ts\r\nmutation.mutate(\r\n  {},\r\n  {\r\n    onSuccess: () => {\r\n      throw new Error();\r\n    },\r\n  },\r\n);\r\n```\r\nwhitch notify by `NotifyManager.batch`\r\n```ts\r\nbatch<T>(callback: () => T): T {\r\n  this.transactions++\r\n  const result = callback() // exception raise\r\n  this.transactions-- // not executed\r\n  if (!this.transactions) { // never be 0\r\n    this.flush()\r\n  }\r\n  return result\r\n}\r\n```\r\nsince `NotifyManager.batch` breaks, all newly created query's result would stuck in loading state even fetch succuessful\r\n\r\n### Your minimal, reproducible example\r\nhttps://codesandbox.io/s/gracious-danny-zfq8u?file=/src/App.js\r\n1. click mutate\r\n2. click query\r\n\r\n### Steps to reproduce\r\n\r\n```ts\r\nmutation.mutate(\r\n  {},\r\n  {\r\n    onSuccess: () => {\r\n      throw new Error();\r\n    },\r\n  },\r\n);\r\n```\r\n\r\n### Expected behavior\r\n\r\nQueryObervable should notify onSuccess defensively\r\n\r\n### How often does this bug happen?\r\n\r\n_No response_\r\n\r\n### Screenshots or Videos\r\n\r\n_No response_\r\n\r\n### Platform\r\n\r\nirrelevant\r\n\r\n### react-query version\r\n\r\n3.34.7\r\n\r\n### TypeScript version\r\n\r\n_No response_\r\n\r\n### Additional context\r\n\r\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/3215/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/3215/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/1575", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/1575/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/1575/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/1575/events", "html_url": "https://github.com/TanStack/query/issues/1575", "id": 779075546, "node_id": "MDU6SXNzdWU3NzkwNzU1NDY=", "number": 1575, "title": "Explode useQueryClient losing this reference", "user": {"login": "lrdass", "id": 66750963, "node_id": "MDQ6VXNlcjY2NzUwOTYz", "avatar_url": "https://avatars.githubusercontent.com/u/66750963?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lrdass", "html_url": "https://github.com/lrdass", "followers_url": "https://api.github.com/users/lrdass/followers", "following_url": "https://api.github.com/users/lrdass/following{/other_user}", "gists_url": "https://api.github.com/users/lrdass/gists{/gist_id}", "starred_url": "https://api.github.com/users/lrdass/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lrdass/subscriptions", "organizations_url": "https://api.github.com/users/lrdass/orgs", "repos_url": "https://api.github.com/users/lrdass/repos", "events_url": "https://api.github.com/users/lrdass/events{/privacy}", "received_events_url": "https://api.github.com/users/lrdass/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 2138452195, "node_id": "MDU6TGFiZWwyMTM4NDUyMTk1", "url": "https://api.github.com/repos/TanStack/query/labels/merge%20pending", "name": "merge pending", "color": "5319e7", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 14, "created_at": "2021-01-05T14:07:43Z", "updated_at": "2024-01-16T12:35:48Z", "closed_at": "2021-06-04T19:40:24Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Describe the bug**\r\nexplode `const {invalidateQuery} = useQueryClient()` makes the `invalidateQuery` lose `this` context\r\n\r\n**To Reproduce**\r\n`const {invalidateQuery} = useQueryClient()`\r\n`invalidateQuery()`\r\nhttps://codesandbox.io/s/clever-keldysh-704g7?fontsize=14&hidenavigation=1&theme=dark&file=/src/index.js\r\n\r\n\r\n**Expected behavior**\r\nIf exploded the `useQueryClient`  object, invalidateQuery should not lost `this` reference\r\n\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Linux Ubuntu\r\n - Browser: Firefox\r\n - Version: Latest\r\n", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/1575/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/1575/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/4874", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/4874/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/4874/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/4874/events", "html_url": "https://github.com/TanStack/query/issues/4874", "id": 1556508697, "node_id": "I_kwDODGBpm85cxnAZ", "number": 4874, "title": "useQueryErrorResetBoundary() does not resets errorneous useQueries()", "user": {"login": "chekrd", "id": 25004106, "node_id": "MDQ6VXNlcjI1MDA0MTA2", "avatar_url": "https://avatars.githubusercontent.com/u/25004106?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chekrd", "html_url": "https://github.com/chekrd", "followers_url": "https://api.github.com/users/chekrd/followers", "following_url": "https://api.github.com/users/chekrd/following{/other_user}", "gists_url": "https://api.github.com/users/chekrd/gists{/gist_id}", "starred_url": "https://api.github.com/users/chekrd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chekrd/subscriptions", "organizations_url": "https://api.github.com/users/chekrd/orgs", "repos_url": "https://api.github.com/users/chekrd/repos", "events_url": "https://api.github.com/users/chekrd/events{/privacy}", "received_events_url": "https://api.github.com/users/chekrd/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 1548510207, "node_id": "MDU6TGFiZWwxNTQ4NTEwMjA3", "url": "https://api.github.com/repos/TanStack/query/labels/good%20first%20issue", "name": "good first issue", "color": "7057ff", "default": true, "description": "Good for newcomers"}, {"id": 4335258818, "node_id": "LA_kwDODGBpm88AAAABAmbMwg", "url": "https://api.github.com/repos/TanStack/query/labels/package:%20react-query", "name": "package: react-query", "color": "00D8FE", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 13, "created_at": "2023-01-25T11:45:32Z", "updated_at": "2024-01-11T15:23:17Z", "closed_at": "2023-04-24T11:00:58Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\r\n\r\nWith useQuery, reset callback runs failed query again. With useQueries nothing happens and the error boundary fallback is unmounted.\r\n\r\n### Your minimal, reproducible example\r\n\r\nhttps://codesandbox.io/s/bold-robinson-pu7zl2?file=/src/App.js\r\n\r\n### Steps to reproduce\r\n\r\n1. Go to https://codesandbox.io/s/bold-robinson-pu7zl2?file=/src/App.js\r\n2. Click the \"Show component\" button.\r\n3. Error boundary renders fallback (correct).\r\n4. Click the \"Try again\" button.\r\n5. The query is not reset. Also, ErrorBoundary stops rendering the fallback.\r\n\r\nYou can comment out line 22 and uncomment line 20 for comparison with useQuery. UseQuery correctly resets and fetches again.\r\n\r\n### Expected behavior\r\n\r\nuseQuery and useQueries both should reset erroneous queries when reset() is called.\r\n\r\n### How often does this bug happen?\r\n\r\nEvery time\r\n\r\n### Screenshots or Videos\r\n\r\n_No response_\r\n\r\n### Platform\r\n\r\nPlatform independent\r\n\r\n### TanStack Query version\r\n\r\n4.22.4\r\n\r\n### TypeScript version\r\n\r\n_No response_\r\n\r\n### Additional context\r\n\r\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/4874/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/4874/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/6148", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/6148/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/6148/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/6148/events", "html_url": "https://github.com/TanStack/query/issues/6148", "id": 1941461980, "node_id": "I_kwDODGBpm85zuFvc", "number": 6148, "title": "PersistQueryClientProvider is not working with suspense query", "user": {"login": "manhhavu", "id": 4518211, "node_id": "MDQ6VXNlcjQ1MTgyMTE=", "avatar_url": "https://avatars.githubusercontent.com/u/4518211?v=4", "gravatar_id": "", "url": "https://api.github.com/users/manhhavu", "html_url": "https://github.com/manhhavu", "followers_url": "https://api.github.com/users/manhhavu/followers", "following_url": "https://api.github.com/users/manhhavu/following{/other_user}", "gists_url": "https://api.github.com/users/manhhavu/gists{/gist_id}", "starred_url": "https://api.github.com/users/manhhavu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/manhhavu/subscriptions", "organizations_url": "https://api.github.com/users/manhhavu/orgs", "repos_url": "https://api.github.com/users/manhhavu/repos", "events_url": "https://api.github.com/users/manhhavu/events{/privacy}", "received_events_url": "https://api.github.com/users/manhhavu/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 2477717738, "node_id": "MDU6TGFiZWwyNDc3NzE3NzM4", "url": "https://api.github.com/repos/TanStack/query/labels/suspense", "name": "suspense", "color": "dbff9e", "default": false, "description": ""}, {"id": 4335261745, "node_id": "LA_kwDODGBpm88AAAABAmbYMQ", "url": "https://api.github.com/repos/TanStack/query/labels/package:%20react-query-persist-client", "name": "package: react-query-persist-client", "color": "00D8FE", "default": false, "description": ""}, {"id": 4766674394, "node_id": "LA_kwDODGBpm88AAAABHB2t2g", "url": "https://api.github.com/repos/TanStack/query/labels/has%20workaround", "name": "has workaround", "color": "A1825F", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 12, "created_at": "2023-10-13T08:10:23Z", "updated_at": "2024-10-12T07:28:30Z", "closed_at": "2023-11-28T10:30:28Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\r\n\r\nPersistQueryClientProvider is not working with suspense query \r\n\r\n### Your minimal, reproducible example\r\n\r\nhttps://codesandbox.io/s/suspense-persistqueryclientprovider-bug-qdy8cz\r\n\r\nhttps://snack.expo.dev/@manhhavu/persistentqueryclientprovider-suspense-bug\r\n\r\n### Steps to reproduce\r\n\r\nI have to say sorry in advance that I tried to reproduce it with Expo Snack but there is some strange behavior in module resolution on [Snack](https://snack.expo.dev/@manhhavu/persistentqueryclientprovider-suspense-bug) that the app couldn't even run. You can checkout the reproducible bug from [this repo](https://github.com/manhhavu/persister-bug) to fully see the problem.\r\n\r\nI'm using useSuspenseQuery with **rc12** version. If I only use QueryClientProvider, Suspense is working, the fallback of Suspense is shown while waiting for the data. When the data is available, the related component is render. \r\n\r\n```jsx\r\nexport default function App() {\r\n  return (\r\n    <QueryClientProvider\r\n      client={queryClient}\r\n    >\r\n      <View style={styles.container}>\r\n        <Suspense fallback={<ActivityIndicator />}>\r\n          <Todo />\r\n        </Suspense>\r\n      </View>\r\n    </QueryClientProvider>\r\n  );\r\n}\r\n\r\nfunction Todo() {\r\n  const { data: todo } = useTodo()\r\n  return (\r\n    <View style={{flexDirection: 'row'}}>\r\n      <Checkbox\r\n          value={todo.completed}\r\n          style={{alignSelf: 'center'}}\r\n        />\r\n      <Text style={{marginLeft: 8}}>{todo.title}</Text>\r\n    </View>\r\n  )\r\n}\r\n\r\nfunction useTodo() {\r\n  return useSuspenseQuery({\r\n    queryKey: ['todo'],\r\n    queryFn: async () => {\r\n      return await fetchTodo()\r\n    }\r\n  })\r\n}\r\n```\r\n\r\nif I change the config to use PersistQueryClientProvider instead of QueryClientProvider:\r\n\r\n```jsx\r\nexport default function App() {\r\n  return (\r\n    <PersistQueryClientProvider\r\n      persistOptions={{ persister: persister }}\r\n      client={queryClient}\r\n    >\r\n      <View style={styles.container}>\r\n        <Suspense fallback={<ActivityIndicator />}>\r\n          <Todo />\r\n        </Suspense>\r\n      </View>\r\n    </PersistQueryClientProvider>\r\n  );\r\n}\r\n```\r\nthen this part of Todo is supposed to suspended until the data is available, but it is isn't:\r\n```jsx\r\nfunction Todo() {\r\n  // should suspense here so that the todo object is not null before continuing\r\n  // but it isn't the case. \r\n  const { data: todo } = useTodo()\r\n  // ...\r\n}\r\n```\r\nThe data/todo object is null which will fail the code below which tries to access it.\r\n\r\n\r\n### Expected behavior\r\n\r\nThe behavior of PersistQueryClientProvider should be identical to QueryClientProvider regarding Suspense query. \r\n\r\n### How often does this bug happen?\r\n\r\nEvery time\r\n\r\n### Screenshots or Videos\r\n\r\n_No response_\r\n\r\n### Platform\r\n\r\n- OS: iOS 17 on macOS Ventura 13.6\r\n- Expo: 49\r\n\r\n### Tanstack Query adapter\r\n\r\nreact-query\r\n\r\n### TanStack Query version\r\n\r\nv5.0.0-rc.12\r\n\r\n### TypeScript version\r\n\r\n_No response_\r\n\r\n### Additional context\r\n\r\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/6148/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/6148/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/5968", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/5968/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/5968/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/5968/events", "html_url": "https://github.com/TanStack/query/issues/5968", "id": 1884126616, "node_id": "I_kwDODGBpm85wTX2Y", "number": 5968, "title": "Race condition near query cancellation/invalidation while implementing optimistic update", "user": {"login": "KartheekJavvaji", "id": 12635717, "node_id": "MDQ6VXNlcjEyNjM1NzE3", "avatar_url": "https://avatars.githubusercontent.com/u/12635717?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KartheekJavvaji", "html_url": "https://github.com/KartheekJavvaji", "followers_url": "https://api.github.com/users/KartheekJavvaji/followers", "following_url": "https://api.github.com/users/KartheekJavvaji/following{/other_user}", "gists_url": "https://api.github.com/users/KartheekJavvaji/gists{/gist_id}", "starred_url": "https://api.github.com/users/KartheekJavvaji/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KartheekJavvaji/subscriptions", "organizations_url": "https://api.github.com/users/KartheekJavvaji/orgs", "repos_url": "https://api.github.com/users/KartheekJavvaji/repos", "events_url": "https://api.github.com/users/KartheekJavvaji/events{/privacy}", "received_events_url": "https://api.github.com/users/KartheekJavvaji/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 1548510206, "node_id": "MDU6TGFiZWwxNTQ4NTEwMjA2", "url": "https://api.github.com/repos/TanStack/query/labels/help%20wanted", "name": "help wanted", "color": "008672", "default": true, "description": "Extra attention is needed"}, {"id": 4766674394, "node_id": "LA_kwDODGBpm88AAAABHB2t2g", "url": "https://api.github.com/repos/TanStack/query/labels/has%20workaround", "name": "has workaround", "color": "A1825F", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 12, "created_at": "2023-09-06T14:22:36Z", "updated_at": "2023-09-13T06:22:49Z", "closed_at": "2023-09-13T06:22:48Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\r\n\r\n**Requirements**: \r\nAssume the application has multiple entities present such as docs, slides, etc. We should now add a bookmarking ability to the system.\r\n\r\n**Implementation**: \r\nI have implemented an optimistic update approach near bookmarking an entity in the application and have also made use of the abort signal for query cancellations.\r\n\r\n**Issue**: \r\nLet's say I bookmark certain docs while on the docs page and quickly move to the bookmarks page, I see that the bookmarks list API-related query is getting canceled and is stuck in isFetching: true. Because of this, we are left with the entries added by the UI optimistic update and not the ones from the server.\r\n\r\n\r\n### Your minimal, reproducible example\r\n\r\nhttps://codesandbox.io/p/sandbox/loving-forest-2t69p7\r\n\r\n### Steps to reproduce\r\n\r\nIn the example, we have 2 routes -> `Add Items` and `Item List`. I have added a mock service that mocks an API call with a ~1-second delay.\r\n\r\nI differentiate the UI-added entry and the mock service-added entry by having a different pattern for IDs. All the entries added through optimistic updates will have a prefix \"**\\_\\_UI\\_\\_** \" in their IDs. All the entries from the mock service will have the prefix \"**From Service**\" in their IDs.\r\n\r\n1. Go to the **Add Items** page and add 3-4 items by pressing the _Add Item_ button again and again before even the re-fetch can finish (this is to trigger the query cancellation). We can see the optimistic update-related logic at `src/useItems.ts`.\r\n2. After the last addition of the items, move to **Item List** before the fetch can finish\r\n3. We can now see that the last re-fetch that is triggered due to the query invalidation written in the onSettled method is getting canceled. And now we end up with entries added by UI optimistic update and not the actual server state.\r\n\r\n### Expected behavior\r\n\r\nHow do we ensure we can always have the server state in this scenario?  I am guessing that component unmount is causing this query cancellation. Please watch the video attached as this race condition doesn't happen every single time. And if we give it enough time near the `Add Items` page, there won't even be any issue popping up. \r\n\r\nWithout having the actual server state [actual IDs assigned by BE],  we won't be able to act upon those entries.\r\n\r\n\r\n\r\n### How often does this bug happen?\r\n\r\nOften\r\n\r\n### Screenshots or Videos\r\n\r\nhttps://github.com/TanStack/query/assets/12635717/b4580697-387b-468b-aebe-4ba00c8b5809\r\n\r\n### Platform\r\n\r\n- macOS 13.2\r\n- Chrome 112.0.5615.137\r\n\r\n### Tanstack Query adapter\r\n\r\nNone\r\n\r\n### TanStack Query version\r\n\r\n4.32.6\r\n\r\n### TypeScript version\r\n\r\n_No response_\r\n\r\n### Additional context\r\n\r\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/5968/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/5968/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/9579", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/9579/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/9579/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/9579/events", "html_url": "https://github.com/TanStack/query/issues/9579", "id": 3334417314, "node_id": "I_kwDODGBpm87Gvyui", "number": 9579, "title": "v5.85.2 introduced a breaking change while using StrictMode", "user": {"login": "pvs-chainalysis", "id": 122369536, "node_id": "U_kgDOB0s2AA", "avatar_url": "https://avatars.githubusercontent.com/u/122369536?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pvs-chainalysis", "html_url": "https://github.com/pvs-chainalysis", "followers_url": "https://api.github.com/users/pvs-chainalysis/followers", "following_url": "https://api.github.com/users/pvs-chainalysis/following{/other_user}", "gists_url": "https://api.github.com/users/pvs-chainalysis/gists{/gist_id}", "starred_url": "https://api.github.com/users/pvs-chainalysis/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pvs-chainalysis/subscriptions", "organizations_url": "https://api.github.com/users/pvs-chainalysis/orgs", "repos_url": "https://api.github.com/users/pvs-chainalysis/repos", "events_url": "https://api.github.com/users/pvs-chainalysis/events{/privacy}", "received_events_url": "https://api.github.com/users/pvs-chainalysis/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 11, "created_at": "2025-08-19T13:34:36Z", "updated_at": "2025-09-01T16:44:55Z", "closed_at": "2025-08-30T12:19:18Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\n\nv5.85.2 introduced a breaking change while using `StrictMode` impacting state of `isLoading` and `isFetching`\n\nOn initial load state of `isLoading` doesn't reflect described API behaviour, API states that `isLoading` reflects the state of the first fetch, not subsequent fetches. However with `StrictMode` enabled `isLoading` reverts to `false` before the first request finishes \n\nExample: https://stackblitz.com/edit/tanstack-query-2c4dbawu?file=src%2Findex.tsx\n\nExample above updates DOM as request state changes:  `req1: isLoading:false, state: success, fetching: false data: request 1, time=1755607826585`. `time=` is added when request is finished\n\n### Your minimal, reproducible example\n\nhttps://stackblitz.com/edit/tanstack-query-2c4dbawu?file=src%2Findex.tsx\n\n### Steps to reproduce\n\n1. On initial load observe that `isLoading: true`, `state: pending` and `fetching: false`\n2. Observe `isLoading` quickly changes to `false` but `state` remains `pending`.\n\nBefore `v5.85.2` `isLoading` would remain true until first request completes. If `StrictMode` is removed `isLoading` behaves as expected\n\nDowngrade to 5.85.0 `npm install @tanstack/react-query-devtools@5.85.0 @tanstack/react-query@5.85.0` and run the example again `npm run dev` and observe `isLoading` behaves as expected.\n\n### Expected behavior\n\nAt first load `isLoading` and `isFetching` should reflect the `status` of the first request.\n\n### How often does this bug happen?\n\nEvery time\n\n### Screenshots or Videos\n\nhttps://github.com/user-attachments/assets/58464f7e-c7bf-4246-a0c3-3debf3e97882\n\n### Platform\n\n- OS: macOS\n- Browser: Chrome\n- Version: 5.85.2\n\n### Tanstack Query adapter\n\nNone\n\n### TanStack Query version\n\n5.85.2\n\n### TypeScript version\n\n_No response_\n\n### Additional context\n\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/9579/reactions", "total_count": 5, "+1": 4, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/9579/timeline", "performed_via_github_app": null, "state_reason": "completed"}, {"url": "https://api.github.com/repos/TanStack/query/issues/5417", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/5417/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/5417/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/5417/events", "html_url": "https://github.com/TanStack/query/issues/5417", "id": 1711653926, "node_id": "I_kwDODGBpm85mBcQm", "number": 5417, "title": "Devtools crashes under TrustedTypes", "user": {"login": "Jack-Works", "id": 5390719, "node_id": "MDQ6VXNlcjUzOTA3MTk=", "avatar_url": "https://avatars.githubusercontent.com/u/5390719?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jack-Works", "html_url": "https://github.com/Jack-Works", "followers_url": "https://api.github.com/users/Jack-Works/followers", "following_url": "https://api.github.com/users/Jack-Works/following{/other_user}", "gists_url": "https://api.github.com/users/Jack-Works/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jack-Works/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jack-Works/subscriptions", "organizations_url": "https://api.github.com/users/Jack-Works/orgs", "repos_url": "https://api.github.com/users/Jack-Works/repos", "events_url": "https://api.github.com/users/Jack-Works/events{/privacy}", "received_events_url": "https://api.github.com/users/Jack-Works/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 4734627825, "node_id": "LA_kwDODGBpm88AAAABGjSv8Q", "url": "https://api.github.com/repos/TanStack/query/labels/v5", "name": "v5", "color": "81ABFA", "default": false, "description": ""}, {"id": 5704676085, "node_id": "LA_kwDODGBpm88AAAABVAZy9Q", "url": "https://api.github.com/repos/TanStack/query/labels/package:%20query-devtools", "name": "package: query-devtools", "color": "BFDADC", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 11, "created_at": "2023-05-16T09:44:42Z", "updated_at": "2024-09-15T15:37:41Z", "closed_at": "2024-09-15T15:37:40Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\n\nCrash\r\n\r\n<img width=\"1230\" alt=\"image\" src=\"https://github.com/TanStack/query/assets/5390719/6372d496-b2b3-4090-bdc4-422f99f2936e\">\r\n\n\n### Your minimal, reproducible example\n\nN/A\n\n### Steps to reproduce\n\nAdd a TrustedType policy before rendering the devtool.\n\n### Expected behavior\n\nDo not use `dangerouslySetInnerHTML`.\r\n\r\nhttps://github.com/TanStack/query/blob/fd02255066ac3a136f6b62863387c486d0d560fc/packages/react-query-devtools/src/devtools.tsx#L532\r\n\r\nI see a `nonce` option but we cannot change the CSP header to do that. The HTML rendered can be static if you use CSS variables to replace them, or you can use CSSOM to insert CSS rules manually too`SheetElement.sheet`\n\n### How often does this bug happen?\n\nEvery time\n\n### Screenshots or Videos\n\n_No response_\n\n### Platform\n\nChrome\n\n### Tanstack Query adapter\n\nNone\n\n### TanStack Query version\n\n4.29.7\n\n### TypeScript version\n\n_No response_\n\n### Additional context\n\n_No response_", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/5417/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/5417/timeline", "performed_via_github_app": null, "state_reason": "not_planned"}, {"url": "https://api.github.com/repos/TanStack/query/issues/4896", "repository_url": "https://api.github.com/repos/TanStack/query", "labels_url": "https://api.github.com/repos/TanStack/query/issues/4896/labels{/name}", "comments_url": "https://api.github.com/repos/TanStack/query/issues/4896/comments", "events_url": "https://api.github.com/repos/TanStack/query/issues/4896/events", "html_url": "https://github.com/TanStack/query/issues/4896", "id": 1560975566, "node_id": "I_kwDODGBpm85dCpjO", "number": 4896, "title": "race condition in offline -> online state transition with dependent mutations", "user": {"login": "jligeza", "id": 12465301, "node_id": "MDQ6VXNlcjEyNDY1MzAx", "avatar_url": "https://avatars.githubusercontent.com/u/12465301?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jligeza", "html_url": "https://github.com/jligeza", "followers_url": "https://api.github.com/users/jligeza/followers", "following_url": "https://api.github.com/users/jligeza/following{/other_user}", "gists_url": "https://api.github.com/users/jligeza/gists{/gist_id}", "starred_url": "https://api.github.com/users/jligeza/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jligeza/subscriptions", "organizations_url": "https://api.github.com/users/jligeza/orgs", "repos_url": "https://api.github.com/users/jligeza/repos", "events_url": "https://api.github.com/users/jligeza/events{/privacy}", "received_events_url": "https://api.github.com/users/jligeza/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1548510199, "node_id": "MDU6TGFiZWwxNTQ4NTEwMTk5", "url": "https://api.github.com/repos/TanStack/query/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 4420036382, "node_id": "LA_kwDODGBpm88AAAABB3RnHg", "url": "https://api.github.com/repos/TanStack/query/labels/package:%20query-core", "name": "package: query-core", "color": "BFDADC", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 11, "created_at": "2023-01-28T19:09:45Z", "updated_at": "2024-03-16T19:16:05Z", "closed_at": "2023-02-12T08:57:45Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Describe the bug\n\nThe react-query does not respect dependencies between offline-created mutations during their synchronization. They are fired all at once, which might cause race conditions in some cases.\r\n\r\nThe problem does not exist after state hydration, where `queryClient.resumePausedMutations` function makes the mutations fire one after another.\n\n### Your minimal, reproducible example\n\nhttps://codesandbox.io/s/beautiful-voice-ykc42f?file=/src/App.tsx\n\n### Steps to reproduce\n\n1. Open codesandbox link.\r\n2. Disable network access using browser debugger to enter offline mode.\r\n3. Create new post.\r\n4. Submit it.\r\n5. Restore network.\r\n\r\nThe draft post is created, but not submitted.\n\n### Expected behavior\n\nA draft post should be created and submitted.\r\nThe submission mutation should wait for the creation mutation to finish.\n\n### How often does this bug happen?\n\nNone\n\n### Screenshots or Videos\n\n_No response_\n\n### Platform\n\nwindows 10, Brave 1.47.186 Chromium: 109.0.5414.119\n\n### TanStack Query version\n\n4.23.0\n\n### TypeScript version\n\n4.9.3\n\n### Additional context\n\nCreated after submission of [this stackoverflow question](https://stackoverflow.com/questions/75109195/react-query-how-to-avoid-race-condition-and-ensure-synchronization-order-of-dep?noredirect=1#comment132573636_75109195).", "closed_by": {"login": "TkDodo", "id": 1021430, "node_id": "MDQ6VXNlcjEwMjE0MzA=", "avatar_url": "https://avatars.githubusercontent.com/u/1021430?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TkDodo", "html_url": "https://github.com/TkDodo", "followers_url": "https://api.github.com/users/TkDodo/followers", "following_url": "https://api.github.com/users/TkDodo/following{/other_user}", "gists_url": "https://api.github.com/users/TkDodo/gists{/gist_id}", "starred_url": "https://api.github.com/users/TkDodo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TkDodo/subscriptions", "organizations_url": "https://api.github.com/users/TkDodo/orgs", "repos_url": "https://api.github.com/users/TkDodo/repos", "events_url": "https://api.github.com/users/TkDodo/events{/privacy}", "received_events_url": "https://api.github.com/users/TkDodo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/TanStack/query/issues/4896/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/TanStack/query/issues/4896/timeline", "performed_via_github_app": null, "state_reason": "completed"}]}