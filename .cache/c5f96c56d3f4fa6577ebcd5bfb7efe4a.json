{"d": [{"url": "https://api.github.com/repos/helm/helm/issues/1193", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/1193/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/1193/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/1193/events", "html_url": "https://github.com/helm/helm/issues/1193", "id": 176719112, "node_id": "MDU6SXNzdWUxNzY3MTkxMTI=", "number": 1193, "title": "UPGRADE FAILED: No resource with the name \"\" found", "user": {"login": "devth", "id": 86107, "node_id": "MDQ6VXNlcjg2MTA3", "avatar_url": "https://avatars.githubusercontent.com/u/86107?v=4", "gravatar_id": "", "url": "https://api.github.com/users/devth", "html_url": "https://github.com/devth", "followers_url": "https://api.github.com/users/devth/followers", "following_url": "https://api.github.com/users/devth/following{/other_user}", "gists_url": "https://api.github.com/users/devth/gists{/gist_id}", "starred_url": "https://api.github.com/users/devth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/devth/subscriptions", "organizations_url": "https://api.github.com/users/devth/orgs", "repos_url": "https://api.github.com/users/devth/repos", "events_url": "https://api.github.com/users/devth/events{/privacy}", "received_events_url": "https://api.github.com/users/devth/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [{"login": "michelleN", "id": 1497123, "node_id": "MDQ6VXNlcjE0OTcxMjM=", "avatar_url": "https://avatars.githubusercontent.com/u/1497123?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michelleN", "html_url": "https://github.com/michelleN", "followers_url": "https://api.github.com/users/michelleN/followers", "following_url": "https://api.github.com/users/michelleN/following{/other_user}", "gists_url": "https://api.github.com/users/michelleN/gists{/gist_id}", "starred_url": "https://api.github.com/users/michelleN/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michelleN/subscriptions", "organizations_url": "https://api.github.com/users/michelleN/orgs", "repos_url": "https://api.github.com/users/michelleN/repos", "events_url": "https://api.github.com/users/michelleN/events{/privacy}", "received_events_url": "https://api.github.com/users/michelleN/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 110, "created_at": "2016-09-13T18:47:54Z", "updated_at": "2019-06-07T11:04:17Z", "closed_at": "2019-04-05T16:34:26Z", "assignee": {"login": "michelleN", "id": 1497123, "node_id": "MDQ6VXNlcjE0OTcxMjM=", "avatar_url": "https://avatars.githubusercontent.com/u/1497123?v=4", "gravatar_id": "", "url": "https://api.github.com/users/michelleN", "html_url": "https://github.com/michelleN", "followers_url": "https://api.github.com/users/michelleN/followers", "following_url": "https://api.github.com/users/michelleN/following{/other_user}", "gists_url": "https://api.github.com/users/michelleN/gists{/gist_id}", "starred_url": "https://api.github.com/users/michelleN/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/michelleN/subscriptions", "organizations_url": "https://api.github.com/users/michelleN/orgs", "repos_url": "https://api.github.com/users/michelleN/repos", "events_url": "https://api.github.com/users/michelleN/events{/privacy}", "received_events_url": "https://api.github.com/users/michelleN/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "## Repro\n\nCreate a simple Chart.yaml:\n\n``` yaml\nname: upgrade-repro\nversion: 0.1.0\n```\n\nWith a single K8S resource in the `templates/` dir:\n\n``` yaml\nkind: ConfigMap\napiVersion: v1\nmetadata:\n  name: cm1\ndata:\n  example.property.1: hello\n```\n\nInstall the chart:\n\n``` bash\nhelm install .\nexasperated-op\nLast Deployed: Tue Sep 13 12:43:23 2016\nNamespace: default\nStatus: DEPLOYED\n\nResources:\n==> v1/ConfigMap\nNAME      DATA      AGE\ncm1       1         0s\n```\n\nVerify the release exists:\n\n``` bash\nhelm status exasperated-op\nLast Deployed: Tue Sep 13 12:43:23 2016\nNamespace: default\nStatus: DEPLOYED\n\nResources:\n==> v1/ConfigMap\nNAME      DATA      AGE\ncm1       1         1m\n```\n\nNow add a 2nd K8S resource in `templates/` dir:\n\n``` yaml\nkind: ConfigMap\napiVersion: v1\nmetadata:\n  name: cm2\ndata:\n  example.property.2: hello\n```\n\nUpgrade the chart:\n\n``` bash\nhelm upgrade exasperated-op .\nError: UPGRADE FAILED: Looks like there are no changes for cm1\n```\n\nThat's weird. Bump the version in Chart.yaml:\n\n``` yaml\nname: upgrade-repro\nversion: 0.2.0\n```\n\nTry upgrade again:\n\n``` yaml\nhelm upgrade exasperated-op .\nError: UPGRADE FAILED: No resource with the name cm2 found.\n```\n## Expected\n\n`helm upgrade` should create the `cm2` resource instead of erroring that it doesn't exist.\n\nEdit: to be clear: helm _is_ creating the `cm2` ConfigMap, but helm fails regardless.\n## Current state after performing steps\n\n``` bash\nhelm status exasperated-op\nLast Deployed: Tue Sep 13 12:43:23 2016\nNamespace: default\nStatus: DEPLOYED\n\nResources:\n==> v1/ConfigMap\nNAME      DATA      AGE\ncm1       1         6m\n\nkubectl get configmap --namespace default\nNAME           DATA      AGE\ncm1            1         6m\ncm2            1         4m\n```\n", "closed_by": {"login": "bacongobbler", "id": 1360539, "node_id": "MDQ6VXNlcjEzNjA1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1360539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bacongobbler", "html_url": "https://github.com/bacongobbler", "followers_url": "https://api.github.com/users/bacongobbler/followers", "following_url": "https://api.github.com/users/bacongobbler/following{/other_user}", "gists_url": "https://api.github.com/users/bacongobbler/gists{/gist_id}", "starred_url": "https://api.github.com/users/bacongobbler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bacongobbler/subscriptions", "organizations_url": "https://api.github.com/users/bacongobbler/orgs", "repos_url": "https://api.github.com/users/bacongobbler/repos", "events_url": "https://api.github.com/users/bacongobbler/events{/privacy}", "received_events_url": "https://api.github.com/users/bacongobbler/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/1193/reactions", "total_count": 124, "+1": 82, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 41, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/1193/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/6374", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/6374/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/6374/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/6374/events", "html_url": "https://github.com/helm/helm/issues/6374", "id": 490353658, "node_id": "MDU6SXNzdWU0OTAzNTM2NTg=", "number": 6374, "title": "Helm init fails on Kubernetes 1.16.0", "user": {"login": "jckasper", "id": 6579310, "node_id": "MDQ6VXNlcjY1NzkzMTA=", "avatar_url": "https://avatars.githubusercontent.com/u/6579310?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jckasper", "html_url": "https://github.com/jckasper", "followers_url": "https://api.github.com/users/jckasper/followers", "following_url": "https://api.github.com/users/jckasper/following{/other_user}", "gists_url": "https://api.github.com/users/jckasper/gists{/gist_id}", "starred_url": "https://api.github.com/users/jckasper/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jckasper/subscriptions", "organizations_url": "https://api.github.com/users/jckasper/orgs", "repos_url": "https://api.github.com/users/jckasper/repos", "events_url": "https://api.github.com/users/jckasper/events{/privacy}", "received_events_url": "https://api.github.com/users/jckasper/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/helm/helm/milestones/67", "html_url": "https://github.com/helm/helm/milestone/67", "labels_url": "https://api.github.com/repos/helm/helm/milestones/67/labels", "id": 4322550, "node_id": "MDk6TWlsZXN0b25lNDMyMjU1MA==", "number": 67, "title": "2.15.0", "description": "", "creator": {"login": "bacongobbler", "id": 1360539, "node_id": "MDQ6VXNlcjEzNjA1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1360539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bacongobbler", "html_url": "https://github.com/bacongobbler", "followers_url": "https://api.github.com/users/bacongobbler/followers", "following_url": "https://api.github.com/users/bacongobbler/following{/other_user}", "gists_url": "https://api.github.com/users/bacongobbler/gists{/gist_id}", "starred_url": "https://api.github.com/users/bacongobbler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bacongobbler/subscriptions", "organizations_url": "https://api.github.com/users/bacongobbler/orgs", "repos_url": "https://api.github.com/users/bacongobbler/repos", "events_url": "https://api.github.com/users/bacongobbler/events{/privacy}", "received_events_url": "https://api.github.com/users/bacongobbler/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 42, "state": "closed", "created_at": "2019-05-16T22:48:54Z", "updated_at": "2019-10-18T20:05:43Z", "due_on": "2019-10-18T00:00:00Z", "closed_at": "2019-10-18T20:05:43Z"}, "comments": 83, "created_at": "2019-09-06T14:19:06Z", "updated_at": "2020-07-30T19:17:52Z", "closed_at": "2019-10-01T19:10:51Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Output of `helm version`: v2.14.3\r\nOutput of `kubectl version`:  client:  v1.15.3,   server: v1.16.0-rc.1\r\nCloud Provider/Platform (AKS, GKE, Minikube etc.):  IBM Cloud Kubernetes Service \r\n\r\n```\r\n$ helm init --service-account tiller\r\n$HELM_HOME has been configured at /Users/xxxx/.helm.\r\nError: error installing: the server could not find the requested resource\r\n\r\n$ helm init --debug --service-account tiller\r\n---\r\napiVersion: extensions/v1beta1\r\nkind: Deployment\r\nmetadata:\r\n  creationTimestamp: null\r\n  labels:\r\n    app: helm\r\n    name: tiller\r\n  name: tiller-deploy\r\n  namespace: kube-system\r\nspec:\r\n. \r\n.\r\n.\r\n```\r\n\r\nLooks like helm is trying to create `tiller` Deployment with: `apiVersion: extensions/v1beta1`\r\nAccording to:   https://kubernetes.io/blog/2019/07/18/api-deprecations-in-1-16 \r\nthat is no longer supported.", "closed_by": {"login": "bacongobbler", "id": 1360539, "node_id": "MDQ6VXNlcjEzNjA1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1360539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bacongobbler", "html_url": "https://github.com/bacongobbler", "followers_url": "https://api.github.com/users/bacongobbler/followers", "following_url": "https://api.github.com/users/bacongobbler/following{/other_user}", "gists_url": "https://api.github.com/users/bacongobbler/gists{/gist_id}", "starred_url": "https://api.github.com/users/bacongobbler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bacongobbler/subscriptions", "organizations_url": "https://api.github.com/users/bacongobbler/orgs", "repos_url": "https://api.github.com/users/bacongobbler/repos", "events_url": "https://api.github.com/users/bacongobbler/events{/privacy}", "received_events_url": "https://api.github.com/users/bacongobbler/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/6374/reactions", "total_count": 64, "+1": 61, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 3}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/6374/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/5915", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/5915/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/5915/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/5915/events", "html_url": "https://github.com/helm/helm/issues/5915", "id": 458125468, "node_id": "MDU6SXNzdWU0NTgxMjU0Njg=", "number": 5915, "title": "Helm not updating Kubernetes objects properly", "user": {"login": "thomastaylor312", "id": 4294228, "node_id": "MDQ6VXNlcjQyOTQyMjg=", "avatar_url": "https://avatars.githubusercontent.com/u/4294228?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomastaylor312", "html_url": "https://github.com/thomastaylor312", "followers_url": "https://api.github.com/users/thomastaylor312/followers", "following_url": "https://api.github.com/users/thomastaylor312/following{/other_user}", "gists_url": "https://api.github.com/users/thomastaylor312/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomastaylor312/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomastaylor312/subscriptions", "organizations_url": "https://api.github.com/users/thomastaylor312/orgs", "repos_url": "https://api.github.com/users/thomastaylor312/repos", "events_url": "https://api.github.com/users/thomastaylor312/events{/privacy}", "received_events_url": "https://api.github.com/users/thomastaylor312/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [{"login": "thomastaylor312", "id": 4294228, "node_id": "MDQ6VXNlcjQyOTQyMjg=", "avatar_url": "https://avatars.githubusercontent.com/u/4294228?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomastaylor312", "html_url": "https://github.com/thomastaylor312", "followers_url": "https://api.github.com/users/thomastaylor312/followers", "following_url": "https://api.github.com/users/thomastaylor312/following{/other_user}", "gists_url": "https://api.github.com/users/thomastaylor312/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomastaylor312/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomastaylor312/subscriptions", "organizations_url": "https://api.github.com/users/thomastaylor312/orgs", "repos_url": "https://api.github.com/users/thomastaylor312/repos", "events_url": "https://api.github.com/users/thomastaylor312/events{/privacy}", "received_events_url": "https://api.github.com/users/thomastaylor312/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 78, "created_at": "2019-06-19T17:05:04Z", "updated_at": "2025-04-08T14:17:26Z", "closed_at": "2021-08-05T00:07:05Z", "assignee": {"login": "thomastaylor312", "id": 4294228, "node_id": "MDQ6VXNlcjQyOTQyMjg=", "avatar_url": "https://avatars.githubusercontent.com/u/4294228?v=4", "gravatar_id": "", "url": "https://api.github.com/users/thomastaylor312", "html_url": "https://github.com/thomastaylor312", "followers_url": "https://api.github.com/users/thomastaylor312/followers", "following_url": "https://api.github.com/users/thomastaylor312/following{/other_user}", "gists_url": "https://api.github.com/users/thomastaylor312/gists{/gist_id}", "starred_url": "https://api.github.com/users/thomastaylor312/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/thomastaylor312/subscriptions", "organizations_url": "https://api.github.com/users/thomastaylor312/orgs", "repos_url": "https://api.github.com/users/thomastaylor312/repos", "events_url": "https://api.github.com/users/thomastaylor312/events{/privacy}", "received_events_url": "https://api.github.com/users/thomastaylor312/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Many users are still reporting issues with manifests being updated with a new value, but then those changes do not get applied to the actual Kubernetes objects. A common theme seems to be when you change a value from A to B and then B to A, things do not update correctly. However, there seem to be varied circumstances for when this happens and it has been hard to duplicate consistently for the core maintainers\r\n\r\nThis issue is meant to consolidate is #1844 and #3933.\r\n", "closed_by": {"login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/5915/reactions", "total_count": 51, "+1": 46, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 5}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/5915/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/8608", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/8608/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/8608/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/8608/events", "html_url": "https://github.com/helm/helm/pull/8608", "id": 681243993, "node_id": "MDExOlB1bGxSZXF1ZXN0NDY5NjY0NDQ3", "number": 8608, "title": "Reduce linting severity for users of out-of-date kubernetes", "user": {"login": "joejulian", "id": 952828, "node_id": "MDQ6VXNlcjk1MjgyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/952828?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joejulian", "html_url": "https://github.com/joejulian", "followers_url": "https://api.github.com/users/joejulian/followers", "following_url": "https://api.github.com/users/joejulian/following{/other_user}", "gists_url": "https://api.github.com/users/joejulian/gists{/gist_id}", "starred_url": "https://api.github.com/users/joejulian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joejulian/subscriptions", "organizations_url": "https://api.github.com/users/joejulian/orgs", "repos_url": "https://api.github.com/users/joejulian/repos", "events_url": "https://api.github.com/users/joejulian/events{/privacy}", "received_events_url": "https://api.github.com/users/joejulian/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 676353308, "node_id": "MDU6TGFiZWw2NzYzNTMzMDg=", "url": "https://api.github.com/repos/helm/helm/labels/size/L", "name": "size/L", "color": "ee9900", "default": false, "description": "Denotes a PR that changes 100-499 lines, ignoring generated files."}, {"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/helm/helm/milestones/104", "html_url": "https://github.com/helm/helm/milestone/104", "labels_url": "https://api.github.com/repos/helm/helm/milestones/104/labels", "id": 5999030, "node_id": "MDk6TWlsZXN0b25lNTk5OTAzMA==", "number": 104, "title": "3.5.0", "description": "", "creator": {"login": "mattfarina", "id": 62991, "node_id": "MDQ6VXNlcjYyOTkx", "avatar_url": "https://avatars.githubusercontent.com/u/62991?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattfarina", "html_url": "https://github.com/mattfarina", "followers_url": "https://api.github.com/users/mattfarina/followers", "following_url": "https://api.github.com/users/mattfarina/following{/other_user}", "gists_url": "https://api.github.com/users/mattfarina/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattfarina/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattfarina/subscriptions", "organizations_url": "https://api.github.com/users/mattfarina/orgs", "repos_url": "https://api.github.com/users/mattfarina/repos", "events_url": "https://api.github.com/users/mattfarina/events{/privacy}", "received_events_url": "https://api.github.com/users/mattfarina/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 24, "state": "closed", "created_at": "2020-10-16T14:08:08Z", "updated_at": "2021-01-13T19:17:23Z", "due_on": "2021-01-13T00:00:00Z", "closed_at": "2021-01-13T19:17:23Z"}, "comments": 38, "created_at": "2020-08-18T18:26:12Z", "updated_at": "2021-01-05T23:37:32Z", "closed_at": "2021-01-05T23:05:34Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/helm/helm/pulls/8608", "html_url": "https://github.com/helm/helm/pull/8608", "diff_url": "https://github.com/helm/helm/pull/8608.diff", "patch_url": "https://github.com/helm/helm/pull/8608.patch", "merged_at": "2021-01-05T23:05:33Z"}, "body": "**What this PR does / why we need it**:\r\nReduce linting severity for users of out-of-date kubernetes, closes #8596\r\n\r\n**Special notes for your reviewer**:\r\n\r\n**If applicable**:\r\n- [ ] this PR contains documentation\r\n- [x] this PR contains unit tests\r\n- [ ] this PR has been tested for backwards compatibility\r\n", "closed_by": {"login": "technosophos", "id": 89193, "node_id": "MDQ6VXNlcjg5MTkz", "avatar_url": "https://avatars.githubusercontent.com/u/89193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/technosophos", "html_url": "https://github.com/technosophos", "followers_url": "https://api.github.com/users/technosophos/followers", "following_url": "https://api.github.com/users/technosophos/following{/other_user}", "gists_url": "https://api.github.com/users/technosophos/gists{/gist_id}", "starred_url": "https://api.github.com/users/technosophos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/technosophos/subscriptions", "organizations_url": "https://api.github.com/users/technosophos/orgs", "repos_url": "https://api.github.com/users/technosophos/repos", "events_url": "https://api.github.com/users/technosophos/events{/privacy}", "received_events_url": "https://api.github.com/users/technosophos/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/8608/reactions", "total_count": 10, "+1": 10, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/8608/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/helm/helm/issues/3275", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/3275/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/3275/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/3275/events", "html_url": "https://github.com/helm/helm/issues/3275", "id": 283192500, "node_id": "MDU6SXNzdWUyODMxOTI1MDA=", "number": 3275, "title": "Error: UPGRADE FAILED: no resource with the name \"anything_goes\" found", "user": {"login": "zuzzas", "id": 950313, "node_id": "MDQ6VXNlcjk1MDMxMw==", "avatar_url": "https://avatars.githubusercontent.com/u/950313?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zuzzas", "html_url": "https://github.com/zuzzas", "followers_url": "https://api.github.com/users/zuzzas/followers", "following_url": "https://api.github.com/users/zuzzas/following{/other_user}", "gists_url": "https://api.github.com/users/zuzzas/gists{/gist_id}", "starred_url": "https://api.github.com/users/zuzzas/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zuzzas/subscriptions", "organizations_url": "https://api.github.com/users/zuzzas/orgs", "repos_url": "https://api.github.com/users/zuzzas/repos", "events_url": "https://api.github.com/users/zuzzas/events{/privacy}", "received_events_url": "https://api.github.com/users/zuzzas/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 72, "created_at": "2017-12-19T11:18:49Z", "updated_at": "2020-08-26T19:59:15Z", "closed_at": "2018-06-14T19:56:25Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Hi,\r\n\r\nWe are constantly hitting a problem that manifests itself with this `Error: UPGRADE FAILED: no resource with the name \"site-ssl\" found`, for example. They can appear after any innocuous update to a template.\r\nCould you, please, help me with understanding the problem. What causes those messages to appear?\r\n\r\nI've been unsuccessful in triaging the issue further, it may happen anytime, haven't really found a pattern yet.\r\n\r\nPerhaps, there is a problem with how we deploy? `helm upgrade hmmmmm /tmp/dapp-helm-chart-20171219-20899-1ppm74grrwrerq --set global.namespace=hmm --set global.env=test --set global.erlang_cookie=ODEzMTBlZjc5ZGY5NzQwYTM3ZDkwMzEx --set global.tests=no --set global.selenium_tests=no --namespace hmm --install --timeout 300`\r\n\r\nHelm: v2.7.2, v2.6.2, Kubernetes: v1.7.6, v1.8.5. I've tried every possible combination of these 4 versions, neither work.", "closed_by": {"login": "bacongobbler", "id": 1360539, "node_id": "MDQ6VXNlcjEzNjA1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1360539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bacongobbler", "html_url": "https://github.com/bacongobbler", "followers_url": "https://api.github.com/users/bacongobbler/followers", "following_url": "https://api.github.com/users/bacongobbler/following{/other_user}", "gists_url": "https://api.github.com/users/bacongobbler/gists{/gist_id}", "starred_url": "https://api.github.com/users/bacongobbler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bacongobbler/subscriptions", "organizations_url": "https://api.github.com/users/bacongobbler/orgs", "repos_url": "https://api.github.com/users/bacongobbler/repos", "events_url": "https://api.github.com/users/bacongobbler/events{/privacy}", "received_events_url": "https://api.github.com/users/bacongobbler/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/3275/reactions", "total_count": 106, "+1": 88, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 18, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/3275/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/7956", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/7956/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/7956/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/7956/events", "html_url": "https://github.com/helm/helm/issues/7956", "id": 603453778, "node_id": "MDU6SXNzdWU2MDM0NTM3Nzg=", "number": 7956, "title": "helm upgrade fails with spec.clusterIP: Invalid value: \"\": field is immutable", "user": {"login": "forainychen", "id": 1924231, "node_id": "MDQ6VXNlcjE5MjQyMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1924231?v=4", "gravatar_id": "", "url": "https://api.github.com/users/forainychen", "html_url": "https://github.com/forainychen", "followers_url": "https://api.github.com/users/forainychen/followers", "following_url": "https://api.github.com/users/forainychen/following{/other_user}", "gists_url": "https://api.github.com/users/forainychen/gists{/gist_id}", "starred_url": "https://api.github.com/users/forainychen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/forainychen/subscriptions", "organizations_url": "https://api.github.com/users/forainychen/orgs", "repos_url": "https://api.github.com/users/forainychen/repos", "events_url": "https://api.github.com/users/forainychen/events{/privacy}", "received_events_url": "https://api.github.com/users/forainychen/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 70, "created_at": "2020-04-20T18:47:01Z", "updated_at": "2021-09-29T11:01:31Z", "closed_at": "2021-06-03T19:53:29Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "When issue helm upgrade, it shows errors like, (\"my-service\" change from \"clusterIP: None\" to \"type: LoadBalancer\" without field clusterIP)\r\n\r\n```\r\nError: UPGRADE FAILED: Service \"my-service\" is invalid: spec.clusterIP: Invalid value: \"\": field is immutable \r\n```\r\n\r\nHowever, all other pods with new version are still going to be restarted, except that \"my-service\" Type does not change to new type \"LoadBalancer\"\r\n\r\nI understand that why upgrade failed because helm does not support changing on some certain fields. But why helm still upgrades other services/pods by restarting it. Should helm does nothing if there is any error during the upgrade? I excepted helm to treat the whole set of services as a package to either upgrade all or none, but seems my expectation might be wrong.\r\n\r\nAnd if we ever end up in such situation, then what we should to get out the situation? like how to upgrade \"my-service\" to have new type?\r\n\r\nAnd if I use --dry-run option, helm does not show any errors.\r\n\r\nIs this consider a bug or expected, i.e. upgrade throws some error but some service still gets upgraded.\r\n\r\n<!-- If you need help or think you have found a bug, please help us with your issue by entering the following information (otherwise you can delete this text): -->\r\n\r\nOutput of `helm version`:\r\n```\r\nClient: &version.Version{SemVer:\"v2.12.3\", GitCommit:\"eecf22f77df5f65c823aacd2dbd30ae6c65f186e\", GitTreeState:\"clean\"}\r\nServer: &version.Version{SemVer:\"v2.14.3\", GitCommit:\"0e7f3b6637f7af8fcfddb3d2941fcc7cbebb0085\", GitTreeState:\"clean\"}\r\n```\r\n\r\nOutput of `kubectl version`:\r\n```\r\nClient Version: version.Info{Major:\"1\", Minor:\"16\", GitVersion:\"v1.16.0\", GitCommit:\"2bd9643cee5b3b3a5ecbd3af49d09018f0773c77\", GitTreeState:\"clean\", BuildDate:\"2019-09-18T14:36:53Z\", GoVersion:\"go1.12.9\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"14+\", GitVersion:\"v1.14.10-gke.27\", GitCommit:\"145f9e21a4515947d6fb10819e5a336aff1b6959\", GitTreeState:\"clean\", BuildDate:\"2020-02-21T18:01:40Z\", GoVersion:\"go1.12.12b4\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n```\r\n\r\nCloud Provider/Platform (AKS, GKE, Minikube etc.): \r\nGKE and Minkube\r\n\r\n", "closed_by": {"login": "bacongobbler", "id": 1360539, "node_id": "MDQ6VXNlcjEzNjA1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1360539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bacongobbler", "html_url": "https://github.com/bacongobbler", "followers_url": "https://api.github.com/users/bacongobbler/followers", "following_url": "https://api.github.com/users/bacongobbler/following{/other_user}", "gists_url": "https://api.github.com/users/bacongobbler/gists{/gist_id}", "starred_url": "https://api.github.com/users/bacongobbler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bacongobbler/subscriptions", "organizations_url": "https://api.github.com/users/bacongobbler/orgs", "repos_url": "https://api.github.com/users/bacongobbler/repos", "events_url": "https://api.github.com/users/bacongobbler/events{/privacy}", "received_events_url": "https://api.github.com/users/bacongobbler/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/7956/reactions", "total_count": 97, "+1": 97, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/7956/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/12879", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/12879/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/12879/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/12879/events", "html_url": "https://github.com/helm/helm/pull/12879", "id": 2185336980, "node_id": "PR_kwDOApspmc5pk9X1", "number": 12879, "title": "bugfix: Override subcharts with null values", "user": {"login": "ryanhockstad", "id": 77936199, "node_id": "MDQ6VXNlcjc3OTM2MTk5", "avatar_url": "https://avatars.githubusercontent.com/u/77936199?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ryanhockstad", "html_url": "https://github.com/ryanhockstad", "followers_url": "https://api.github.com/users/ryanhockstad/followers", "following_url": "https://api.github.com/users/ryanhockstad/following{/other_user}", "gists_url": "https://api.github.com/users/ryanhockstad/gists{/gist_id}", "starred_url": "https://api.github.com/users/ryanhockstad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ryanhockstad/subscriptions", "organizations_url": "https://api.github.com/users/ryanhockstad/orgs", "repos_url": "https://api.github.com/users/ryanhockstad/repos", "events_url": "https://api.github.com/users/ryanhockstad/events{/privacy}", "received_events_url": "https://api.github.com/users/ryanhockstad/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 678047234, "node_id": "MDU6TGFiZWw2NzgwNDcyMzQ=", "url": "https://api.github.com/repos/helm/helm/labels/size/M", "name": "size/M", "color": "eebb00", "default": false, "description": "Denotes a PR that changes 30-99 lines, ignoring generated files."}, {"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/helm/helm/milestones/150", "html_url": "https://github.com/helm/helm/milestone/150", "labels_url": "https://api.github.com/repos/helm/helm/milestones/150/labels", "id": 11851554, "node_id": "MI_kwDOApspmc4AtNci", "number": 150, "title": "4.0.0", "description": "Per the release schedule policy (https://helm.sh/docs/topics/release_policy/#major-releases), once the first beta version is available, the final 4.0.0 release date will be chosen and announced.", "creator": {"login": "mattfarina", "id": 62991, "node_id": "MDQ6VXNlcjYyOTkx", "avatar_url": "https://avatars.githubusercontent.com/u/62991?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattfarina", "html_url": "https://github.com/mattfarina", "followers_url": "https://api.github.com/users/mattfarina/followers", "following_url": "https://api.github.com/users/mattfarina/following{/other_user}", "gists_url": "https://api.github.com/users/mattfarina/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattfarina/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattfarina/subscriptions", "organizations_url": "https://api.github.com/users/mattfarina/orgs", "repos_url": "https://api.github.com/users/mattfarina/repos", "events_url": "https://api.github.com/users/mattfarina/events{/privacy}", "received_events_url": "https://api.github.com/users/mattfarina/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 210, "state": "closed", "created_at": "2024-11-05T21:55:27Z", "updated_at": "2025-11-24T20:53:48Z", "due_on": "2025-11-12T00:00:00Z", "closed_at": "2025-11-14T07:43:46Z"}, "comments": 65, "created_at": "2024-03-14T03:48:56Z", "updated_at": "2025-01-27T19:35:55Z", "closed_at": "2025-01-23T20:00:42Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/helm/helm/pulls/12879", "html_url": "https://github.com/helm/helm/pull/12879", "diff_url": "https://github.com/helm/helm/pull/12879.diff", "patch_url": "https://github.com/helm/helm/pull/12879.patch", "merged_at": "2025-01-23T20:00:42Z"}, "body": "This PR closes #12469  and closes #12488\r\n\r\nHelm should allow users to not only override default values, but also completely remove any default values by setting a config to `null`. \r\n\r\nThis works fine for regular charts, but default values within sub-charts cannot be `null`-ed.  The linked issue has a good example of this created by user \"naemono.\" \r\n\r\nThe reason this issue is happening is because the `coalesce` function goes over sub-chart values that are defined in a values file or with a `--set` flag twice due to the logic [here](https://github.com/helm/helm/blob/d37e2e9097f9715d4d184b2e3cc313588f106030/pkg/chartutil/coalesce.go#L100-L101).  `merge` is always set to `false` in this context, and the first time `coalesce` gets called, the null value gets removed during the `coalesceTablesFullKey` function [here.](https://github.com/helm/helm/blob/d37e2e9097f9715d4d184b2e3cc313588f106030/pkg/chartutil/coalesce.go#L279) This is fine for regular chart values, but for sub-chart values, the `coalesceDeps` function runs the logic again for every value in the subChart, so we end right back to the spot in the previous link.  But the config option that was explicitly set to null was already removed, so we end up at [this point](https://github.com/helm/helm/blob/d37e2e9097f9715d4d184b2e3cc313588f106030/pkg/chartutil/coalesce.go#L281) two lines down, which overwrites the user defined `null` config the sub-chart default value.\r\n\r\nThis problem only occurs because when the `coalesce` function is run while `merge` is `false`.  \r\n\r\nTo prevent this bug from removing sub-chart config values that are explicitly set to `null` and therefore getting overwritten when `coalesceDeps` runs through the sub-chart values a second time, I added logic to check if the key was the name of a sub-chart, and if so setting `merge` to `false` so the null config option is not deleted.\r\n\u00a0\r\n\r\n\r\n**Special notes for your reviewer**:\r\nFollow-up if this PR is accepted may be to add a unit-test to confirm sub-chart nulls aren't overwritten.\r\n", "closed_by": {"login": "scottrigby", "id": 407675, "node_id": "MDQ6VXNlcjQwNzY3NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/407675?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scottrigby", "html_url": "https://github.com/scottrigby", "followers_url": "https://api.github.com/users/scottrigby/followers", "following_url": "https://api.github.com/users/scottrigby/following{/other_user}", "gists_url": "https://api.github.com/users/scottrigby/gists{/gist_id}", "starred_url": "https://api.github.com/users/scottrigby/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scottrigby/subscriptions", "organizations_url": "https://api.github.com/users/scottrigby/orgs", "repos_url": "https://api.github.com/users/scottrigby/repos", "events_url": "https://api.github.com/users/scottrigby/events{/privacy}", "received_events_url": "https://api.github.com/users/scottrigby/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/12879/reactions", "total_count": 119, "+1": 119, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/12879/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/helm/helm/issues/11440", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/11440/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/11440/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/11440/events", "html_url": "https://github.com/helm/helm/pull/11440", "id": 1409106245, "node_id": "PR_kwDOApspmc5AzeAt", "number": 11440, "title": "Fix null key removal in nested subcharts", "user": {"login": "jamoflaw", "id": 8770905, "node_id": "MDQ6VXNlcjg3NzA5MDU=", "avatar_url": "https://avatars.githubusercontent.com/u/8770905?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamoflaw", "html_url": "https://github.com/jamoflaw", "followers_url": "https://api.github.com/users/jamoflaw/followers", "following_url": "https://api.github.com/users/jamoflaw/following{/other_user}", "gists_url": "https://api.github.com/users/jamoflaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamoflaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamoflaw/subscriptions", "organizations_url": "https://api.github.com/users/jamoflaw/orgs", "repos_url": "https://api.github.com/users/jamoflaw/repos", "events_url": "https://api.github.com/users/jamoflaw/events{/privacy}", "received_events_url": "https://api.github.com/users/jamoflaw/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 676353308, "node_id": "MDU6TGFiZWw2NzYzNTMzMDg=", "url": "https://api.github.com/repos/helm/helm/labels/size/L", "name": "size/L", "color": "ee9900", "default": false, "description": "Denotes a PR that changes 100-499 lines, ignoring generated files."}, {"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/helm/helm/milestones/131", "html_url": "https://github.com/helm/helm/milestone/131", "labels_url": "https://api.github.com/repos/helm/helm/milestones/131/labels", "id": 9353230, "node_id": "MI_kwDOApspmc4AjrgO", "number": 131, "title": "3.13.0", "description": "", "creator": {"login": "mattfarina", "id": 62991, "node_id": "MDQ6VXNlcjYyOTkx", "avatar_url": "https://avatars.githubusercontent.com/u/62991?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattfarina", "html_url": "https://github.com/mattfarina", "followers_url": "https://api.github.com/users/mattfarina/followers", "following_url": "https://api.github.com/users/mattfarina/following{/other_user}", "gists_url": "https://api.github.com/users/mattfarina/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattfarina/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattfarina/subscriptions", "organizations_url": "https://api.github.com/users/mattfarina/orgs", "repos_url": "https://api.github.com/users/mattfarina/repos", "events_url": "https://api.github.com/users/mattfarina/events{/privacy}", "received_events_url": "https://api.github.com/users/mattfarina/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 57, "state": "closed", "created_at": "2023-05-02T16:53:33Z", "updated_at": "2023-10-09T16:36:26Z", "due_on": "2023-09-27T00:00:00Z", "closed_at": "2023-10-09T16:36:26Z"}, "comments": 47, "created_at": "2022-10-14T10:08:57Z", "updated_at": "2023-08-08T14:39:32Z", "closed_at": "2023-08-01T00:03:45Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/helm/helm/pulls/11440", "html_url": "https://github.com/helm/helm/pull/11440", "diff_url": "https://github.com/helm/helm/pull/11440.diff", "patch_url": "https://github.com/helm/helm/pull/11440.patch", "merged_at": null}, "body": "closes #9136\r\ncloses #9027\r\n\r\nThis PR contains two commits, the first replicates the behaviour described in #9136 and the second resolves it.\r\n\r\nThe original unit-tests did have a case for the subchart values and it was passing, so I spent some time trying to work out why there is a difference between the behaviour of the unit-tests and real world usage. It seems that the bug is related to the way the chart object is mutated by chartutil.ProcessDependencies. During that call the chart objects values are merged with its subcharts leading to a situation where all values are merged together into the parent chart's values.\r\n\r\nTo replicate this behaviour in the unit tests I just added the following to the parent charts definition:\r\n\r\n```\r\n\t\t\t\"pequod\":   map[string]interface{}{\r\n\t\t\t\t\"ahab\":     map[string]interface{}{\r\n\t\t\t\t\t\"scope\": \"ahab\",\r\n\t\t\t\t\t\"nested\": map[string]interface{}{\r\n\t\t\t\t\t\t\"foo\": true,\r\n\t\t\t\t\t\t\"bar\": true,\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n```\r\n\r\nSince `bar` is now defined in that parent chart object, when the call to `coalesceValues(printf, ch, dest, prefix)` was made, the dest object was mutated and null keys were removed from both the parent chart _and_ subchart values. The subsequent call to `coalesceDeps(printf, ch, dest, prefix)` then has no more null keys anymore so the subcharts no longer have any keys removed, which causes the subcharts values to be merged _back_ into the parent chart (undo-ing the null removal from the previous call to coalesceValues).\r\n\r\nThe changes made effectively delay the removal of the null keys until after both the `coalesceValues` and `coalesceDeps` calls are completed.\r\n\r\n- [ ] this PR contains documentation\r\n- [x] this PR contains unit tests\r\n- [ ] this PR has been tested for backwards compatibility\r\n", "closed_by": {"login": "joejulian", "id": 952828, "node_id": "MDQ6VXNlcjk1MjgyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/952828?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joejulian", "html_url": "https://github.com/joejulian", "followers_url": "https://api.github.com/users/joejulian/followers", "following_url": "https://api.github.com/users/joejulian/following{/other_user}", "gists_url": "https://api.github.com/users/joejulian/gists{/gist_id}", "starred_url": "https://api.github.com/users/joejulian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joejulian/subscriptions", "organizations_url": "https://api.github.com/users/joejulian/orgs", "repos_url": "https://api.github.com/users/joejulian/repos", "events_url": "https://api.github.com/users/joejulian/events{/privacy}", "received_events_url": "https://api.github.com/users/joejulian/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/11440/reactions", "total_count": 50, "+1": 25, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 25, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/11440/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/helm/helm/issues/4558", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/4558/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/4558/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/4558/events", "html_url": "https://github.com/helm/helm/issues/4558", "id": 355234373, "node_id": "MDU6SXNzdWUzNTUyMzQzNzM=", "number": 4558, "title": "helm upgrade > timeout on pre-upgrade hook > revision stuck in `PENDING_UPGRADE` and multiple `DEPLOYED` revisions arise soon", "user": {"login": "consideRatio", "id": 3837114, "node_id": "MDQ6VXNlcjM4MzcxMTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/3837114?v=4", "gravatar_id": "", "url": "https://api.github.com/users/consideRatio", "html_url": "https://github.com/consideRatio", "followers_url": "https://api.github.com/users/consideRatio/followers", "following_url": "https://api.github.com/users/consideRatio/following{/other_user}", "gists_url": "https://api.github.com/users/consideRatio/gists{/gist_id}", "starred_url": "https://api.github.com/users/consideRatio/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/consideRatio/subscriptions", "organizations_url": "https://api.github.com/users/consideRatio/orgs", "repos_url": "https://api.github.com/users/consideRatio/repos", "events_url": "https://api.github.com/users/consideRatio/events{/privacy}", "received_events_url": "https://api.github.com/users/consideRatio/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 269212354, "node_id": "MDU6TGFiZWwyNjkyMTIzNTQ=", "url": "https://api.github.com/repos/helm/helm/labels/help%20wanted", "name": "help wanted", "color": "006b75", "default": true, "description": "Denotes an issue that needs help from a contributor. Must meet \"help wanted\" guidelines."}, {"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}, {"id": 2290444626, "node_id": "MDU6TGFiZWwyMjkwNDQ0NjI2", "url": "https://api.github.com/repos/helm/helm/labels/Stale", "name": "Stale", "color": "ededed", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 65, "created_at": "2018-08-29T16:15:19Z", "updated_at": "2025-06-19T13:02:57Z", "closed_at": "2024-01-14T00:15:20Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "## Reproduction and symptom\r\n1. `helm upgrade` with a helm pre-upgrade hook that times out.\r\n2. `Error: UPGRADE FAILED: timed out waiting for the condition`.\r\n3. `helm history my-release-name`\r\n   ```bash\r\n   # the last line...\r\n   22      \tWed Aug 29 17:59:48 2018\tPENDING_UPGRADE\tjupyterhub-0.7-04ccf1a \tPreparing upgrade\r\n   ```\r\n\r\n## Expected outcome\r\nThe revision should end up in `FAILED` rather than `PENDING_UPGRADE` right?", "closed_by": {"login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/4558/reactions", "total_count": 73, "+1": 73, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/4558/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/6361", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/6361/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/6361/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/6361/events", "html_url": "https://github.com/helm/helm/issues/6361", "id": 489873920, "node_id": "MDU6SXNzdWU0ODk4NzM5MjA=", "number": 6361, "title": "unable to retrieve the complete list of server APIs", "user": {"login": "planetf1", "id": 7292002, "node_id": "MDQ6VXNlcjcyOTIwMDI=", "avatar_url": "https://avatars.githubusercontent.com/u/7292002?v=4", "gravatar_id": "", "url": "https://api.github.com/users/planetf1", "html_url": "https://github.com/planetf1", "followers_url": "https://api.github.com/users/planetf1/followers", "following_url": "https://api.github.com/users/planetf1/following{/other_user}", "gists_url": "https://api.github.com/users/planetf1/gists{/gist_id}", "starred_url": "https://api.github.com/users/planetf1/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/planetf1/subscriptions", "organizations_url": "https://api.github.com/users/planetf1/orgs", "repos_url": "https://api.github.com/users/planetf1/repos", "events_url": "https://api.github.com/users/planetf1/events{/privacy}", "received_events_url": "https://api.github.com/users/planetf1/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}, {"id": 926755770, "node_id": "MDU6TGFiZWw5MjY3NTU3NzA=", "url": "https://api.github.com/repos/helm/helm/labels/v3.x", "name": "v3.x", "color": "e82969", "default": false, "description": "Issues and Pull Requests related to the major version v3"}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/helm/helm/milestones/81", "html_url": "https://github.com/helm/helm/milestone/81", "labels_url": "https://api.github.com/repos/helm/helm/milestones/81/labels", "id": 4911686, "node_id": "MDk6TWlsZXN0b25lNDkxMTY4Ng==", "number": 81, "title": "3.0.2", "description": "", "creator": {"login": "mattfarina", "id": 62991, "node_id": "MDQ6VXNlcjYyOTkx", "avatar_url": "https://avatars.githubusercontent.com/u/62991?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattfarina", "html_url": "https://github.com/mattfarina", "followers_url": "https://api.github.com/users/mattfarina/followers", "following_url": "https://api.github.com/users/mattfarina/following{/other_user}", "gists_url": "https://api.github.com/users/mattfarina/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattfarina/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattfarina/subscriptions", "organizations_url": "https://api.github.com/users/mattfarina/orgs", "repos_url": "https://api.github.com/users/mattfarina/repos", "events_url": "https://api.github.com/users/mattfarina/events{/privacy}", "received_events_url": "https://api.github.com/users/mattfarina/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 8, "state": "closed", "created_at": "2019-12-07T19:07:46Z", "updated_at": "2019-12-17T18:55:03Z", "due_on": null, "closed_at": "2019-12-17T18:55:03Z"}, "comments": 64, "created_at": "2019-09-05T16:34:11Z", "updated_at": "2024-12-12T17:56:33Z", "closed_at": "2019-12-17T17:31:30Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "<!-- If you need help or think you have found a bug, please help us with your issue by entering the following information (otherwise you can delete this text): -->\r\n\r\nOutput of `helm version`:\r\nversion.BuildInfo{Version:\"v3.0+unreleased\", GitCommit:\"180db556aaf45f34516f8ddb9ddac28d71736a3e\", GitTreeState:\"clean\", GoVersion:\"go1.13\"}\r\n\r\nOutput of `kubectl version`:\r\nlient Version: version.Info{Major:\"1\", Minor:\"15\", GitVersion:\"v1.15.3\", GitCommit:\"2d3c76f9091b6bec110a5e63777c332469e0cba2\", GitTreeState:\"clean\", BuildDate:\"2019-08-19T12:36:28Z\", GoVersion:\"go1.12.9\", Compiler:\"gc\", Platform:\"darwin/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"15\", GitVersion:\"v1.15.3+IKS\", GitCommit:\"66a72e7aa8fd2dbf64af493f50f943d7f7067916\", GitTreeState:\"clean\", BuildDate:\"2019-08-23T08:07:38Z\", GoVersion:\"go1.12.9\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n\r\nCloud Provider/Platform (AKS, GKE, Minikube etc.): \r\nIBM Cloud \r\n\r\nHelm chart deployment fails with:\r\n```\r\n\u279c  charts git:(h2update2) helm install vdc -f ~/etc/cloud-noes.yaml vdc                                                                                                                                <<<\r\ncoalesce.go:155: warning: skipped value for image: Not a table.\r\nError: could not get apiVersions from Kubernetes: unable to retrieve the complete list of server APIs: custom.metrics.k8s.io/v1beta1: the server is currently unable to handle the request\r\n```\r\n(The first error is in a confluent chart... here I discuss the second issue)\r\n\r\nLooking at the error I see a similar problem with\r\n```\r\n\u279c  charts git:(h2update2) kubectl api-resources\r\nNAME                              SHORTNAMES      APIGROUP                           NAMESPACED   KIND\r\nbindings                                                                             true         Binding\r\ncomponentstatuses                 cs                                                 false        ComponentStatus\r\nconfigmaps                        cm                                                 true         ConfigMap\r\nendpoints                         ep                                                 true         Endpoints\r\nevents                            ev                                                 true         Event\r\nlimitranges                       limits                                             true         LimitRange\r\nnamespaces                        ns                                                 false        Namespace\r\nnodes                             no                                                 false        Node\r\npersistentvolumeclaims            pvc                                                true         PersistentVolumeClaim\r\npersistentvolumes                 pv                                                 false        PersistentVolume\r\npods                              po                                                 true         Pod\r\npodtemplates                                                                         true         PodTemplate\r\nreplicationcontrollers            rc                                                 true         ReplicationController\r\nresourcequotas                    quota                                              true         ResourceQuota\r\nsecrets                                                                              true         Secret\r\nserviceaccounts                   sa                                                 true         ServiceAccount\r\nservices                          svc                                                true         Service\r\nmutatingwebhookconfigurations                     admissionregistration.k8s.io       false        MutatingWebhookConfiguration\r\nvalidatingwebhookconfigurations                   admissionregistration.k8s.io       false        ValidatingWebhookConfiguration\r\ncustomresourcedefinitions         crd,crds        apiextensions.k8s.io               false        CustomResourceDefinition\r\napiservices                                       apiregistration.k8s.io             false        APIService\r\ncontrollerrevisions                               apps                               true         ControllerRevision\r\ndaemonsets                        ds              apps                               true         DaemonSet\r\ndeployments                       deploy          apps                               true         Deployment\r\nreplicasets                       rs              apps                               true         ReplicaSet\r\nstatefulsets                      sts             apps                               true         StatefulSet\r\nmeshpolicies                                      authentication.istio.io            false        MeshPolicy\r\npolicies                                          authentication.istio.io            true         Policy\r\ntokenreviews                                      authentication.k8s.io              false        TokenReview\r\nlocalsubjectaccessreviews                         authorization.k8s.io               true         LocalSubjectAccessReview\r\nselfsubjectaccessreviews                          authorization.k8s.io               false        SelfSubjectAccessReview\r\nselfsubjectrulesreviews                           authorization.k8s.io               false        SelfSubjectRulesReview\r\nsubjectaccessreviews                              authorization.k8s.io               false        SubjectAccessReview\r\nhorizontalpodautoscalers          hpa             autoscaling                        true         HorizontalPodAutoscaler\r\nmetrics                                           autoscaling.internal.knative.dev   true         Metric\r\npodautoscalers                    kpa,pa          autoscaling.internal.knative.dev   true         PodAutoscaler\r\ncronjobs                          cj              batch                              true         CronJob\r\njobs                                              batch                              true         Job\r\nimages                            img             caching.internal.knative.dev       true         Image\r\ncertificatesigningrequests        csr             certificates.k8s.io                false        CertificateSigningRequest\r\ncertificates                      cert,certs      certmanager.k8s.io                 true         Certificate\r\nchallenges                                        certmanager.k8s.io                 true         Challenge\r\nclusterissuers                                    certmanager.k8s.io                 false        ClusterIssuer\r\nissuers                                           certmanager.k8s.io                 true         Issuer\r\norders                                            certmanager.k8s.io                 true         Order\r\nadapters                                          config.istio.io                    true         adapter\r\nattributemanifests                                config.istio.io                    true         attributemanifest\r\nhandlers                                          config.istio.io                    true         handler\r\nhttpapispecbindings                               config.istio.io                    true         HTTPAPISpecBinding\r\nhttpapispecs                                      config.istio.io                    true         HTTPAPISpec\r\ninstances                                         config.istio.io                    true         instance\r\nquotaspecbindings                                 config.istio.io                    true         QuotaSpecBinding\r\nquotaspecs                                        config.istio.io                    true         QuotaSpec\r\nrules                                             config.istio.io                    true         rule\r\ntemplates                                         config.istio.io                    true         template\r\nleases                                            coordination.k8s.io                true         Lease\r\nbrokers                                           eventing.knative.dev               true         Broker\r\nchannels                          chan            eventing.knative.dev               true         Channel\r\nclusterchannelprovisioners        ccp             eventing.knative.dev               false        ClusterChannelProvisioner\r\neventtypes                                        eventing.knative.dev               true         EventType\r\nsubscriptions                     sub             eventing.knative.dev               true         Subscription\r\ntriggers                                          eventing.knative.dev               true         Trigger\r\nevents                            ev              events.k8s.io                      true         Event\r\ndaemonsets                        ds              extensions                         true         DaemonSet\r\ndeployments                       deploy          extensions                         true         Deployment\r\ningresses                         ing             extensions                         true         Ingress\r\nnetworkpolicies                   netpol          extensions                         true         NetworkPolicy\r\npodsecuritypolicies               psp             extensions                         false        PodSecurityPolicy\r\nreplicasets                       rs              extensions                         true         ReplicaSet\r\nchannels                          ch              messaging.knative.dev              true         Channel\r\nchoices                                           messaging.knative.dev              true         Choice\r\ninmemorychannels                  imc             messaging.knative.dev              true         InMemoryChannel\r\nsequences                                         messaging.knative.dev              true         Sequence\r\nnodes                                             metrics.k8s.io                     false        NodeMetrics\r\npods                                              metrics.k8s.io                     true         PodMetrics\r\ncertificates                      kcert           networking.internal.knative.dev    true         Certificate\r\nclusteringresses                                  networking.internal.knative.dev    false        ClusterIngress\r\ningresses                         ing             networking.internal.knative.dev    true         Ingress\r\nserverlessservices                sks             networking.internal.knative.dev    true         ServerlessService\r\ndestinationrules                  dr              networking.istio.io                true         DestinationRule\r\nenvoyfilters                                      networking.istio.io                true         EnvoyFilter\r\ngateways                          gw              networking.istio.io                true         Gateway\r\nserviceentries                    se              networking.istio.io                true         ServiceEntry\r\nsidecars                                          networking.istio.io                true         Sidecar\r\nvirtualservices                   vs              networking.istio.io                true         VirtualService\r\ningresses                         ing             networking.k8s.io                  true         Ingress\r\nnetworkpolicies                   netpol          networking.k8s.io                  true         NetworkPolicy\r\npoddisruptionbudgets              pdb             policy                             true         PodDisruptionBudget\r\npodsecuritypolicies               psp             policy                             false        PodSecurityPolicy\r\nclusterrolebindings                               rbac.authorization.k8s.io          false        ClusterRoleBinding\r\nclusterroles                                      rbac.authorization.k8s.io          false        ClusterRole\r\nrolebindings                                      rbac.authorization.k8s.io          true         RoleBinding\r\nroles                                             rbac.authorization.k8s.io          true         Role\r\nauthorizationpolicies                             rbac.istio.io                      true         AuthorizationPolicy\r\nclusterrbacconfigs                                rbac.istio.io                      false        ClusterRbacConfig\r\nrbacconfigs                                       rbac.istio.io                      true         RbacConfig\r\nservicerolebindings                               rbac.istio.io                      true         ServiceRoleBinding\r\nserviceroles                                      rbac.istio.io                      true         ServiceRole\r\npriorityclasses                   pc              scheduling.k8s.io                  false        PriorityClass\r\nconfigurations                    config,cfg      serving.knative.dev                true         Configuration\r\nrevisions                         rev             serving.knative.dev                true         Revision\r\nroutes                            rt              serving.knative.dev                true         Route\r\nservices                          kservice,ksvc   serving.knative.dev                true         Service\r\napiserversources                                  sources.eventing.knative.dev       true         ApiServerSource\r\nawssqssources                                     sources.eventing.knative.dev       true         AwsSqsSource\r\ncontainersources                                  sources.eventing.knative.dev       true         ContainerSource\r\ncronjobsources                                    sources.eventing.knative.dev       true         CronJobSource\r\ngithubsources                                     sources.eventing.knative.dev       true         GitHubSource\r\nkafkasources                                      sources.eventing.knative.dev       true         KafkaSource\r\ncsidrivers                                        storage.k8s.io                     false        CSIDriver\r\ncsinodes                                          storage.k8s.io                     false        CSINode\r\nstorageclasses                    sc              storage.k8s.io                     false        StorageClass\r\nvolumeattachments                                 storage.k8s.io                     false        VolumeAttachment\r\nclustertasks                                      tekton.dev                         false        ClusterTask\r\npipelineresources                                 tekton.dev                         true         PipelineResource\r\npipelineruns                      pr,prs          tekton.dev                         true         PipelineRun\r\npipelines                                         tekton.dev                         true         Pipeline\r\ntaskruns                          tr,trs          tekton.dev                         true         TaskRun\r\ntasks                                             tekton.dev                         true         Task\r\nerror: unable to retrieve the complete list of server APIs: custom.metrics.k8s.io/v1beta1: the server is currently unable to handle the request\r\n\u279c  charts git:(h2update2)\r\n```\r\n\r\nThen looking at 'action.go' in the source I can see that if this api call fails, we exit getCapabilities(). I understand why ... but is this failure too 'hard' - in the case above the error was a minor service?\r\n\r\nThis seems to have come up recently due to some changes on the k8s service with metrics. \r\nI will persue that seperately... but was after thoughts on how helm handles this situation\r\nAlso a heads up helm3 *may* be broken on IKS - but I'm not knowledgeable enough to dig much further?", "closed_by": {"login": "technosophos", "id": 89193, "node_id": "MDQ6VXNlcjg5MTkz", "avatar_url": "https://avatars.githubusercontent.com/u/89193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/technosophos", "html_url": "https://github.com/technosophos", "followers_url": "https://api.github.com/users/technosophos/followers", "following_url": "https://api.github.com/users/technosophos/following{/other_user}", "gists_url": "https://api.github.com/users/technosophos/gists{/gist_id}", "starred_url": "https://api.github.com/users/technosophos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/technosophos/subscriptions", "organizations_url": "https://api.github.com/users/technosophos/orgs", "repos_url": "https://api.github.com/users/technosophos/repos", "events_url": "https://api.github.com/users/technosophos/events{/privacy}", "received_events_url": "https://api.github.com/users/technosophos/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/6361/reactions", "total_count": 24, "+1": 24, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/6361/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/5750", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/5750/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/5750/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/5750/events", "html_url": "https://github.com/helm/helm/issues/5750", "id": 445171322, "node_id": "MDU6SXNzdWU0NDUxNzEzMjI=", "number": 5750, "title": "Helm install v2.14.0 \"validation failed\" error when using a template variable with value \"\"", "user": {"login": "daniv-msft", "id": 48293037, "node_id": "MDQ6VXNlcjQ4MjkzMDM3", "avatar_url": "https://avatars.githubusercontent.com/u/48293037?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daniv-msft", "html_url": "https://github.com/daniv-msft", "followers_url": "https://api.github.com/users/daniv-msft/followers", "following_url": "https://api.github.com/users/daniv-msft/following{/other_user}", "gists_url": "https://api.github.com/users/daniv-msft/gists{/gist_id}", "starred_url": "https://api.github.com/users/daniv-msft/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daniv-msft/subscriptions", "organizations_url": "https://api.github.com/users/daniv-msft/orgs", "repos_url": "https://api.github.com/users/daniv-msft/repos", "events_url": "https://api.github.com/users/daniv-msft/events{/privacy}", "received_events_url": "https://api.github.com/users/daniv-msft/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 61, "created_at": "2019-05-16T21:38:12Z", "updated_at": "2020-08-19T08:00:41Z", "closed_at": "2019-06-05T22:00:09Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Hello,\r\n\r\nAfter upgrading from v2.13.1 to v2.14.0, my chart now throws an error on helm install:\r\n\r\n**Error: validation failed: error validating \"\": error validating data: unknown object type \"nil\" in Deployment.spec.template.metadata.annotations.buildID**\r\n\r\nThis seems to be due to the use in deployment.yaml file of a template variable \"buildID\" that is actually never declared in values.yaml.\r\nExtract from deployment.yaml:\r\n```\r\ntemplate:\r\n  metadata:\r\n    labels:\r\n      app: {{ template \"gateway.name\" . }}\r\n      draft: {{ default \"draft-app\" .Values.draft }}\r\n      release: {{ .Release.Name }}\r\n    annotations:\r\n      buildID: {{ .Values.buildID }}\r\n```\r\n\r\nIf I set the buildID variable in values.yaml file to \"\", I get the same error.\r\nIf I set the buildID variable in values.yaml file to any other string, such as \"a\", then my install works.\r\nIf I set \"\" to buildID in deployment.yaml (buildID: {{ \"\" }}), I get the same error.\r\nIf I set \"\" directly to buildID in deployment.yaml (buildID: \"\"), then my install works.\r\n\r\nCould you please let me know if this is a known issue, or if I am missing anything here?\r\n\r\nThanks!\r\n\r\n------------\r\n\r\n**Output of `helm version`:**\r\nClient: &version.Version{SemVer:\"v2.14.0\", GitCommit:\"05811b84a3f93603dd6c2fcfe57944dfa7ab7fd0\", GitTreeState:\"clean\"}\r\nServer: &version.Version{SemVer:\"v2.14.0\", GitCommit:\"05811b84a3f93603dd6c2fcfe57944dfa7ab7fd0\", GitTreeState:\"clean\"}\r\n\r\n**Output of `kubectl version`:**\r\nClient Version: version.Info{Major:\"1\", Minor:\"10\", GitVersion:\"v1.10.11\", GitCommit:\"637c7e288581ee40ab4ca210618a89a555b6e7e9\", GitTreeState:\"clean\", BuildDate:\"2018-11-26T14:38:32Z\", GoVersion:\"go1.9.3\", Compiler:\"gc\", Platform:\"windows/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"12\", GitVersion:\"v1.12.7\", GitCommit:\"6f482974b76db3f1e0f5d24605a9d1d38fad9a2b\", GitTreeState:\"clean\", BuildDate:\"2019-03-25T02:41:57Z\", GoVersion:\"go1.10.8\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n\r\n**Cloud Provider/Platform:** \r\nAKS", "closed_by": {"login": "bacongobbler", "id": 1360539, "node_id": "MDQ6VXNlcjEzNjA1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1360539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bacongobbler", "html_url": "https://github.com/bacongobbler", "followers_url": "https://api.github.com/users/bacongobbler/followers", "following_url": "https://api.github.com/users/bacongobbler/following{/other_user}", "gists_url": "https://api.github.com/users/bacongobbler/gists{/gist_id}", "starred_url": "https://api.github.com/users/bacongobbler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bacongobbler/subscriptions", "organizations_url": "https://api.github.com/users/bacongobbler/orgs", "repos_url": "https://api.github.com/users/bacongobbler/repos", "events_url": "https://api.github.com/users/bacongobbler/events{/privacy}", "received_events_url": "https://api.github.com/users/bacongobbler/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/5750/reactions", "total_count": 37, "+1": 37, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/5750/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/6324", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/6324/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/6324/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/6324/events", "html_url": "https://github.com/helm/helm/issues/6324", "id": 487299150, "node_id": "MDU6SXNzdWU0ODcyOTkxNTA=", "number": 6324, "title": "How can I push chart to an insecure OCI registry with helm v3", "user": {"login": "ywk253100", "id": 5835782, "node_id": "MDQ6VXNlcjU4MzU3ODI=", "avatar_url": "https://avatars.githubusercontent.com/u/5835782?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ywk253100", "html_url": "https://github.com/ywk253100", "followers_url": "https://api.github.com/users/ywk253100/followers", "following_url": "https://api.github.com/users/ywk253100/following{/other_user}", "gists_url": "https://api.github.com/users/ywk253100/gists{/gist_id}", "starred_url": "https://api.github.com/users/ywk253100/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ywk253100/subscriptions", "organizations_url": "https://api.github.com/users/ywk253100/orgs", "repos_url": "https://api.github.com/users/ywk253100/repos", "events_url": "https://api.github.com/users/ywk253100/events{/privacy}", "received_events_url": "https://api.github.com/users/ywk253100/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 562687714, "node_id": "MDU6TGFiZWw1NjI2ODc3MTQ=", "url": "https://api.github.com/repos/helm/helm/labels/keep%20open", "name": "keep open", "color": "fbca04", "default": false, "description": null}, {"id": 562692416, "node_id": "MDU6TGFiZWw1NjI2OTI0MTY=", "url": "https://api.github.com/repos/helm/helm/labels/in%20progress", "name": "in progress", "color": "11DD11", "default": false, "description": null}, {"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}, {"id": 926755770, "node_id": "MDU6TGFiZWw5MjY3NTU3NzA=", "url": "https://api.github.com/repos/helm/helm/labels/v3.x", "name": "v3.x", "color": "e82969", "default": false, "description": "Issues and Pull Requests related to the major version v3"}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/helm/helm/milestones/135", "html_url": "https://github.com/helm/helm/milestone/135", "labels_url": "https://api.github.com/repos/helm/helm/milestones/135/labels", "id": 9938490, "node_id": "MI_kwDOApspmc4Al6Y6", "number": 135, "title": "3.14.0", "description": "", "creator": {"login": "mattfarina", "id": 62991, "node_id": "MDQ6VXNlcjYyOTkx", "avatar_url": "https://avatars.githubusercontent.com/u/62991?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mattfarina", "html_url": "https://github.com/mattfarina", "followers_url": "https://api.github.com/users/mattfarina/followers", "following_url": "https://api.github.com/users/mattfarina/following{/other_user}", "gists_url": "https://api.github.com/users/mattfarina/gists{/gist_id}", "starred_url": "https://api.github.com/users/mattfarina/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mattfarina/subscriptions", "organizations_url": "https://api.github.com/users/mattfarina/orgs", "repos_url": "https://api.github.com/users/mattfarina/repos", "events_url": "https://api.github.com/users/mattfarina/events{/privacy}", "received_events_url": "https://api.github.com/users/mattfarina/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 28, "state": "closed", "created_at": "2023-09-19T14:08:10Z", "updated_at": "2024-03-13T18:40:28Z", "due_on": "2024-01-17T00:00:00Z", "closed_at": "2024-03-13T18:40:28Z"}, "comments": 60, "created_at": "2019-08-30T05:50:44Z", "updated_at": "2025-03-06T05:40:33Z", "closed_at": "2023-11-20T22:22:09Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "How can I push chart to an insecure registry(HTTP or HTTPS with self-signed certificate) with helm v3?\r\n\r\nShould we provide an option to skip the security checking? It's useful in developing/testing environments", "closed_by": {"login": "gjenkins8", "id": 2787248, "node_id": "MDQ6VXNlcjI3ODcyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/2787248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gjenkins8", "html_url": "https://github.com/gjenkins8", "followers_url": "https://api.github.com/users/gjenkins8/followers", "following_url": "https://api.github.com/users/gjenkins8/following{/other_user}", "gists_url": "https://api.github.com/users/gjenkins8/gists{/gist_id}", "starred_url": "https://api.github.com/users/gjenkins8/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gjenkins8/subscriptions", "organizations_url": "https://api.github.com/users/gjenkins8/orgs", "repos_url": "https://api.github.com/users/gjenkins8/repos", "events_url": "https://api.github.com/users/gjenkins8/events{/privacy}", "received_events_url": "https://api.github.com/users/gjenkins8/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/6324/reactions", "total_count": 8, "+1": 8, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/6324/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/7219", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/7219/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/7219/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/7219/events", "html_url": "https://github.com/helm/helm/issues/7219", "id": 537105270, "node_id": "MDU6SXNzdWU1MzcxMDUyNzA=", "number": 7219, "title": "no matches for kind \"Deployment\" in version \"apps/v1beta1\"", "user": {"login": "curtisr7", "id": 4132174, "node_id": "MDQ6VXNlcjQxMzIxNzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4132174?v=4", "gravatar_id": "", "url": "https://api.github.com/users/curtisr7", "html_url": "https://github.com/curtisr7", "followers_url": "https://api.github.com/users/curtisr7/followers", "following_url": "https://api.github.com/users/curtisr7/following{/other_user}", "gists_url": "https://api.github.com/users/curtisr7/gists{/gist_id}", "starred_url": "https://api.github.com/users/curtisr7/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/curtisr7/subscriptions", "organizations_url": "https://api.github.com/users/curtisr7/orgs", "repos_url": "https://api.github.com/users/curtisr7/repos", "events_url": "https://api.github.com/users/curtisr7/events{/privacy}", "received_events_url": "https://api.github.com/users/curtisr7/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}, {"id": 2290444626, "node_id": "MDU6TGFiZWwyMjkwNDQ0NjI2", "url": "https://api.github.com/repos/helm/helm/labels/Stale", "name": "Stale", "color": "ededed", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 58, "created_at": "2019-12-12T17:06:44Z", "updated_at": "2023-07-21T11:30:28Z", "closed_at": "2020-10-14T21:42:34Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Output of `helm version`:\r\n```\r\n$ helm version\r\nClient: &version.Version{SemVer:\"v2.12.1\", GitCommit:\"02a47c7249b1fc6d8fd3b94e6b4babf9d818144e\", GitTreeState:\"clean\"}\r\nServer: &version.Version{SemVer:\"v2.15.2\", GitCommit:\"8dce272473e5f2a7bf58ce79bb5c3691db54c96b\", GitTreeState:\"dirty\"}\r\n```\r\nOutput of `kubectl version`:\r\n```\r\n$ ./kubectl version\r\nClient Version: version.Info{Major:\"1\", Minor:\"16\", GitVersion:\"v1.16.1\", GitCommit:\"d647ddbd755faf07169599a625faf302ffc34458\", GitTreeState:\"clean\", BuildDate:\"2019-10-02T17:01:15Z\", GoVersion:\"go1.12.10\", Compiler:\"gc\", Platform:\"darwin/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"16\", GitVersion:\"v1.16.2\", GitCommit:\"c97fe5036ef3df2967d086711e6c0c405941e14b\", GitTreeState:\"clean\", BuildDate:\"2019-10-15T19:09:08Z\", GoVersion:\"go1.12.10\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n```\r\nCloud Provider/Platform (AKS, GKE, Minikube etc.): \r\nminikube\r\n\r\n--------------\r\n\r\nOver the past few months there have been numerous issues opened for this very issue[1] and in the end they were mostly closed as \"working as designed\" / \"this is a k8s problem\". When looking at the k8s issues linked, k8s also seems to be \"working as designed\". \r\n\r\n[1]https://github.com/helm/helm/issues/6583\r\nhttps://github.com/helm/helm/issues/6969\r\n\r\n--------------\r\n\r\nI've been digging through the helm code the past couple days to better understand the problem / try to hack a solution together. My understanding of the problem is (simplified):\r\n\r\n1. Install k8s 1.15\r\n2. helm install a chart w/ deployment @ `apps/v1beta1`\r\n* helm stores these templates in a config map for later operations\r\n3. upgrade k8s to 1.16\r\n* k8s automagically \"upgrades\" the deployment to `apps/v1`\r\n4. Update chart to use `apps/v1`\r\n5. helm upgrade\r\n\r\nThe `helm upgrade` fails as it attempts to create a diff patch from steps 2 to 4. The problem is that helm doesn't know that it's source is no longer valid for the current version of k8s.\r\n\r\nThere have been a number of solutions proposed, but I wonder if there is a k8s API that helm could call to \"upgrade\" the API in the same manner that happens when moving from 1.15 -> 1.16? Perhaps there is a way to do that when calling `BuildUnstructured` ? I'm game for any and all suggestions.\r\n\r\nAnother thought... Perhaps have a new `helm` flag that would force update based off the current template values (put rather than patch). This assume that the new template has a 'valid' api version specified.\r\n\r\nA few other comments:\r\n* Right now I'm talking about deployments, but I'm fairly certain this is a common problem across any number of other apis.\r\n* Destructive operations are a no-go due to use of statefulsets.\r\n* This might be a crappy, but workable workaround[1] ?\r\n\r\n[1] https://github.com/helm/helm/issues/6969#issuecomment-565043434\r\n\r\n\r\n", "closed_by": {"login": "bacongobbler", "id": 1360539, "node_id": "MDQ6VXNlcjEzNjA1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1360539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bacongobbler", "html_url": "https://github.com/bacongobbler", "followers_url": "https://api.github.com/users/bacongobbler/followers", "following_url": "https://api.github.com/users/bacongobbler/following{/other_user}", "gists_url": "https://api.github.com/users/bacongobbler/gists{/gist_id}", "starred_url": "https://api.github.com/users/bacongobbler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bacongobbler/subscriptions", "organizations_url": "https://api.github.com/users/bacongobbler/orgs", "repos_url": "https://api.github.com/users/bacongobbler/repos", "events_url": "https://api.github.com/users/bacongobbler/events{/privacy}", "received_events_url": "https://api.github.com/users/bacongobbler/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/7219/reactions", "total_count": 16, "+1": 16, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/7219/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/9136", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/9136/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/9136/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/9136/events", "html_url": "https://github.com/helm/helm/issues/9136", "id": 769377718, "node_id": "MDU6SXNzdWU3NjkzNzc3MTg=", "number": 9136, "title": "Nested `null` values do not remove keys from sub-charts", "user": {"login": "elliotkennedy", "id": 16102271, "node_id": "MDQ6VXNlcjE2MTAyMjcx", "avatar_url": "https://avatars.githubusercontent.com/u/16102271?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elliotkennedy", "html_url": "https://github.com/elliotkennedy", "followers_url": "https://api.github.com/users/elliotkennedy/followers", "following_url": "https://api.github.com/users/elliotkennedy/following{/other_user}", "gists_url": "https://api.github.com/users/elliotkennedy/gists{/gist_id}", "starred_url": "https://api.github.com/users/elliotkennedy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elliotkennedy/subscriptions", "organizations_url": "https://api.github.com/users/elliotkennedy/orgs", "repos_url": "https://api.github.com/users/elliotkennedy/repos", "events_url": "https://api.github.com/users/elliotkennedy/events{/privacy}", "received_events_url": "https://api.github.com/users/elliotkennedy/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 269212354, "node_id": "MDU6TGFiZWwyNjkyMTIzNTQ=", "url": "https://api.github.com/repos/helm/helm/labels/help%20wanted", "name": "help wanted", "color": "006b75", "default": true, "description": "Denotes an issue that needs help from a contributor. Must meet \"help wanted\" guidelines."}, {"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 56, "created_at": "2020-12-17T00:34:49Z", "updated_at": "2023-12-13T14:11:20Z", "closed_at": "2022-10-14T22:39:09Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "#2648 and #5184 allow for deletion of keys by setting null values in a values.yaml file. However it doesn't work for removing nested values in sub-charts, e.g.:\r\n\r\nvalues.yaml:\r\n\r\n```yaml\r\nkibana:\r\n  resources:\r\n    requests:\r\n      cpu: 1000m\r\n      memory: 2Gi\r\n    limits:\r\n      cpu: null\r\n      memory: 2Gi\r\n```\r\n\r\nChart.yaml:\r\n```yaml\r\napiVersion: v2\r\nname: elastic\r\ndescription: Elastic stack\r\ntype: application\r\nversion: 0.0.1\r\ndependencies:\r\n  - name: kibana\r\n    version: 7.9.3\r\n    repository: \"@elastic\"\r\n```\r\n\r\nResults in a deployment object with the base cpu limits:\r\n```yaml\r\n...\r\nresources:\r\n  limits:\r\n    cpu: 1000m\r\n    memory: 2Gi\r\n  requests:\r\n    cpu: 1000m\r\n    memory: 2Gi\r\n\r\n```\r\n\r\nOutput of `helm version`:\r\n\r\n```bash\r\nversion.BuildInfo{Version:\"v3.4.1\", GitCommit:\"c4e74854886b2efe3321e185578e6db9be0a6e29\", GitTreeState:\"clean\", GoVersion:\"go1.14.11\"}\r\n```\r\n\r\nOutput of `kubectl version`:\r\n\r\n```bash\r\nClient Version: version.Info{Major:\"1\", Minor:\"19\", GitVersion:\"v1.19.4\", GitCommit:\"d360454c9bcd1634cf4cc52d1867af5491dc9c5f\", GitTreeState:\"archive\", BuildDate:\"2020-12-04T15:20:33Z\", GoVersion:\"go1.15.5\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"18\", GitVersion:\"v1.18.10\", GitCommit:\"62876fc6d93e891aa7fbe19771e6a6c03773b0f7\", GitTreeState:\"clean\", BuildDate:\"2020-10-15T01:43:56Z\", GoVersion:\"go1.13.15\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n```\r\n\r\nCloud Provider/Platform (AKS, GKE, Minikube etc.): \r\n\r\nAWS/Kops\r\n", "closed_by": {"login": "joejulian", "id": 952828, "node_id": "MDQ6VXNlcjk1MjgyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/952828?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joejulian", "html_url": "https://github.com/joejulian", "followers_url": "https://api.github.com/users/joejulian/followers", "following_url": "https://api.github.com/users/joejulian/following{/other_user}", "gists_url": "https://api.github.com/users/joejulian/gists{/gist_id}", "starred_url": "https://api.github.com/users/joejulian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joejulian/subscriptions", "organizations_url": "https://api.github.com/users/joejulian/orgs", "repos_url": "https://api.github.com/users/joejulian/repos", "events_url": "https://api.github.com/users/joejulian/events{/privacy}", "received_events_url": "https://api.github.com/users/joejulian/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/9136/reactions", "total_count": 84, "+1": 84, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/9136/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/4262", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/4262/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/4262/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/4262/events", "html_url": "https://github.com/helm/helm/issues/4262", "id": 335132844, "node_id": "MDU6SXNzdWUzMzUxMzI4NDQ=", "number": 4262, "title": "toYaml removes all quotes and yaml types breaks", "user": {"login": "shal", "id": 15674738, "node_id": "MDQ6VXNlcjE1Njc0NzM4", "avatar_url": "https://avatars.githubusercontent.com/u/15674738?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shal", "html_url": "https://github.com/shal", "followers_url": "https://api.github.com/users/shal/followers", "following_url": "https://api.github.com/users/shal/following{/other_user}", "gists_url": "https://api.github.com/users/shal/gists{/gist_id}", "starred_url": "https://api.github.com/users/shal/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shal/subscriptions", "organizations_url": "https://api.github.com/users/shal/orgs", "repos_url": "https://api.github.com/users/shal/repos", "events_url": "https://api.github.com/users/shal/events{/privacy}", "received_events_url": "https://api.github.com/users/shal/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}, {"id": 1167210971, "node_id": "MDU6TGFiZWwxMTY3MjEwOTcx", "url": "https://api.github.com/repos/helm/helm/labels/blocked", "name": "blocked", "color": "f282ab", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 56, "created_at": "2018-06-23T21:38:12Z", "updated_at": "2025-11-06T13:39:45Z", "closed_at": "2022-05-13T17:38:18Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Output of `helm version`:\r\n```go\r\nClient: &version.Version{SemVer:\"v2.9.1\", GitCommit:\"20adb27c7c5868466912eebdf6664e7390ebe710\", GitTreeState:\"clean\"}\r\nServer: &version.Version{SemVer:\"v2.9.1\", GitCommit:\"20adb27c7c5868466912eebdf6664e7390ebe710\", GitTreeState:\"clean\"}\r\n```\r\n\r\nOutput of `kubectl version`:\r\n```go\r\nClient Version: version.Info{Major:\"1\", Minor:\"9\", GitVersion:\"v1.9.7\", GitCommit:\"dd5e1a2978fd0b97d9b78e1564398aeea7e7fe92\", GitTreeState:\"clean\", BuildDate:\"2018-04-19T00:05:56Z\", GoVersion:\"go1.9.3\", Compiler:\"gc\", Platform:\"darwin/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"8+\", GitVersion:\"v1.8.10-gke.0\", GitCommit:\"16ebd0de8e0ab2d1ef86d5b16ab1899b624a77cd\", GitTreeState:\"clean\", BuildDate:\"2018-03-20T20:21:01Z\", GoVersion:\"go1.8.3b4\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n```\r\n\r\nCloud Provider/Platform (AKS, GKE, Minikube etc.):  **GKE**\r\n\r\nI got following problem:\r\n\r\nFile: `values.yml`\r\n```yaml\r\ninfo:\r\n  address: \"0x1ddf249430c343f72f8b12848aa3f932538e3336\"\r\n```\r\n\r\nFile: `configmap.yml`\r\n```yaml\r\napiVersion: v1\r\nkind: ConfigMap\r\nmetadata:\r\n  name: {{ template \"fullname\" . }}\r\n  labels:\r\n    app: {{ template \"fullname\" . }}\r\n    chart: \"{{ .Chart.Name }}-{{ .Chart.Version }}\"\r\n    release: \"{{ .Release.Name }}\"\r\n    heritage: \"{{ .Release.Service }}\"\r\ndata:\r\n  file.yml: |-\r\n{{ toYaml .Values.info | indent 4 }}\r\n```\r\n\r\nAfter `toYaml` address will be not a string.\r\n\r\n\r\n", "closed_by": {"login": "bacongobbler", "id": 1360539, "node_id": "MDQ6VXNlcjEzNjA1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1360539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bacongobbler", "html_url": "https://github.com/bacongobbler", "followers_url": "https://api.github.com/users/bacongobbler/followers", "following_url": "https://api.github.com/users/bacongobbler/following{/other_user}", "gists_url": "https://api.github.com/users/bacongobbler/gists{/gist_id}", "starred_url": "https://api.github.com/users/bacongobbler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bacongobbler/subscriptions", "organizations_url": "https://api.github.com/users/bacongobbler/orgs", "repos_url": "https://api.github.com/users/bacongobbler/repos", "events_url": "https://api.github.com/users/bacongobbler/events{/privacy}", "received_events_url": "https://api.github.com/users/bacongobbler/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/4262/reactions", "total_count": 37, "+1": 28, "-1": 0, "laugh": 0, "hooray": 0, "confused": 9, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/4262/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/2918", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/2918/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/2918/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/2918/events", "html_url": "https://github.com/helm/helm/issues/2918", "id": 256603154, "node_id": "MDU6SXNzdWUyNTY2MDMxNTQ=", "number": 2918, "title": "watch closed before Until timeout", "user": {"login": "scd-systems", "id": 14056185, "node_id": "MDQ6VXNlcjE0MDU2MTg1", "avatar_url": "https://avatars.githubusercontent.com/u/14056185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/scd-systems", "html_url": "https://github.com/scd-systems", "followers_url": "https://api.github.com/users/scd-systems/followers", "following_url": "https://api.github.com/users/scd-systems/following{/other_user}", "gists_url": "https://api.github.com/users/scd-systems/gists{/gist_id}", "starred_url": "https://api.github.com/users/scd-systems/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/scd-systems/subscriptions", "organizations_url": "https://api.github.com/users/scd-systems/orgs", "repos_url": "https://api.github.com/users/scd-systems/repos", "events_url": "https://api.github.com/users/scd-systems/events{/privacy}", "received_events_url": "https://api.github.com/users/scd-systems/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/helm/helm/milestones/67", "html_url": "https://github.com/helm/helm/milestone/67", "labels_url": "https://api.github.com/repos/helm/helm/milestones/67/labels", "id": 4322550, "node_id": "MDk6TWlsZXN0b25lNDMyMjU1MA==", "number": 67, "title": "2.15.0", "description": "", "creator": {"login": "bacongobbler", "id": 1360539, "node_id": "MDQ6VXNlcjEzNjA1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1360539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bacongobbler", "html_url": "https://github.com/bacongobbler", "followers_url": "https://api.github.com/users/bacongobbler/followers", "following_url": "https://api.github.com/users/bacongobbler/following{/other_user}", "gists_url": "https://api.github.com/users/bacongobbler/gists{/gist_id}", "starred_url": "https://api.github.com/users/bacongobbler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bacongobbler/subscriptions", "organizations_url": "https://api.github.com/users/bacongobbler/orgs", "repos_url": "https://api.github.com/users/bacongobbler/repos", "events_url": "https://api.github.com/users/bacongobbler/events{/privacy}", "received_events_url": "https://api.github.com/users/bacongobbler/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 42, "state": "closed", "created_at": "2019-05-16T22:48:54Z", "updated_at": "2019-10-18T20:05:43Z", "due_on": "2019-10-18T00:00:00Z", "closed_at": "2019-10-18T20:05:43Z"}, "comments": 53, "created_at": "2017-09-11T07:14:09Z", "updated_at": "2021-09-08T21:45:30Z", "closed_at": "2019-10-03T13:52:39Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Hi,\r\nwe got reproducable error messages from tiller/helm during helm install process of a job chart.\u2028The job it self gets finished successfully in kubernetes, but helm/tiller dies with the error message from above.\r\n\r\nTiller log:\r\n>09:16:35[tiller] 2017/09/08 07:16:35 preparing install for jobx\r\n\u202809:16:35[storage] 2017/09/08 07:16:35 getting release history for \"jobx\"\u2028\r\n09:16:35[tiller] 2017/09/08 07:16:35 rendering postinstall chart using values\r\n\u202809:16:352017/09/08 07:16:35 info: manifest \"postinstall/templates/configure-storage-nfs.yaml\" is empty. Skipping.\u2028\r\n09:16:35[tiller] 2017/09/08 07:16:35 performing install for jobx\u2028\r\n09:16:35[tiller] 2017/09/08 07:16:35 executing 5 pre-install hooks for jobx\r\n\u202809:16:35[kube] 2017/09/08 07:16:35 building resources from manifest\u2028\r\n09:16:35[kube] 2017/09/08 07:16:35 creating 1 resource(s)\u2028\r\n09:16:35[kube] 2017/09/08 07:16:35 Watching for changes to Job configure-buckets with timeout of 5m0s\u2028\r\n09:16:35[kube] 2017/09/08 07:16:35 Add/Modify event for configure-buckets: ADDED\r\n\u202809:16:35[kube] 2017/09/08 07:16:35 configure-buckets: Jobs active: 1, jobs failed: 0, jobs succeeded: 0\r\n\u202809:17:06[tiller] 2017/09/08 07:17:06 warning: Release jobx pre-install postinstall/templates/couchbase-buckets.yaml could not complete: watch closed before Until timeout\r\n\u202809:17:06[tiller] 2017/09/08 07:17:06 failed install perform step: watch closed before Until timeout\r\n\r\nkube-apiserver reports very often:\r\n>09:16:03 E0908 07:16:03.467638 1 watch.go:228] unable to encode watch object: write tcp 10.42.188.75:6443->10.42.51.83:36618: write: connection reset by peer (&streaming.encoder{writer:(*framer.lengthDelimitedFrameWriter)(0xc4206ebbc0), encoder:(*versioning.codec)(0xc425b55b90), buf:(*bytes.Buffer)(0xc421a29ea0)})\u2028\r\n09:16:03 E0908 07:16:03.467674 1 watch.go:228] unable to encode watch object: write tcp 10.42.188.75:6443->10.42.51.83:36618: write: connection reset by peer (&streaming.encoder{writer:(*framer.lengthDelimitedFrameWriter)(0xc4217c2760), encoder:(*versioning.codec)(0xc422ce5050), buf:(*bytes.Buffer)(0xc421962230)})\r\n\r\nTiller version: 2.6.1\r\n\r\nhelm version:\r\nClient: &version.Version{SemVer:\"v2.6.1\", GitCommit:\"bbc1f71dc03afc5f00c6ac84b9308f8ecb4f39ac\", GitTreeState:\"clean\"}\r\n\u2028Server: &version.Version{SemVer:\"v2.6.1\", GitCommit:\"bbc1f71dc03afc5f00c6ac84b9308f8ecb4f39ac\", GitTreeState:\"clean\"}\r\n\r\nDocker version: \u20281.12.6\r\nOperating system: 1465.6.0\r\nKubernetes: 1.7.4 (also tested 1.6.6 and 1.7.2 with the same results)\r\n\r\nHowto Reproduce: \r\n> \u2028helm install --tiller-namespace anyname -n jobx -f values.yaml --namespace anyname jobs/\r\n\r\nError: watch closed before Until timeout", "closed_by": {"login": "hickeyma", "id": 14892004, "node_id": "MDQ6VXNlcjE0ODkyMDA0", "avatar_url": "https://avatars.githubusercontent.com/u/14892004?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hickeyma", "html_url": "https://github.com/hickeyma", "followers_url": "https://api.github.com/users/hickeyma/followers", "following_url": "https://api.github.com/users/hickeyma/following{/other_user}", "gists_url": "https://api.github.com/users/hickeyma/gists{/gist_id}", "starred_url": "https://api.github.com/users/hickeyma/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hickeyma/subscriptions", "organizations_url": "https://api.github.com/users/hickeyma/orgs", "repos_url": "https://api.github.com/users/hickeyma/repos", "events_url": "https://api.github.com/users/hickeyma/events{/privacy}", "received_events_url": "https://api.github.com/users/hickeyma/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/2918/reactions", "total_count": 4, "+1": 4, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/2918/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/4326", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/4326/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/4326/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/4326/events", "html_url": "https://github.com/helm/helm/issues/4326", "id": 340191694, "node_id": "MDU6SXNzdWUzNDAxOTE2OTQ=", "number": 4326, "title": "Cannot perform helm init behind proxy", "user": {"login": "ptylenda", "id": 11139004, "node_id": "MDQ6VXNlcjExMTM5MDA0", "avatar_url": "https://avatars.githubusercontent.com/u/11139004?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptylenda", "html_url": "https://github.com/ptylenda", "followers_url": "https://api.github.com/users/ptylenda/followers", "following_url": "https://api.github.com/users/ptylenda/following{/other_user}", "gists_url": "https://api.github.com/users/ptylenda/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptylenda/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptylenda/subscriptions", "organizations_url": "https://api.github.com/users/ptylenda/orgs", "repos_url": "https://api.github.com/users/ptylenda/repos", "events_url": "https://api.github.com/users/ptylenda/events{/privacy}", "received_events_url": "https://api.github.com/users/ptylenda/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/helm/helm/milestones/55", "html_url": "https://github.com/helm/helm/milestone/55", "labels_url": "https://api.github.com/repos/helm/helm/milestones/55/labels", "id": 3517674, "node_id": "MDk6TWlsZXN0b25lMzUxNzY3NA==", "number": 55, "title": "2.11.0 - Features", "description": "Feature branch for 2.11 milestone", "creator": {"login": "technosophos", "id": 89193, "node_id": "MDQ6VXNlcjg5MTkz", "avatar_url": "https://avatars.githubusercontent.com/u/89193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/technosophos", "html_url": "https://github.com/technosophos", "followers_url": "https://api.github.com/users/technosophos/followers", "following_url": "https://api.github.com/users/technosophos/following{/other_user}", "gists_url": "https://api.github.com/users/technosophos/gists{/gist_id}", "starred_url": "https://api.github.com/users/technosophos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/technosophos/subscriptions", "organizations_url": "https://api.github.com/users/technosophos/orgs", "repos_url": "https://api.github.com/users/technosophos/repos", "events_url": "https://api.github.com/users/technosophos/events{/privacy}", "received_events_url": "https://api.github.com/users/technosophos/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 37, "state": "closed", "created_at": "2018-07-23T19:48:56Z", "updated_at": "2018-10-14T18:00:21Z", "due_on": null, "closed_at": "2018-10-14T18:00:21Z"}, "comments": 52, "created_at": "2018-07-11T10:55:40Z", "updated_at": "2018-10-19T07:31:49Z", "closed_at": "2018-09-03T13:57:56Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Output of `helm version`: v2.10.0-rc.1 (https://github.com/kubernetes/helm/releases/tag/v2.10.0-rc.1)\r\n\r\nOutput of `kubectl version`: v1.11.0\r\n\r\nCloud Provider/Platform (AKS, GKE, Minikube etc.): bare metal\r\n\r\nDescription:\r\nWhen checking the latest RC version (https://github.com/kubernetes/helm/releases/tag/v2.10.0-rc.1) I am unable to perform \"helm init\" behind proxy:\r\n```\r\n$ ./helm init --node-selectors \"beta.kubernetes.io/os\"=linux\r\nCreating /home/ubuntu/.helm\r\nCreating /home/ubuntu/.helm/repository\r\nCreating /home/ubuntu/.helm/repository/cache\r\nCreating /home/ubuntu/.helm/repository/local\r\nCreating /home/ubuntu/.helm/plugins\r\nCreating /home/ubuntu/.helm/starters\r\nCreating /home/ubuntu/.helm/cache/archive\r\nCreating /home/ubuntu/.helm/repository/repositories.yaml\r\nAdding stable repo with URL: https://kubernetes-charts.storage.googleapis.com\r\nError: Looks like \"https://kubernetes-charts.storage.googleapis.com\" is not a valid chart repository or cannot be reached: Get https://kubernetes-charts.storage.googleapis.com/index.yaml: dial tcp 216.58.214.80:443: connect: connection timed out\r\n```\r\n\r\nMy environment is set properly for proxy:\r\n```\r\n$ export\r\n...\r\ndeclare -x HTTPS_PROXY=\"http://some-proxy:1234\"\r\ndeclare -x HTTP_PROXY=\"http://some-proxy:1234\"\r\n...\r\ndeclare -x http_proxy=\"http://some-proxy:1234\"\r\ndeclare -x https_proxy=\"http://some-proxy:1234\"\r\n```\r\n\r\nAnd downgrading to latest stable release v2.9.1 (https://github.com/kubernetes/helm/releases/tag/v2.9.1) solves the issue:\r\n```\r\n$ ./helm init --node-selectors \"beta.kubernetes.io/os\"=linux\r\nCreating /home/ubuntu/.helm/repository/repositories.yaml\r\nAdding stable repo with URL: https://kubernetes-charts.storage.googleapis.com\r\nAdding local repo with URL: http://127.0.0.1:8879/charts\r\n$HELM_HOME has been configured at /home/ubuntu/.helm.\r\n\r\nTiller (the Helm server-side component) has been installed into your Kubernetes Cluster.\r\n\r\nPlease note: by default, Tiller is deployed with an insecure 'allow unauthenticated users' policy.\r\nFor more information on securing your installation see: https://docs.helm.sh/using_helm/#securing-your-helm-installation\r\nHappy Helming!\r\n```\r\n", "closed_by": {"login": "bacongobbler", "id": 1360539, "node_id": "MDQ6VXNlcjEzNjA1Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1360539?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bacongobbler", "html_url": "https://github.com/bacongobbler", "followers_url": "https://api.github.com/users/bacongobbler/followers", "following_url": "https://api.github.com/users/bacongobbler/following{/other_user}", "gists_url": "https://api.github.com/users/bacongobbler/gists{/gist_id}", "starred_url": "https://api.github.com/users/bacongobbler/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bacongobbler/subscriptions", "organizations_url": "https://api.github.com/users/bacongobbler/orgs", "repos_url": "https://api.github.com/users/bacongobbler/repos", "events_url": "https://api.github.com/users/bacongobbler/events{/privacy}", "received_events_url": "https://api.github.com/users/bacongobbler/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/4326/reactions", "total_count": 11, "+1": 11, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/4326/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/6214", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/6214/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/6214/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/6214/events", "html_url": "https://github.com/helm/helm/issues/6214", "id": 479948168, "node_id": "MDU6SXNzdWU0Nzk5NDgxNjg=", "number": 6214, "title": "Helm 3: 'helm chart push/pull' can't fetch oauth token", "user": {"login": "zhihuiwu", "id": 20413670, "node_id": "MDQ6VXNlcjIwNDEzNjcw", "avatar_url": "https://avatars.githubusercontent.com/u/20413670?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zhihuiwu", "html_url": "https://github.com/zhihuiwu", "followers_url": "https://api.github.com/users/zhihuiwu/followers", "following_url": "https://api.github.com/users/zhihuiwu/following{/other_user}", "gists_url": "https://api.github.com/users/zhihuiwu/gists{/gist_id}", "starred_url": "https://api.github.com/users/zhihuiwu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zhihuiwu/subscriptions", "organizations_url": "https://api.github.com/users/zhihuiwu/orgs", "repos_url": "https://api.github.com/users/zhihuiwu/repos", "events_url": "https://api.github.com/users/zhihuiwu/events{/privacy}", "received_events_url": "https://api.github.com/users/zhihuiwu/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}, {"id": 926755770, "node_id": "MDU6TGFiZWw5MjY3NTU3NzA=", "url": "https://api.github.com/repos/helm/helm/labels/v3.x", "name": "v3.x", "color": "e82969", "default": false, "description": "Issues and Pull Requests related to the major version v3"}, {"id": 2290444626, "node_id": "MDU6TGFiZWwyMjkwNDQ0NjI2", "url": "https://api.github.com/repos/helm/helm/labels/Stale", "name": "Stale", "color": "ededed", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 51, "created_at": "2019-08-13T04:01:34Z", "updated_at": "2022-06-20T23:07:35Z", "closed_at": "2022-04-06T00:12:38Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Output of `helm version`:\r\nversion.BuildInfo{Version:\"v3.0.0-alpha.2\", GitCommit:\"97e7461e41455e58d89b4d7d192fed5352001d44\", GitTreeState:\"clean\", GoVersion:\"go1.12.7\"}\r\n\r\nI setup a docker registry (container, image is registry:2) and an auth sever(other container, image is cesanta/docker_auth:latest) \r\n\r\nAnd I enabled token auth on the registry. The auth configuration of the registry container is as follow:\r\n\r\n```\r\nauth:\r\n  token:\r\n    realm: https://helm.auth.zte.com:5001/auth\r\n    service: \"token\"\r\n    issuer: \"Auth Service\"\r\n    rootcertbundle: /certs/server.pem\r\nhttp:\r\n  addr: :5000\r\n  host: https://helm.registry.zte.com:5000\r\n  tls:\r\n    certificate: /certs/domain.crt\r\n    key: /certs/domain.key\r\n  headers:\r\n    X-Content-Type-Options: [nosniff]\r\n```\r\nThe config of auth server is as follow:\r\n\r\n```\r\nserver:  # Server settings.\r\n  # Address to listen on.\r\n  addr: \":5001\"\r\n  # TLS certificate and key.\r\n  certificate: \"/ssl/server.pem\"\r\n  key: \"/ssl/server.key\"\r\n\r\ntoken:  # Settings for the tokens.\r\n  issuer: \"Auth Service\"  # Must match issuer in the Registry config.\r\n  expiration: 900\r\n\r\n\r\n# Static user map.\r\nusers:\r\n  # Password is specified as a BCrypt hash. Use htpasswd -B to generate.\r\n  \"helm\":\r\n    password: \"$2y$05$JX9D.kynlW5HsbWx7FeUOuBY7XdKAB/bq27yLAFmFCsrcDzgzHdpi\"\r\n\r\nacl:\r\n  # Admin has full access to everything.\r\n  - match: {account: \"helm\"}\r\n    actions: [\"*\"]\r\n```\r\n\"helm registry login https://helm.registry.zte.com:5000\" returned \"Login succeed\". But when I run `helm chart push`, the response from helm said\r\n\r\n```\r\nhelm chart --debug push helm.registry.zte.com:5000/mysql:1.2.0\r\nThe push refers to repository [helm.registry.zte.com:5000/mysql]\r\nName: mysql\r\nVersion: 1.2.0\r\nMeta: sha256:ce6406ac24828c894298fbf6f2b45552e15033de13e11a79968c6e73a959d7c1\r\nContent: sha256:ab5943bba9a103dabb3c579ec116c5cd90e9cd06693583f5dc31c03653fe3564\r\nWARN[0000] encountered unknown type application/vnd.cncf.helm.chart.content.layer.v1+tar; children may not be fetched \r\nDEBU[0000] push                                          digest=\"sha256:ab5943bba9a103dabb3c579ec116c5cd90e9cd06693583f5dc31c03653fe3564\" mediatype=application/vnd.cncf.helm.chart.content.layer.v1+tar size=4086\r\nWARN[0000] reference for unknown type: application/vnd.cncf.helm.chart.content.layer.v1+tar  digest=\"sha256:ab5943bba9a103dabb3c579ec116c5cd90e9cd06693583f5dc31c03653fe3564\" mediatype=application/vnd.cncf.helm.chart.content.layer.v1+tar size=4086\r\nDEBU[0000] do request                                    digest=\"sha256:ab5943bba9a103dabb3c579ec116c5cd90e9cd06693583f5dc31c03653fe3564\" mediatype=application/vnd.cncf.helm.chart.content.layer.v1+tar request.headers=\"map[Accept:[application/vnd.cncf.helm.chart.content.layer.v1+tar, *]]\" request.method=HEAD size=4086 url=\"https://helm.registry.zte.com:5000/v2/mysql/blobs/sha256:ab5943bba9a103dabb3c579ec116c5cd90e9cd06693583f5dc31c03653fe3564\"\r\nWARN[0000] encountered unknown type application/vnd.cncf.helm.config.v1+json; children may not be fetched \r\nDEBU[0000] push                                          digest=\"sha256:44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a\" mediatype=application/vnd.cncf.helm.config.v1+json size=2\r\nWARN[0000] reference for unknown type: application/vnd.cncf.helm.config.v1+json  digest=\"sha256:44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a\" mediatype=application/vnd.cncf.helm.config.v1+json size=2\r\nDEBU[0000] do request                                    digest=\"sha256:44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a\" mediatype=application/vnd.cncf.helm.config.v1+json request.headers=\"map[Accept:[application/vnd.cncf.helm.config.v1+json, *]]\" request.method=HEAD size=2 url=\"https://helm.registry.zte.com:5000/v2/mysql/blobs/sha256:44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a\"\r\nWARN[0000] encountered unknown type application/vnd.cncf.helm.chart.meta.layer.v1+json; children may not be fetched \r\nDEBU[0000] push                                          digest=\"sha256:ce6406ac24828c894298fbf6f2b45552e15033de13e11a79968c6e73a959d7c1\" mediatype=application/vnd.cncf.helm.chart.meta.layer.v1+json size=492\r\nWARN[0000] reference for unknown type: application/vnd.cncf.helm.chart.meta.layer.v1+json  digest=\"sha256:ce6406ac24828c894298fbf6f2b45552e15033de13e11a79968c6e73a959d7c1\" mediatype=application/vnd.cncf.helm.chart.meta.layer.v1+json size=492\r\nDEBU[0000] do request                                    digest=\"sha256:ce6406ac24828c894298fbf6f2b45552e15033de13e11a79968c6e73a959d7c1\" mediatype=application/vnd.cncf.helm.chart.meta.layer.v1+json request.headers=\"map[Accept:[application/vnd.cncf.helm.chart.meta.layer.v1+json, *]]\" request.method=HEAD size=492 url=\"https://helm.registry.zte.com:5000/v2/mysql/blobs/sha256:ce6406ac24828c894298fbf6f2b45552e15033de13e11a79968c6e73a959d7c1\"\r\nDEBU[0000] fetch response received                       digest=\"sha256:ce6406ac24828c894298fbf6f2b45552e15033de13e11a79968c6e73a959d7c1\" mediatype=application/vnd.cncf.helm.chart.meta.layer.v1+json response.headers=\"map[Content-Length:[148] Content-Type:[application/json; charset=utf-8] Date:[Tue, 13 Aug 2019 02:07:40 GMT] Docker-Distribution-Api-Version:[registry/2.0] Www-Authenticate:[Bearer realm=\\\"https://helm.auth.zte.com:5001/auth\\\",service=\\\"token\\\",scope=\\\"repository:mysql:pull\\\"] X-Content-Type-Options:[nosniff]]\" size=492 status=\"401 Unauthorized\" url=\"https://helm.registry.zte.com:5000/v2/mysql/blobs/sha256:ce6406ac24828c894298fbf6f2b45552e15033de13e11a79968c6e73a959d7c1\"\r\nDEBU[0000] Unauthorized                                  digest=\"sha256:ce6406ac24828c894298fbf6f2b45552e15033de13e11a79968c6e73a959d7c1\" header=\"Bearer realm=\\\"https://helm.auth.zte.com:5001/auth\\\",service=\\\"token\\\",scope=\\\"repository:mysql:pull\\\"\" mediatype=application/vnd.cncf.helm.chart.meta.layer.v1+json size=492\r\nDEBU[0000] fetch response received                       digest=\"sha256:44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a\" mediatype=application/vnd.cncf.helm.config.v1+json response.headers=\"map[Content-Length:[148] Content-Type:[application/json; charset=utf-8] Date:[Tue, 13 Aug 2019 02:07:40 GMT] Docker-Distribution-Api-Version:[registry/2.0] Www-Authenticate:[Bearer realm=\\\"https://helm.auth.zte.com:5001/auth\\\",service=\\\"token\\\",scope=\\\"repository:mysql:pull\\\"] X-Content-Type-Options:[nosniff]]\" size=2 status=\"401 Unauthorized\" url=\"https://helm.registry.zte.com:5000/v2/mysql/blobs/sha256:44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a\"\r\nDEBU[0000] Unauthorized                                  digest=\"sha256:44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a\" header=\"Bearer realm=\\\"https://helm.auth.zte.com:5001/auth\\\",service=\\\"token\\\",scope=\\\"repository:mysql:pull\\\"\" mediatype=application/vnd.cncf.helm.config.v1+json size=2\r\nDEBU[0000] token request failed                          body=\"Bad request: invalid scope: \\\"repository:mysql:pull repository:mysql:pull,push\\\"\\n\" digest=\"sha256:44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a\" mediatype=application/vnd.cncf.helm.config.v1+json size=2 status=\"400 Bad Request\"\r\nError: failed to fetch oauth token: unexpected status: 400 Bad Request\r\nhelm.go:76: [debug] unexpected status: 400 Bad Request\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker.(*dockerAuthorizer).fetchTokenWithOAuth\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker/authorizer.go:215\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker.(*dockerAuthorizer).setTokenAuth\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker/authorizer.go:149\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker.(*dockerAuthorizer).AddResponses\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker/authorizer.go:83\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker.(*dockerBase).retryRequest\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker/resolver.go:393\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker.(*dockerBase).doRequestWithRetries\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker/resolver.go:373\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker.dockerPusher.Push\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker/pusher.go:86\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes.push\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/handlers.go:135\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes.PushHandler.func1\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/handlers.go:127\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/images.HandlerFunc.Handle\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/images/handlers.go:53\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/images.Handlers.func1\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/images/handlers.go:63\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/images.HandlerFunc.Handle\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/images/handlers.go:53\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/images.Dispatch.func1\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/images/handlers.go:123\r\nhelm.sh/helm/vendor/golang.org/x/sync/errgroup.(*Group).Go.func1\r\n\t/go/src/helm.sh/helm/vendor/golang.org/x/sync/errgroup/errgroup.go:57\r\nruntime.goexit\r\n\t/usr/local/go/src/runtime/asm_386.s:1321\r\nfailed to fetch oauth token\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker.(*dockerAuthorizer).setTokenAuth\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker/authorizer.go:151\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker.(*dockerAuthorizer).AddResponses\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker/authorizer.go:83\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker.(*dockerBase).retryRequest\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker/resolver.go:393\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker.(*dockerBase).doRequestWithRetries\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker/resolver.go:373\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker.dockerPusher.Push\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/docker/pusher.go:86\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes.push\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/handlers.go:135\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/remotes.PushHandler.func1\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/remotes/handlers.go:127\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/images.HandlerFunc.Handle\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/images/handlers.go:53\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/images.Handlers.func1\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/images/handlers.go:63\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/images.HandlerFunc.Handle\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/images/handlers.go:53\r\nhelm.sh/helm/vendor/github.com/containerd/containerd/images.Dispatch.func1\r\n\t/go/src/helm.sh/helm/vendor/github.com/containerd/containerd/images/handlers.go:123\r\nhelm.sh/helm/vendor/golang.org/x/sync/errgroup.(*Group).Go.func1\r\n\t/go/src/helm.sh/helm/vendor/golang.org/x/sync/errgroup/errgroup.go:57\r\nruntime.goexit\r\n\t/usr/local/go/src/runtime/asm_386.s:1321\r\n```\r\nI doubted the auth server might work incorrectly. I use a script to test it.\r\n\r\n```\r\n#!/bin/bash -ex\r\n# This is the operation we want to perform on the registry\r\nregistryURL=https://helm.registry.zte.com:5000/v2/_catalog\r\n\r\n# Save the response headers of our first request to the registry to get the Www-Authenticate header\r\nrespHeader=$(tempfile);\r\ncurl -k --dump-header $respHeader $registryURL\r\n\r\n# Extract the realm, the service, and the scope from the Www-Authenticate header\r\nwwwAuth=$(cat $respHeader | grep \"Www-Authenticate\")\r\nrealm=$(echo $wwwAuth | grep -o '\\(realm\\)=\"[^\"]*\"' | cut -d '\"' -f 2)\r\nservice=$(echo $wwwAuth | grep -o '\\(service\\)=\"[^\"]*\"' | cut -d '\"' -f 2)\r\nscope=$(echo $wwwAuth | grep -o '\\(scope\\)=\"[^\"]*\"' | cut -d '\"' -f 2)\r\n\r\n# Build the URL to query the auth server\r\nauthURL=\"$realm?service=$service&scope=$scope\"\r\n\r\n# Query the auth server to get a token\r\ntoken=$(curl -ks -H \"Authorization: Basic $(echo -n \"helm:helm\" | base64)\" \"$authURL\")\r\n# Get the bare token from the JSON string: {\"token\": \"....\"}\r\ntoken=$(echo $token | jq .token | tr -d '\"')\r\n\r\n# Query the registry again, but this time with a bearer token\r\ncurl -vk -H \"Authorization: Bearer $token\" $registryURL\r\n```\r\nFrom result, a token can be fetch from the auth server.\r\n```\r\n+ curl -k --dump-header /tmp/fileOVd0Rb https://helm.registry.zte.com:5000/v2/_catalog\r\n{\"errors\":[{\"code\":\"UNAUTHORIZED\",\"message\":\"authentication required\",\"detail\":[{\"Type\":\"registry\",\"Class\":\"\",\"Name\":\"catalog\",\"Action\":\"*\"}]}]}\r\n\r\n++ curl -ks -H 'Authorization: Basic aGVsbTpoZWxt' 'https://helm.auth.zte.com:5001/auth?service=token&scope=registry:catalog:*'\r\n+ token='{\"token\":\"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IkVUWEw6TTNUUjpSNlJBOjQySk86T1c3TTpLRTRaOjRWVVg6SjVKRDpWRUFBOkpPVFQ6RkdVVjo2QVZDIn0.eyJpc3MiOiJBdXRoIFNlcnZpY2UiLCJzdWIiOiJoZWxtIiwiYXVkIjoidG9rZW4iLCJleHAiOjE1NjU2NjM2NzIsIm5iZiI6MTU2NTY2Mjc2MiwiaWF0IjoxNTY1NjYyNzcyLCJqdGkiOiI4NjEyMTk1OTA2NzkzMTQzODI0IiwiYWNjZXNzIjpbeyJ0eXBlIjoicmVnaXN0cnkiLCJuYW1lIjoiY2F0YWxvZyIsImFjdGlvbnMiOlsiKiJdfV19.NqId_NBqyCQBl9FB8E3UajU38quilY0a6CkARP5shhk45cmfHN9bFio2YG-ddJabp6mWKcrH-1smiEIGcYcIXrwuoTu3j9i-_Fcj7XTrrq06EkXMXc7D84O9H81PcdxZKOEQKxyu3OhJchS-FnsJiknH4QdvywU8mszfQC8RHb05pBULU-bgS2hGe8roU7voMkK8XywWg8I2qTzQZt6I5X3OSgroyjUdZtqF4Clfs6k6YMdqyrjx6rXo1EWRa2JTkO3n7fBu-3FrtQBG4U_v--jcG1WwAcXbHoOVXmE1E00y7_v2nLRvD78_DIDH6ZWSjyWSOXdENPWNwvj_R1qAcg\"}'\r\n\r\n+ curl -vk -H 'Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IkVUWEw6TTNUUjpSNlJBOjQySk86T1c3TTpLRTRaOjRWVVg6SjVKRDpWRUFBOkpPVFQ6RkdVVjo2QVZDIn0.eyJpc3MiOiJBdXRoIFNlcnZpY2UiLCJzdWIiOiJoZWxtIiwiYXVkIjoidG9rZW4iLCJleHAiOjE1NjU2NjM2NzIsIm5iZiI6MTU2NTY2Mjc2MiwiaWF0IjoxNTY1NjYyNzcyLCJqdGkiOiI4NjEyMTk1OTA2NzkzMTQzODI0IiwiYWNjZXNzIjpbeyJ0eXBlIjoicmVnaXN0cnkiLCJuYW1lIjoiY2F0YWxvZyIsImFjdGlvbnMiOlsiKiJdfV19.NqId_NBqyCQBl9FB8E3UajU38quilY0a6CkARP5shhk45cmfHN9bFio2YG-ddJabp6mWKcrH-1smiEIGcYcIXrwuoTu3j9i-_Fcj7XTrrq06EkXMXc7D84O9H81PcdxZKOEQKxyu3OhJchS-FnsJiknH4QdvywU8mszfQC8RHb05pBULU-bgS2hGe8roU7voMkK8XywWg8I2qTzQZt6I5X3OSgroyjUdZtqF4Clfs6k6YMdqyrjx6rXo1EWRa2JTkO3n7fBu-3FrtQBG4U_v--jcG1WwAcXbHoOVXmE1E00y7_v2nLRvD78_DIDH6ZWSjyWSOXdENPWNwvj_R1qAcg' https://helm.registry.zte.com:5000/v2/_catalog\r\n*   Trying 127.0.0.1...\r\n* Connected to helm.registry.zte.com (127.0.0.1) port 5000 (#0)\r\n* found 149 certificates in /etc/ssl/certs/ca-certificates.crt\r\n* found 594 certificates in /etc/ssl/certs\r\n* ALPN, offering http/1.1\r\n* SSL connection using TLS1.2 / ECDHE_RSA_AES_128_GCM_SHA256\r\n* \t server certificate verification SKIPPED\r\n* \t server certificate status verification SKIPPED\r\n* \t common name: helm.registry.zte.com (matched)\r\n* \t server certificate expiration date OK\r\n* \t server certificate activation date OK\r\n* \t certificate public key: RSA\r\n* \t certificate version: #3\r\n* \t subject: C=CN,ST=SH,L=SH,O=ZTE,OU=ZTE,CN=helm.registry.zte.com\r\n* \t start date: Wed, 07 Aug 2019 08:43:47 GMT\r\n* \t expire date: Thu, 06 Aug 2020 08:43:47 GMT\r\n* \t issuer: C=CN,ST=SH,L=SH,O=ZTE,OU=ZTE,CN=helm.registry.zte.com\r\n* \t compression: NULL\r\n* ALPN, server accepted to use http/1.1\r\n> GET /v2/_catalog HTTP/1.1\r\n> Host: helm.registry.zte.com:5000\r\n> User-Agent: curl/7.47.0\r\n> Accept: */*\r\n> Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IkVUWEw6TTNUUjpSNlJBOjQySk86T1c3TTpLRTRaOjRWVVg6SjVKRDpWRUFBOkpPVFQ6RkdVVjo2QVZDIn0.eyJpc3MiOiJBdXRoIFNlcnZpY2UiLCJzdWIiOiJoZWxtIiwiYXVkIjoidG9rZW4iLCJleHAiOjE1NjU2NjM2NzIsIm5iZiI6MTU2NTY2Mjc2MiwiaWF0IjoxNTY1NjYyNzcyLCJqdGkiOiI4NjEyMTk1OTA2NzkzMTQzODI0IiwiYWNjZXNzIjpbeyJ0eXBlIjoicmVnaXN0cnkiLCJuYW1lIjoiY2F0YWxvZyIsImFjdGlvbnMiOlsiKiJdfV19.NqId_NBqyCQBl9FB8E3UajU38quilY0a6CkARP5shhk45cmfHN9bFio2YG-ddJabp6mWKcrH-1smiEIGcYcIXrwuoTu3j9i-_Fcj7XTrrq06EkXMXc7D84O9H81PcdxZKOEQKxyu3OhJchS-FnsJiknH4QdvywU8mszfQC8RHb05pBULU-bgS2hGe8roU7voMkK8XywWg8I2qTzQZt6I5X3OSgroyjUdZtqF4Clfs6k6YMdqyrjx6rXo1EWRa2JTkO3n7fBu-3FrtQBG4U_v--jcG1WwAcXbHoOVXmE1E00y7_v2nLRvD78_DIDH6ZWSjyWSOXdENPWNwvj_R1qAcg\r\n> \r\n< HTTP/1.1 200 OK\r\n< Content-Type: application/json; charset=utf-8\r\n< Docker-Distribution-Api-Version: registry/2.0\r\n< X-Content-Type-Options: nosniff\r\n< Date: Tue, 13 Aug 2019 02:19:32 GMT\r\n< Content-Length: 20\r\n< \r\n{\"repositories\":[]}\r\n* Connection #0 to host helm.registry.zte.com left intact\r\n```\r\nIs there important something i miss for helm? Any suggestion about it? \r\n\r\nThanks in advance!\r\n", "closed_by": {"login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/6214/reactions", "total_count": 7, "+1": 7, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/6214/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/helm/helm/issues/10408", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/10408/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/10408/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/10408/events", "html_url": "https://github.com/helm/helm/pull/10408", "id": 1065794402, "node_id": "PR_kwDOApspmc4vHZhL", "number": 10408, "title": "Push to OCI insecure registry", "user": {"login": "pytimer", "id": 17105586, "node_id": "MDQ6VXNlcjE3MTA1NTg2", "avatar_url": "https://avatars.githubusercontent.com/u/17105586?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pytimer", "html_url": "https://github.com/pytimer", "followers_url": "https://api.github.com/users/pytimer/followers", "following_url": "https://api.github.com/users/pytimer/following{/other_user}", "gists_url": "https://api.github.com/users/pytimer/gists{/gist_id}", "starred_url": "https://api.github.com/users/pytimer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pytimer/subscriptions", "organizations_url": "https://api.github.com/users/pytimer/orgs", "repos_url": "https://api.github.com/users/pytimer/repos", "events_url": "https://api.github.com/users/pytimer/events{/privacy}", "received_events_url": "https://api.github.com/users/pytimer/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 678047234, "node_id": "MDU6TGFiZWw2NzgwNDcyMzQ=", "url": "https://api.github.com/repos/helm/helm/labels/size/M", "name": "size/M", "color": "eebb00", "default": false, "description": "Denotes a PR that changes 30-99 lines, ignoring generated files."}, {"id": 778134216, "node_id": "MDU6TGFiZWw3NzgxMzQyMTY=", "url": "https://api.github.com/repos/helm/helm/labels/needs-rebase", "name": "needs-rebase", "color": "BDBDBD", "default": false, "description": "Indicates a PR cannot be merged because it has merge conflicts with HEAD."}, {"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}, {"id": 2290444626, "node_id": "MDU6TGFiZWwyMjkwNDQ0NjI2", "url": "https://api.github.com/repos/helm/helm/labels/Stale", "name": "Stale", "color": "ededed", "default": false, "description": null}, {"id": 4580510630, "node_id": "LA_kwDOApspmc8AAAABEQULpg", "url": "https://api.github.com/repos/helm/helm/labels/oci", "name": "oci", "color": "006b75", "default": false, "description": "Related to Helm OCI feature"}, {"id": 5778767194, "node_id": "LA_kwDOApspmc8AAAABWHD9Wg", "url": "https://api.github.com/repos/helm/helm/labels/Has%20One%20Approval", "name": "Has One Approval", "color": "EEC660", "default": false, "description": "This PR has one approval. It still needs a second approval to be merged."}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 34, "created_at": "2021-11-29T09:20:42Z", "updated_at": "2024-09-12T15:47:00Z", "closed_at": "2024-09-12T15:47:00Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/helm/helm/pulls/10408", "html_url": "https://github.com/helm/helm/pull/10408", "diff_url": "https://github.com/helm/helm/pull/10408.diff", "patch_url": "https://github.com/helm/helm/pull/10408.patch", "merged_at": null}, "body": "<!--  Thanks for sending a pull request!  Here are some tips for you:\r\n1. Make sure to read the Contributing Guide before submitting your PR: https://github.com/helm/helm/blob/main/CONTRIBUTING.md\r\n2. If this PR closes another issue, add 'closes #<issue number>' somewhere in the PR summary. GitHub will automatically close that issue when this PR gets merged. Alternatively, adding 'refs #<issue number>' will not close the issue, but help provide the reviewer more context.-->\r\n\r\n**What this PR does / why we need it**:\r\n\r\nThis PR implement push chart to OCI registry, or pull chart from OCI registry.\r\n\r\nFixes: https://github.com/helm/helm/issues/6324\r\n\r\nUsage:\r\n\r\n```bash\r\n# push\r\n$ ./bin/helm push consul-3.9.5.tgz oci://docker.registry:30001/library --insecure-skip-tls-verify \r\n\r\n# pull\r\n$ ./bin/helm pull oci://docker.registry:30001/library/consul --version 3.9.5 --insecure-skip-tls-verify\r\n\r\n# install\r\n$ ./bin/helm install consul oci://docker.registry:30001/library/consul --version 3.9.5 --insecure-skip-tls-verify\r\n\r\n# upgrade\r\n$ ./bin/helm upgrade --install consul oci://docker.registry:30001/library/consul --version 3.9.6 --insecure-skip-tls-verify\r\n```\r\n\r\n**Special notes for your reviewer**:\r\n\r\n**If applicable**:\r\n- [ ] this PR contains documentation\r\n- [ ] this PR contains unit tests\r\n- [x] this PR has been tested for backwards compatibility\r\n", "closed_by": {"login": "joejulian", "id": 952828, "node_id": "MDQ6VXNlcjk1MjgyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/952828?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joejulian", "html_url": "https://github.com/joejulian", "followers_url": "https://api.github.com/users/joejulian/followers", "following_url": "https://api.github.com/users/joejulian/following{/other_user}", "gists_url": "https://api.github.com/users/joejulian/gists{/gist_id}", "starred_url": "https://api.github.com/users/joejulian/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joejulian/subscriptions", "organizations_url": "https://api.github.com/users/joejulian/orgs", "repos_url": "https://api.github.com/users/joejulian/repos", "events_url": "https://api.github.com/users/joejulian/events{/privacy}", "received_events_url": "https://api.github.com/users/joejulian/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/10408/reactions", "total_count": 19, "+1": 14, "-1": 0, "laugh": 1, "hooray": 1, "confused": 0, "heart": 2, "rocket": 1, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/10408/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/helm/helm/issues/5184", "repository_url": "https://api.github.com/repos/helm/helm", "labels_url": "https://api.github.com/repos/helm/helm/issues/5184/labels{/name}", "comments_url": "https://api.github.com/repos/helm/helm/issues/5184/comments", "events_url": "https://api.github.com/repos/helm/helm/issues/5184/events", "html_url": "https://github.com/helm/helm/issues/5184", "id": 400571360, "node_id": "MDU6SXNzdWU0MDA1NzEzNjA=", "number": 5184, "title": "Nested `null` values don't remove keys as expected", "user": {"login": "aeijdenberg", "id": 5984070, "node_id": "MDQ6VXNlcjU5ODQwNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/5984070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aeijdenberg", "html_url": "https://github.com/aeijdenberg", "followers_url": "https://api.github.com/users/aeijdenberg/followers", "following_url": "https://api.github.com/users/aeijdenberg/following{/other_user}", "gists_url": "https://api.github.com/users/aeijdenberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/aeijdenberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aeijdenberg/subscriptions", "organizations_url": "https://api.github.com/users/aeijdenberg/orgs", "repos_url": "https://api.github.com/users/aeijdenberg/repos", "events_url": "https://api.github.com/users/aeijdenberg/events{/privacy}", "received_events_url": "https://api.github.com/users/aeijdenberg/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 778135666, "node_id": "MDU6TGFiZWw3NzgxMzU2NjY=", "url": "https://api.github.com/repos/helm/helm/labels/bug", "name": "bug", "color": "e11d21", "default": true, "description": "Categorizes issue or PR as related to a bug."}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 48, "created_at": "2019-01-18T04:50:13Z", "updated_at": "2023-12-13T14:11:25Z", "closed_at": "2020-04-16T19:53:40Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "<https://github.com/helm/helm/pull/2648> allows for deletion of keys by setting `null` values in a `values.yaml` file. However it doesn't work for nested values, e.g.:\r\n\r\n```yaml\r\nweb:\r\n  livenessProbe:\r\n    httpGet: null\r\n    exec:\r\n      command:\r\n      - curl\r\n      - -f\r\n      - http://localhost:8080/api/v1/info\r\n```\r\n\r\nWill not remove `web.livenessProbe.httpGet` from the original values, rather it just overrides the value with `null` and prints the warning:\r\n\r\n```\r\n2019/01/18 11:30:07 Warning: Merging destination map for chart 'concourse'. Cannot overwrite table item 'httpGet', with non table value: map[path:/api/v1/info port:atc]\r\n```\r\n\r\nIronically, above is a small variant on the example given in the docs, which I'm pretty sure does not actually do what it claims to: <https://docs.helm.sh/chart_template_guide/#deleting-a-default-key>\r\n\r\nI suspect that since the template rendering doesn't seem to differentiate much between a null value and a value not being specified, that this warnings are being ignored and not having much effect.\r\n\r\nOutput of `helm version`:\r\n\r\n```\r\nClient: &version.Version{SemVer:\"v2.12.1\", GitCommit:\"02a47c7249b1fc6d8fd3b94e6b4babf9d818144e\", GitTreeState:\"clean\"}\r\nServer: &version.Version{SemVer:\"v2.12.1\", GitCommit:\"02a47c7249b1fc6d8fd3b94e6b4babf9d818144e\", GitTreeState:\"clean\"}\r\n```\r\n\r\nOutput of `kubectl version`:\r\n\r\n```\r\nClient Version: version.Info{Major:\"1\", Minor:\"13\", GitVersion:\"v1.13.1\", GitCommit:\"eec55b9ba98609a46fee712359c7b5b365bdd920\", GitTreeState:\"clean\", BuildDate:\"2018-12-13T10:39:04Z\", GoVersion:\"go1.11.2\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\nServer Version: version.Info{Major:\"1\", Minor:\"11+\", GitVersion:\"v1.11.5-eks-6bad6d\", GitCommit:\"6bad6d9c768dc0864dab48a11653aa53b5a47043\", GitTreeState:\"clean\", BuildDate:\"2018-12-06T23:13:14Z\", GoVersion:\"go1.10.3\", Compiler:\"gc\", Platform:\"linux/amd64\"}\r\n```\r\n\r\nCloud Provider/Platform (AKS, GKE, Minikube etc.): \r\n\r\nEKS\r\n\r\n\r\n", "closed_by": {"login": "technosophos", "id": 89193, "node_id": "MDQ6VXNlcjg5MTkz", "avatar_url": "https://avatars.githubusercontent.com/u/89193?v=4", "gravatar_id": "", "url": "https://api.github.com/users/technosophos", "html_url": "https://github.com/technosophos", "followers_url": "https://api.github.com/users/technosophos/followers", "following_url": "https://api.github.com/users/technosophos/following{/other_user}", "gists_url": "https://api.github.com/users/technosophos/gists{/gist_id}", "starred_url": "https://api.github.com/users/technosophos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/technosophos/subscriptions", "organizations_url": "https://api.github.com/users/technosophos/orgs", "repos_url": "https://api.github.com/users/technosophos/repos", "events_url": "https://api.github.com/users/technosophos/events{/privacy}", "received_events_url": "https://api.github.com/users/technosophos/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/helm/helm/issues/5184/reactions", "total_count": 20, "+1": 20, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/helm/helm/issues/5184/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}]}