{"d": [{"url": "https://api.github.com/repos/typeorm/typeorm/issues/9316", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/9316/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/9316/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/9316/events", "html_url": "https://github.com/typeorm/typeorm/issues/9316", "id": 1348578350, "node_id": "I_kwDOAyVBJc5QYawu", "number": 9316, "title": "typeorm findOneBy( { id: null or undefined } ) method return the first record on the table  !", "user": {"login": "haddadzineddine", "id": 35062242, "node_id": "MDQ6VXNlcjM1MDYyMjQy", "avatar_url": "https://avatars.githubusercontent.com/u/35062242?v=4", "gravatar_id": "", "url": "https://api.github.com/users/haddadzineddine", "html_url": "https://github.com/haddadzineddine", "followers_url": "https://api.github.com/users/haddadzineddine/followers", "following_url": "https://api.github.com/users/haddadzineddine/following{/other_user}", "gists_url": "https://api.github.com/users/haddadzineddine/gists{/gist_id}", "starred_url": "https://api.github.com/users/haddadzineddine/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/haddadzineddine/subscriptions", "organizations_url": "https://api.github.com/users/haddadzineddine/orgs", "repos_url": "https://api.github.com/users/haddadzineddine/repos", "events_url": "https://api.github.com/users/haddadzineddine/events{/privacy}", "received_events_url": "https://api.github.com/users/haddadzineddine/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [{"login": "naorpeled", "id": 6171622, "node_id": "MDQ6VXNlcjYxNzE2MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/6171622?v=4", "gravatar_id": "", "url": "https://api.github.com/users/naorpeled", "html_url": "https://github.com/naorpeled", "followers_url": "https://api.github.com/users/naorpeled/followers", "following_url": "https://api.github.com/users/naorpeled/following{/other_user}", "gists_url": "https://api.github.com/users/naorpeled/gists{/gist_id}", "starred_url": "https://api.github.com/users/naorpeled/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/naorpeled/subscriptions", "organizations_url": "https://api.github.com/users/naorpeled/orgs", "repos_url": "https://api.github.com/users/naorpeled/repos", "events_url": "https://api.github.com/users/naorpeled/events{/privacy}", "received_events_url": "https://api.github.com/users/naorpeled/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 104, "created_at": "2022-08-23T21:44:13Z", "updated_at": "2025-12-27T10:20:40Z", "closed_at": "2025-09-18T05:41:17Z", "assignee": {"login": "naorpeled", "id": 6171622, "node_id": "MDQ6VXNlcjYxNzE2MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/6171622?v=4", "gravatar_id": "", "url": "https://api.github.com/users/naorpeled", "html_url": "https://github.com/naorpeled", "followers_url": "https://api.github.com/users/naorpeled/followers", "following_url": "https://api.github.com/users/naorpeled/following{/other_user}", "gists_url": "https://api.github.com/users/naorpeled/gists{/gist_id}", "starred_url": "https://api.github.com/users/naorpeled/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/naorpeled/subscriptions", "organizations_url": "https://api.github.com/users/naorpeled/orgs", "repos_url": "https://api.github.com/users/naorpeled/repos", "events_url": "https://api.github.com/users/naorpeled/events{/privacy}", "received_events_url": "https://api.github.com/users/naorpeled/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Expected Behavior\r\n\r\nReturn `null`\r\n\r\n### Actual Behavior\r\n\r\nRetrieve the first record from users table !\r\n\r\nExample : \r\n\r\n```js\r\nconst user = await userRepository.findOneBy({\r\n            id: undefined //  or `null`\r\n        });\r\n\r\n/*  \r\n\r\nResult :\r\n\r\nUser {\r\n  id:,\r\n  username: ,\r\n  ....\r\n}\r\n\r\n*/\r\n```\r\n\r\n\r\n### Steps to Reproduce\r\n\r\n1. Create typeorm connection\r\n2. Create user entity and migrate it to the database\r\n3. Query the database using the user repository then call `findOneBy` method .\r\n\r\n### Relevant Database Driver(s)\r\n\r\n<!-- Put \"yes\" instead of \"no\" to your issue's relevant databases -->\r\n\r\n| DB Type           | Reproducible  |\r\n|-------------------| ---           |\r\n| `sqlite`          | yes            |\r\n\r\nFor other database drivers , i have no idea :)\r\n\r\n", "closed_by": {"login": "naorpeled", "id": 6171622, "node_id": "MDQ6VXNlcjYxNzE2MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/6171622?v=4", "gravatar_id": "", "url": "https://api.github.com/users/naorpeled", "html_url": "https://github.com/naorpeled", "followers_url": "https://api.github.com/users/naorpeled/followers", "following_url": "https://api.github.com/users/naorpeled/following{/other_user}", "gists_url": "https://api.github.com/users/naorpeled/gists{/gist_id}", "starred_url": "https://api.github.com/users/naorpeled/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/naorpeled/subscriptions", "organizations_url": "https://api.github.com/users/naorpeled/orgs", "repos_url": "https://api.github.com/users/naorpeled/repos", "events_url": "https://api.github.com/users/naorpeled/events{/privacy}", "received_events_url": "https://api.github.com/users/naorpeled/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/9316/reactions", "total_count": 81, "+1": 65, "-1": 0, "laugh": 0, "hooray": 0, "confused": 7, "heart": 0, "rocket": 0, "eyes": 9}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/9316/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/5676", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/5676/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/5676/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/5676/events", "html_url": "https://github.com/typeorm/typeorm/issues/5676", "id": 580691337, "node_id": "MDU6SXNzdWU1ODA2OTEzMzc=", "number": 5676, "title": "Entities no longer registered after Hot Reloading ", "user": {"login": "nealdyrkacz", "id": 7388789, "node_id": "MDQ6VXNlcjczODg3ODk=", "avatar_url": "https://avatars.githubusercontent.com/u/7388789?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nealdyrkacz", "html_url": "https://github.com/nealdyrkacz", "followers_url": "https://api.github.com/users/nealdyrkacz/followers", "following_url": "https://api.github.com/users/nealdyrkacz/following{/other_user}", "gists_url": "https://api.github.com/users/nealdyrkacz/gists{/gist_id}", "starred_url": "https://api.github.com/users/nealdyrkacz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nealdyrkacz/subscriptions", "organizations_url": "https://api.github.com/users/nealdyrkacz/orgs", "repos_url": "https://api.github.com/users/nealdyrkacz/repos", "events_url": "https://api.github.com/users/nealdyrkacz/events{/privacy}", "received_events_url": "https://api.github.com/users/nealdyrkacz/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 546735997, "node_id": "MDU6TGFiZWw1NDY3MzU5OTc=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/documentation", "name": "documentation", "color": "f9d0c4", "default": true, "description": null}, {"id": 9302551618, "node_id": "LA_kwDOAyVBJc8AAAACKnmsQg", "url": "https://api.github.com/repos/typeorm/typeorm/labels/stale", "name": "stale", "color": "ededed", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [{"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 71, "created_at": "2020-03-13T15:52:39Z", "updated_at": "2025-09-18T16:04:25Z", "closed_at": "2025-09-18T16:04:25Z", "assignee": {"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Note from @imnotjames \r\n\r\nI've edited the title.  The most common issue I've seen in this thread relates to the hot-reload feature used by development environments & serverless environments.\r\n\r\nWhat happens if that the registered entities are changed by the hot reload with new entities that are no longer registered even if they're similar.\r\n\r\nIf you believe your issue is unrelated to that, please open a new issue with details including a reproducible example.\r\n\r\n---\r\n\r\n**Issue type:**\r\n\r\n[ ] question\r\n[x ] bug report\r\n[ ] feature request\r\n[x ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[ ] `mongodb`\r\n[ ] `mssql`\r\n[ ] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[x ] `postgres`\r\n[ ] `cockroachdb`\r\n[ ] `sqlite`\r\n[ ] `sqljs`\r\n[ ] `react-native`\r\n[ ] `expo`\r\n\r\n**TypeORM version:**\r\n\r\n[ ] `latest`\r\n[ ] `@next`\r\n[x ] `0.2.24`\r\n\r\nBeen using v0.2.22 and my ormconfig.js is as follows\r\n```\r\nmodule.exports = {\r\n  type: 'postgres',\r\n  host: process.env.TYPEORM_HOST,\r\n  port: process.env.TYPEORM_PORT,\r\n  username: process.env.TYPEORM_USERNAME,\r\n  password: process.env.TYPEORM_PASSWORD,\r\n  database: process.env.TYPEORM_DATABASE,\r\n  synchronize: false,\r\n  logging: false,\r\n  entities: ['build/entity/*.js'],\r\n  migrations: ['build/migration/*.js'],\r\n  subscribers: ['build/subscriber/*.js'],\r\n  cli: {\r\n    entitiesDir: 'src/entity',\r\n    migrationsDir: 'src/migration',\r\n    subscribersDir: 'src/subscriber',\r\n  },\r\n};\r\n\r\n```\r\n\r\nwhich works fine,  but I updated to v0.2.24 and I'm getting \r\n\"No repository for \\\"<entity>\\\" was found. Looks like this entity is not registered in current \\\"default\\\" connection?\" when doing a simple query\r\n```await getConnection()\r\n        .getRepository(<Entity>)\r\n        .find({ where: { active: true } });\r\n```\r\n\r\nIs there a documentation I am missing?  ", "closed_by": {"login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/5676/reactions", "total_count": 14, "+1": 14, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/5676/timeline", "performed_via_github_app": null, "state_reason": "not_planned", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/2158", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/2158/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/2158/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/2158/events", "html_url": "https://github.com/typeorm/typeorm/issues/2158", "id": 323769880, "node_id": "MDU6SXNzdWUzMjM3Njk4ODA=", "number": 2158, "title": "browser: Can't resolve 'react-native-sqlite-storage'", "user": {"login": "arolson101", "id": 5304092, "node_id": "MDQ6VXNlcjUzMDQwOTI=", "avatar_url": "https://avatars.githubusercontent.com/u/5304092?v=4", "gravatar_id": "", "url": "https://api.github.com/users/arolson101", "html_url": "https://github.com/arolson101", "followers_url": "https://api.github.com/users/arolson101/followers", "following_url": "https://api.github.com/users/arolson101/following{/other_user}", "gists_url": "https://api.github.com/users/arolson101/gists{/gist_id}", "starred_url": "https://api.github.com/users/arolson101/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/arolson101/subscriptions", "organizations_url": "https://api.github.com/users/arolson101/orgs", "repos_url": "https://api.github.com/users/arolson101/repos", "events_url": "https://api.github.com/users/arolson101/events{/privacy}", "received_events_url": "https://api.github.com/users/arolson101/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 489019544, "node_id": "MDU6TGFiZWw0ODkwMTk1NDQ=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/needs%20more%20info", "name": "needs more info", "color": "bfd4f2", "default": false, "description": null}, {"id": 714292924, "node_id": "MDU6TGFiZWw3MTQyOTI5MjQ=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/comp:%20browser", "name": "comp: browser", "color": "1d76db", "default": false, "description": null}, {"id": 2389293992, "node_id": "MDU6TGFiZWwyMzg5MjkzOTky", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20sqljs", "name": "driver: sqljs", "color": "0052cc", "default": false, "description": ""}, {"id": 9302551618, "node_id": "LA_kwDOAyVBJc8AAAACKnmsQg", "url": "https://api.github.com/repos/typeorm/typeorm/labels/stale", "name": "stale", "color": "ededed", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [{"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 68, "created_at": "2018-05-16T20:14:25Z", "updated_at": "2025-09-18T18:13:29Z", "closed_at": "2025-09-18T18:13:29Z", "assignee": {"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Issue type:**\r\n\r\n[ ] question\r\n[x] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[ ] `mongodb`\r\n[ ] `mssql`\r\n[ ] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[ ] `postgres`\r\n[ ] `sqlite`\r\n[x] `sqljs`\r\n[x] `react-native`\r\n\r\n**TypeORM version:**\r\n\r\n[x] `latest`\r\n[ ] `@next`\r\n[ ] `0.x.x` (or put your version here)\r\n\r\n**Steps to reproduce or a small repository showing the problem:**\r\n\r\nI followed the steps to use typeorm in the browser, including making the webpack changes.  I end up with:\r\n\r\n```\r\n./node_modules/typeorm/browser/driver/react-native/ReactNativeDriver.js\r\nModule not found: Can't resolve 'react-native-sqlite-storage' in 'C:\\crap\\node_modules\\typeorm\\browser\\driver\\react-native'\r\n```\r\n", "closed_by": {"login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/2158/reactions", "total_count": 50, "+1": 50, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/2158/timeline", "performed_via_github_app": null, "state_reason": "not_planned", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/3427", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/3427/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/3427/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/3427/events", "html_url": "https://github.com/typeorm/typeorm/issues/3427", "id": 399643710, "node_id": "MDU6SXNzdWUzOTk2NDM3MTA=", "number": 3427, "title": "[serverless] Connection Reuse is broken in a Lambda environment", "user": {"login": "Wintereise", "id": 5137170, "node_id": "MDQ6VXNlcjUxMzcxNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/5137170?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Wintereise", "html_url": "https://github.com/Wintereise", "followers_url": "https://api.github.com/users/Wintereise/followers", "following_url": "https://api.github.com/users/Wintereise/following{/other_user}", "gists_url": "https://api.github.com/users/Wintereise/gists{/gist_id}", "starred_url": "https://api.github.com/users/Wintereise/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Wintereise/subscriptions", "organizations_url": "https://api.github.com/users/Wintereise/orgs", "repos_url": "https://api.github.com/users/Wintereise/repos", "events_url": "https://api.github.com/users/Wintereise/events{/privacy}", "received_events_url": "https://api.github.com/users/Wintereise/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 712054568, "node_id": "MDU6TGFiZWw3MTIwNTQ1Njg=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20postgres", "name": "driver: postgres", "color": "0052cc", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [{"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 59, "created_at": "2019-01-16T04:33:09Z", "updated_at": "2022-09-13T06:15:33Z", "closed_at": "2020-10-09T22:18:03Z", "assignee": {"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Issue type:**\r\n\r\n[ ] question\r\n[x] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[ ] `mongodb`\r\n[ ] `mssql`\r\n[ ] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[x] `postgres`\r\n[ ] `sqlite`\r\n[ ] `sqljs`\r\n[ ] `react-native`\r\n[ ] `expo`\r\n\r\n**TypeORM version:**\r\n\r\n[x] `latest`\r\n[ ] `@next`\r\n[ ] `0.x.x` (or put your version here)\r\n\r\n**Steps to reproduce or a small repository showing the problem:**\r\n\r\nI'm primarily expanding further on https://github.com/typeorm/typeorm/issues/2598#issue-345445322, the fixes described there are catastrophic in nature, because:\r\n\r\n1. They either involve closing connections without understanding that the lambda may not just be serving that one request.\r\n2. Full bootstrap of the connection a second time anyway (defeating the purpose of caching it in the first place)) and I believe this is something that should be addressed in core.\r\n3. Even the somewhat saner metadata rebuild causes problems (since it cannot be awaited and runs in parallel). This results in metadata lookups while queries are running (for another controller, perhaps) randomly start failing.\r\n\r\nThe issue is exactly as described, if we attempt to reuse connections in a lambda environment, the entity manager no longer seems to know anything about our entities.\r\n\r\nThe first request made completes successfully (and primes our connection manager to reuse the same connection). Subsequent requests quit with `RepositoryNotFoundError: No repository for \"TData\" was found. Looks like this entity is not registered in current \"default\" connection?`\r\n\r\nHere's a complete test case (with no external dependencies other than typeorm and uuid): https://gist.github.com/Wintereise/3d59a0414419b4ecca5137c20fc29622\r\n\r\nWhen the else block (line #22 onwards) is hit, all is well, things work fine. When the cached connection from `manager.get(\"default\")` is hit however, we can no longer run queries.\r\n\r\nIf it's needed, I can setup a project with `serverless-offline` for click-and-go testing.\r\n\r\n", "closed_by": {"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/3427/reactions", "total_count": 20, "+1": 20, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/3427/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/3890", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/3890/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/3890/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/3890/events", "html_url": "https://github.com/typeorm/typeorm/issues/3890", "id": 424662269, "node_id": "MDU6SXNzdWU0MjQ2NjIyNjk=", "number": 3890, "title": "Nested relations filtering doesn't work", "user": {"login": "trixden", "id": 4009399, "node_id": "MDQ6VXNlcjQwMDkzOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/4009399?v=4", "gravatar_id": "", "url": "https://api.github.com/users/trixden", "html_url": "https://github.com/trixden", "followers_url": "https://api.github.com/users/trixden/followers", "following_url": "https://api.github.com/users/trixden/following{/other_user}", "gists_url": "https://api.github.com/users/trixden/gists{/gist_id}", "starred_url": "https://api.github.com/users/trixden/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/trixden/subscriptions", "organizations_url": "https://api.github.com/users/trixden/orgs", "repos_url": "https://api.github.com/users/trixden/repos", "events_url": "https://api.github.com/users/trixden/events{/privacy}", "received_events_url": "https://api.github.com/users/trixden/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 1195651281, "node_id": "MDU6TGFiZWwxMTk1NjUxMjgx", "url": "https://api.github.com/repos/typeorm/typeorm/labels/comp:%20find%20options", "name": "comp: find options", "color": "5e69bc", "default": false, "description": ""}], "state": "closed", "locked": true, "assignees": [], "milestone": null, "comments": 56, "created_at": "2019-03-24T21:28:04Z", "updated_at": "2021-06-23T18:19:58Z", "closed_at": "2020-10-15T21:54:55Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Issue type:**\r\n\r\n[ ] question\r\n[x] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**TypeORM version:**\r\n\r\n[ ] `latest`\r\n[ ] `@next`\r\n[x] `0.2.15` (or put your version here)\r\n\r\n**Steps to reproduce or a small repository showing the problem:**\r\n\r\nI have 2 models\r\n\r\n*category.entity.ts*\r\n```typescript\r\n@Entity()\r\nexport class BlogCategoryEntity {\r\n  @PrimaryGeneratedColumn()\r\n  id: number;\r\n\r\n  @Index()\r\n  @Column({unique: true})\r\n  alias: string;\r\n\r\n  @Column()\r\n  title: string;\r\n\r\n  @OneToMany(type => BlogPostEntity, post => post.category)\r\n  posts: BlogPostEntity[]\r\n}\r\n```\r\n\r\n*post.entity.js*\r\n```typescript\r\n@Entity()\r\nexport class BlogPostEntity {\r\n  @PrimaryGeneratedColumn()\r\n  id: number;\r\n\r\n  @Index()\r\n  @Column({unique: true})\r\n  alias: string;\r\n\r\n  @Column()\r\n  title: string;\r\n\r\n  @Column('text')\r\n  description: string;\r\n\r\n  @Column({type: 'text', nullable: true})\r\n  text: string;\r\n\r\n  @Index()\r\n  @Column()\r\n  isPublished: boolean;\r\n\r\n  @Index()\r\n  @Column()\r\n  publishedAt: Date;\r\n\r\n  @Column()\r\n  categoryId: number;\r\n\r\n  @ManyToOne(type => BlogCategoryEntity, category => category.posts, {eager: true, nullable: false, onDelete: 'CASCADE'})\r\n  @JoinColumn()\r\n  category: BlogCategoryEntity;\r\n}\r\n```\r\n\r\nWhen i filter query by category_id, everything is ok:\r\n\r\n```typescript\r\nconst [rows, count] = await this.repository.findAndCount({\r\n  skip: query.skip,\r\n  take: query.take,\r\n  where: {\r\n    category: {\r\n      id: 1\r\n    }\r\n  }\r\n});\r\n```\r\n\r\nBut, filter works only by primary nested field. Filtering by other fields don't work:\r\n\r\n```typescript\r\nconst [rows, count] = await this.repository.findAndCount({\r\n  skip: query.skip,\r\n  take: query.take,\r\n  where: {\r\n    category: {\r\n      alias: 'test'\r\n    }\r\n  }\r\n});\r\n```\r\n\r\n```sql\r\nSELECT\r\n  \"BlogPostEntity\".\"id\" AS \"BlogPostEntity_id\",\r\n  \"BlogPostEntity\".\"alias\" AS \"BlogPostEntity_alias\",\r\n  \"BlogPostEntity\".\"title\" AS \"BlogPostEntity_title\",\r\n  \"BlogPostEntity\".\"description\" AS \"BlogPostEntity_description\",\r\n  \"BlogPostEntity\".\"text\" AS \"BlogPostEntity_text\",\r\n  \"BlogPostEntity\".\"isPublished\" AS \"BlogPostEntity_isPublished\",\r\n  \"BlogPostEntity\".\"publishedAt\" AS \"BlogPostEntity_publishedAt\",\r\n  \"BlogPostEntity\".\"categoryId\" AS \"BlogPostEntity_categoryId\",\r\n  \"BlogPostEntity_category\".\"id\" AS \"BlogPostEntity_category_id\",\r\n  \"BlogPostEntity_category\".\"alias\" AS \"BlogPostEntity_category_alias\",\r\n  \"BlogPostEntity_category\".\"title\" AS \"BlogPostEntity_category_title\"\r\nFROM \"blog_post_entity\" \"BlogPostEntity\"\r\nLEFT JOIN \"blog_category_entity\" \"BlogPostEntity_category\"\r\n  ON \"BlogPostEntity_category\".\"id\"=\"BlogPostEntity\".\"categoryId\"\r\nWHERE \"BlogPostEntity\".\"categoryId\" = ? -- PARAMETERS: [null]\r\n```\r\n\r\nAre there options to implement this?", "closed_by": {"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/3890/reactions", "total_count": 55, "+1": 49, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 6}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/3890/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/4742", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/4742/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/4742/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/4742/events", "html_url": "https://github.com/typeorm/typeorm/issues/4742", "id": 493066049, "node_id": "MDU6SXNzdWU0OTMwNjYwNDk=", "number": 4742, "title": "Skip and take doesn't work with join", "user": {"login": "salehmontazeran", "id": 19423357, "node_id": "MDQ6VXNlcjE5NDIzMzU3", "avatar_url": "https://avatars.githubusercontent.com/u/19423357?v=4", "gravatar_id": "", "url": "https://api.github.com/users/salehmontazeran", "html_url": "https://github.com/salehmontazeran", "followers_url": "https://api.github.com/users/salehmontazeran/followers", "following_url": "https://api.github.com/users/salehmontazeran/following{/other_user}", "gists_url": "https://api.github.com/users/salehmontazeran/gists{/gist_id}", "starred_url": "https://api.github.com/users/salehmontazeran/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/salehmontazeran/subscriptions", "organizations_url": "https://api.github.com/users/salehmontazeran/orgs", "repos_url": "https://api.github.com/users/salehmontazeran/repos", "events_url": "https://api.github.com/users/salehmontazeran/events{/privacy}", "received_events_url": "https://api.github.com/users/salehmontazeran/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 628504132, "node_id": "MDU6TGFiZWw2Mjg1MDQxMzI=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/comp:%20query%20builder", "name": "comp: query builder", "color": "1d76db", "default": false, "description": null}, {"id": 712054471, "node_id": "MDU6TGFiZWw3MTIwNTQ0NzE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20mysql", "name": "driver: mysql", "color": "0052cc", "default": false, "description": null}, {"id": 712054568, "node_id": "MDU6TGFiZWw3MTIwNTQ1Njg=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20postgres", "name": "driver: postgres", "color": "0052cc", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 54, "created_at": "2019-09-12T22:57:52Z", "updated_at": "2026-02-17T10:58:41Z", "closed_at": "2026-02-17T10:58:41Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Issue type:**\r\n\r\n[ ] question\r\n[x] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[ ] `mongodb`\r\n[ ] `mssql`\r\n[ ] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[x] `postgres`\r\n[ ] `cockroachdb`\r\n[ ] `sqlite`\r\n[ ] `sqljs`\r\n[ ] `react-native`\r\n[ ] `expo`\r\n\r\n**TypeORM version:**\r\n\r\n[ ] `latest`\r\n[ ] `@next`\r\n[x] `0.2.18` (or put your version here)\r\n\r\nHi\r\n\r\nI have 7 row in my table and it's my first query.\r\n#### First Query\r\n```typescript\r\nOrganization.find({\r\n                relations,\r\n                order: {\r\n                    createdAt: \"DESC\"\r\n                },\r\n                skip: pagination.skip,\r\n                take: pagination.take\r\n            });\r\n```\r\n### First test for First query\r\nIt's my query log for just one request (my resolver dosn't have any additional middleware)\r\nwith skip: 1 and take: 2\r\n\r\n```bash\r\nquery: SELECT DISTINCT \"distinctAlias\".\"Organization_id\" as \"ids_Organization_id\", \"distinctAlias\".\"Organization_createdAt\" FROM (SELECT \"Organization\".\"id\" AS \"Organization_id\", \"Organization\".\"createdAt\" AS \"Organization_createdAt\", \"Organization\".\"updatedAt\" AS \"Organization_updatedAt\", \"Organization\".\"name\" AS \"Organization_name\", \"Organization\".\"address\" AS \"Organization_address\", \"Organization\".\"location\" AS \"Organization_location\", \"Organization\".\"contact\" AS \"Organization_contact\", \"Organization\".\"universityId\" AS \"Organization_universityId\", \"Organization\".\"type\" AS \"Organization_type\", \"Organization__university\".\"id\" AS \"Organization__university_id\", \"Organization__university\".\"createdAt\" AS \"Organization__university_createdAt\", \"Organization__university\".\"updatedAt\" AS \"Organization__university_updatedAt\", \"Organization__university\".\"name\" AS \"Organization__university_name\", \"Organization__university\".\"address\" AS \"Organization__university_address\", \"Organization__university\".\"location\" AS \"Organization__university_location\", \"Organization__university\".\"contact\" AS \"Organization__university_contact\", \"Organization__university\".\"type\" AS \"Organization__university_type\", \"Organization__units\".\"id\" AS \"Organization__units_id\", \"Organization__units\".\"createdAt\" AS \"Organization__units_createdAt\", \"Organization__units\".\"updatedAt\" AS \"Organization__units_updatedAt\", \"Organization__units\".\"name\" AS \"Organization__units_name\", \"Organization__units\".\"address\" AS \"Organization__units_address\", \"Organization__units\".\"location\" AS \"Organization__units_location\", \"Organization__units\".\"contact\" AS \"Organization__units_contact\", \"Organization__units\".\"allowedWareGroupsIds\" AS \"Organization__units_allowedWareGroupsIds\", \"Organization__units\".\"organizationId\" AS \"Organization__units_organizationId\", \"Organization__units\".\"type\" AS \"Organization__units_type\" FROM \"site\" \"Organization\" LEFT JOIN \"site\" \"Organization__university\" ON \"Organization__university\".\"id\"=\"Organization\".\"universityId\"  LEFT JOIN \"site\" \"Organization__units\" ON \"Organization__units\".\"organizationId\"=\"Organization\".\"id\" WHERE  \"Organization\".\"type\" IN ($1)) \"distinctAlias\" ORDER BY \"distinctAlias\".\"Organization_createdAt\" DESC, \"Organization_id\" ASC LIMIT 2 OFFSET 1 -- PARAMETERS: [\"Organization\"]\r\nquery: SELECT \"Organization\".\"id\" AS \"Organization_id\", \"Organization\".\"createdAt\" AS \"Organization_createdAt\", \"Organization\".\"updatedAt\" AS \"Organization_updatedAt\", \"Organization\".\"name\" AS \"Organization_name\", \"Organization\".\"address\" AS \"Organization_address\", \"Organization\".\"location\" AS \"Organization_location\", \"Organization\".\"contact\" AS \"Organization_contact\", \"Organization\".\"universityId\" AS \"Organization_universityId\", \"Organization\".\"type\" AS \"Organization_type\", \"Organization__university\".\"id\" AS \"Organization__university_id\", \"Organization__university\".\"createdAt\" AS \"Organization__university_createdAt\", \"Organization__university\".\"updatedAt\" AS \"Organization__university_updatedAt\", \"Organization__university\".\"name\" AS \"Organization__university_name\", \"Organization__university\".\"address\" AS \"Organization__university_address\", \"Organization__university\".\"location\" AS \"Organization__university_location\", \"Organization__university\".\"contact\" AS \"Organization__university_contact\", \"Organization__university\".\"type\" AS \"Organization__university_type\", \"Organization__units\".\"id\" AS \"Organization__units_id\", \"Organization__units\".\"createdAt\" AS \"Organization__units_createdAt\", \"Organization__units\".\"updatedAt\" AS \"Organization__units_updatedAt\", \"Organization__units\".\"name\" AS \"Organization__units_name\", \"Organization__units\".\"address\" AS \"Organization__units_address\", \"Organization__units\".\"location\" AS \"Organization__units_location\", \"Organization__units\".\"contact\" AS \"Organization__units_contact\", \"Organization__units\".\"allowedWareGroupsIds\" AS \"Organization__units_allowedWareGroupsIds\", \"Organization__units\".\"organizationId\" AS \"Organization__units_organizationId\", \"Organization__units\".\"type\" AS \"Organization__units_type\" FROM \"site\" \"Organization\" LEFT JOIN \"site\" \"Organization__university\" ON \"Organization__university\".\"id\"=\"Organization\".\"universityId\"  LEFT JOIN \"site\" \"Organization__units\" ON \"Organization__units\".\"organizationId\"=\"Organization\".\"id\" WHERE  \"Organization\".\"type\" IN ($1) ORDER BY \"Organization\".\"createdAt\" DESC -- PARAMETERS: [\"Organization\"]\r\n```\r\nbut i got my whole 7 rows and it seem two query executed!!! \r\nIn above query log, in first log LIMIT and OFFSET clause exist but in the second query they don't exist.\r\n\r\n### Second test for First query\r\nIt's my second log for skip: 7 and take: 2\r\n\r\n```bash\r\nquery: SELECT DISTINCT \"distinctAlias\".\"Organization_id\" as \"ids_Organization_id\", \"distinctAlias\".\"Organization_createdAt\" FROM (SELECT \"Organization\".\"id\" AS \"Organization_id\", \"Organization\".\"createdAt\" AS \"Organization_createdAt\", \"Organization\".\"updatedAt\" AS \"Organization_updatedAt\", \"Organization\".\"name\" AS \"Organization_name\", \"Organization\".\"address\" AS \"Organization_address\", \"Organization\".\"location\" AS \"Organization_location\", \"Organization\".\"contact\" AS \"Organization_contact\", \"Organization\".\"universityId\" AS \"Organization_universityId\", \"Organization\".\"type\" AS \"Organization_type\", \"Organization__university\".\"id\" AS \"Organization__university_id\", \"Organization__university\".\"createdAt\" AS \"Organization__university_createdAt\", \"Organization__university\".\"updatedAt\" AS \"Organization__university_updatedAt\", \"Organization__university\".\"name\" AS \"Organization__university_name\", \"Organization__university\".\"address\" AS \"Organization__university_address\", \"Organization__university\".\"location\" AS \"Organization__university_location\", \"Organization__university\".\"contact\" AS \"Organization__university_contact\", \"Organization__university\".\"type\" AS \"Organization__university_type\", \"Organization__units\".\"id\" AS \"Organization__units_id\", \"Organization__units\".\"createdAt\" AS \"Organization__units_createdAt\", \"Organization__units\".\"updatedAt\" AS \"Organization__units_updatedAt\", \"Organization__units\".\"name\" AS \"Organization__units_name\", \"Organization__units\".\"address\" AS \"Organization__units_address\", \"Organization__units\".\"location\" AS \"Organization__units_location\", \"Organization__units\".\"contact\" AS \"Organization__units_contact\", \"Organization__units\".\"allowedWareGroupsIds\" AS \"Organization__units_allowedWareGroupsIds\", \"Organization__units\".\"organizationId\" AS \"Organization__units_organizationId\", \"Organization__units\".\"type\" AS \"Organization__units_type\" FROM \"site\" \"Organization\" LEFT JOIN \"site\" \"Organization__university\" ON \"Organization__university\".\"id\"=\"Organization\".\"universityId\"  LEFT JOIN \"site\" \"Organization__units\" ON \"Organization__units\".\"organizationId\"=\"Organization\".\"id\" WHERE  \"Organization\".\"type\" IN ($1)) \"distinctAlias\" ORDER BY \"distinctAlias\".\"Organization_createdAt\" DESC, \"Organization_id\" ASC LIMIT 2 OFFSET 7 -- PARAMETERS: [\"Organization\"]\r\n```\r\nAs i expected, result was empty and just one query executed (i have just 7 row in my table)\r\nLIMIT and OFFSET clause exist in query log.\r\n\r\n\r\n### Second Query\r\nI changed my query to just retrieve rows without any join (relations).\r\n```typescript\r\nOrganization.find({\r\n                order: {\r\n                    createdAt: \"DESC\"\r\n                },\r\n                skip: pagination.skip,\r\n                take: pagination.take\r\n            });\r\n```\r\n### First test for Second query\r\nIt's my log with skip: 1 and take: 2\r\n```bash\r\nquery: SELECT \"Organization\".\"id\" AS \"Organization_id\", \"Organization\".\"createdAt\" AS \"Organization_createdAt\", \"Organization\".\"updatedAt\" AS \"Organization_updatedAt\", \"Organization\".\"name\" AS \"Organization_name\", \"Organization\".\"address\" AS \"Organization_address\", \"Organization\".\"location\" AS \"Organization_location\", \"Organization\".\"contact\" AS \"Organization_contact\", \"Organization\".\"universityId\" AS \"Organization_universityId\", \"Organization\".\"type\" AS \"Organization_type\" FROM \"site\" \"Organization\" WHERE  \"Organization\".\"type\" IN ($1) ORDER BY \"Organization\".\"createdAt\" DESC LIMIT 2 OFFSET 1 -- PARAMETERS: [\"Organization\"]\r\n```\r\nEverything works properly and i got expected rows.\r\n\r\n### Conclusion\r\nI can only say it's strange behavior.\r\n", "closed_by": {"login": "gioboa", "id": 35845425, "node_id": "MDQ6VXNlcjM1ODQ1NDI1", "avatar_url": "https://avatars.githubusercontent.com/u/35845425?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gioboa", "html_url": "https://github.com/gioboa", "followers_url": "https://api.github.com/users/gioboa/followers", "following_url": "https://api.github.com/users/gioboa/following{/other_user}", "gists_url": "https://api.github.com/users/gioboa/gists{/gist_id}", "starred_url": "https://api.github.com/users/gioboa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gioboa/subscriptions", "organizations_url": "https://api.github.com/users/gioboa/orgs", "repos_url": "https://api.github.com/users/gioboa/repos", "events_url": "https://api.github.com/users/gioboa/events{/privacy}", "received_events_url": "https://api.github.com/users/gioboa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/4742/reactions", "total_count": 38, "+1": 36, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 2}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/4742/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/8810", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/8810/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/8810/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/8810/events", "html_url": "https://github.com/typeorm/typeorm/issues/8810", "id": 1182025313, "node_id": "I_kwDOAyVBJc5GdEZh", "number": 8810, "title": "Generating migrations with cli", "user": {"login": "SleeveShirtholes", "id": 34148154, "node_id": "MDQ6VXNlcjM0MTQ4MTU0", "avatar_url": "https://avatars.githubusercontent.com/u/34148154?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SleeveShirtholes", "html_url": "https://github.com/SleeveShirtholes", "followers_url": "https://api.github.com/users/SleeveShirtholes/followers", "following_url": "https://api.github.com/users/SleeveShirtholes/following{/other_user}", "gists_url": "https://api.github.com/users/SleeveShirtholes/gists{/gist_id}", "starred_url": "https://api.github.com/users/SleeveShirtholes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SleeveShirtholes/subscriptions", "organizations_url": "https://api.github.com/users/SleeveShirtholes/orgs", "repos_url": "https://api.github.com/users/SleeveShirtholes/repos", "events_url": "https://api.github.com/users/SleeveShirtholes/events{/privacy}", "received_events_url": "https://api.github.com/users/SleeveShirtholes/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 2454823078, "node_id": "MDU6TGFiZWwyNDU0ODIzMDc4", "url": "https://api.github.com/repos/typeorm/typeorm/labels/requires%20triage", "name": "requires triage", "color": "f9aeb0", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 52, "created_at": "2022-03-26T19:53:08Z", "updated_at": "2023-10-03T21:35:01Z", "closed_at": "2023-08-19T15:39:18Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "<!--\r\n  Please follow the template.  If you don't, your issue may be closed.\r\n\r\n  Have a question?  This is the TypeORM issue tracker - and not the right place\r\n  for general support or questions.  Instead, check the \"Support\" Documentation\r\n  on the best places to ask questions!\r\n\r\n  https://github.com/typeorm/typeorm/blob/master/docs/support.md\r\n-->\r\n\r\n## Issue Description\r\n\r\n### Expected Behavior\r\n\r\nMigrations get generated using the cli\r\n\r\n### Actual Behavior\r\n\r\nI am following the documentation outlined here https://typeorm.io/migrations and I feel like the documentation is way different then what is actually happening in the cli. I have tried just running the following command:\r\n\r\n`typeorm migration:generate -n PostRefactoring`\r\n\r\nWhen I run this command I get the following:\r\n\r\n`Not enough non-option arguments: got 0, need at least 1`\r\n\r\nSo then I modify the command to something like this:\r\n\r\n`Missing required argument: dataSource`\r\n\r\nSo then from there I add the datasource since that is what it is asking for:\r\n\r\n`npx typeorm migration:generate test -d app-data-source.ts` (I found the -d somewhere online  while investigating this issue)\r\n\r\nBut once I run that command I get the following error:\r\n\r\n`File must contain a TypeScript / JavaScript code and export a DataSource instance.`\r\n\r\nI have been trying to get this to work for days and I am about ready to throw the towl in and use a different ORM...which I don't want to do. I know that everything is working fine because I can start up the app and the app connects to the database and creates rows in the database. So it is just something with the cli and trying to generate the migrations.\r\n\r\nHere is what is in my app-data-source.ts file:\r\n\r\n```\r\nimport { DataSource } from \"typeorm\";\r\nimport { User } from \"./entitiy/User\";\r\n\r\nconst myDataSource = new DataSource({\r\n  type: \"postgres\",\r\n  host: \"localhost\",\r\n  port: 5432,\r\n  username: \"postgres\",\r\n  password: \"\",\r\n  database: \"postgres\",\r\n  entities: [User],\r\n  migrations: [\"/migrations/\"],\r\n  logging: true,\r\n  synchronize: true,\r\n});\r\n\r\n\r\nexport default myDataSource;\r\n```\r\n\r\nThis is the contents of my app.ts file:\r\n\r\n```\r\nimport * as express from \"express\";\r\nimport { Request, Response } from \"express\";\r\nimport myDataSource from \"./app-data-source\";\r\nimport { User } from \"./entitiy/User\";\r\n\r\n// establish database connection\r\nmyDataSource\r\n  .initialize()\r\n  .then(() => {\r\n    console.log(\"Data Source has been initialized!\");\r\n  })\r\n  .catch((err) => {\r\n    console.error(\"Error during Data Source initialization:\", err);\r\n  });\r\n\r\n// create and setup express app\r\nconst app = express();\r\napp.use(express.json());\r\n\r\n// register routes\r\napp.get(\"/users\", async function (req: Request, res: Response) {\r\n  const users = await myDataSource.getRepository(User).find();\r\n  res.json(users);\r\n});\r\n\r\napp.get(\"/users/:id\", async function (req: Request, res: Response) {\r\n  const results = await myDataSource.getRepository(User).findOneBy({\r\n    id: +req.params.id,\r\n  });\r\n  return res.send(results);\r\n});\r\n\r\napp.post(\"/users\", async function (req: Request, res: Response) {\r\n  const user = await myDataSource.getRepository(User).create(req.body);\r\n  const results = await myDataSource.getRepository(User).save(user);\r\n  return res.send(results);\r\n});\r\n\r\napp.put(\"/users/:id\", async function (req: Request, res: Response) {\r\n  const user = await myDataSource.getRepository(User).findOneBy({\r\n    id: +req.params.id,\r\n  });\r\n  myDataSource.getRepository(User).merge(user, req.body);\r\n  const results = await myDataSource.getRepository(User).save(user);\r\n  return res.send(results);\r\n});\r\n\r\napp.delete(\"/users/:id\", async function (req: Request, res: Response) {\r\n  const results = await myDataSource.getRepository(User).delete(req.params.id);\r\n  return res.send(results);\r\n});\r\n\r\n// start express server\r\napp.listen(3000);\r\n```\r\n\r\nAll these files were setup using the instructions outlined in the express typeorm documentation:\r\n[Example with Express](https://typeorm.io/example-with-express)\r\n\r\nWhich BTW, this also has issues and doesn't run from what is outlined in the directions. I had to make some modifications to actually make the app run compared to what is outlined in that guide. One of the changes I made in the data source file was putting the actual Entity name in the entity property of the datasource compared to the guide that has you put the path in.\r\n\r\nAnyway, am I crazy...am I doing something wrong? You guys might not have enough information to answer the first question but can you at least help with trying to figure out how to make the migrations work?\r\n\r\n### Steps to Reproduce\r\n\r\nSet up you app using the guide outlined above to use express\r\n\r\n### My Environment\r\n\r\n| Dependency          | Version  |\r\n| ---                 | ---      |\r\n| Operating System    |  MAC OS Monterrey         |\r\n| Node.js version     | v16.14.2  | <!-- run `node -v` to obtain this -->\r\n| Typescript version  | 4.5.2  | <!-- run `npm list typescript` to obtain this -->\r\n| TypeORM version     | 0.3.4  | <!-- run `npm list typeorm` to obtain this -->\r\n\r\n### Relevant Database Driver(s)\r\n\r\n<!-- Put \"yes\" instead of \"no\" to your issue's relevant databases -->\r\n\r\n| DB Type           | Reproducible  |\r\n|-------------------| ---           |\r\n| `aurora-mysql`    | no            |\r\n| `aurora-postgres` | no            |\r\n| `better-sqlite3`  | no            |\r\n| `cockroachdb`     | no            |\r\n| `cordova`         | no            |\r\n| `expo`            | no            |\r\n| `mongodb`         | no            |\r\n| `mysql`           | no            |\r\n| `nativescript`    | no            |\r\n| `oracle`          | no            |\r\n| `postgres`        | yes            |\r\n| `react-native`    | no            |\r\n| `sap`             | no            |\r\n| `sqlite`          | no            |\r\n| `sqlite-abstract` | no            |\r\n| `sqljs`           | no            |\r\n| `sqlserver`       | no            |\r\n\r\n\r\n### Are you willing to resolve this issue by submitting a Pull Request?\r\n\r\n<!-- Put \"\u2705\" (:white_check_mark:) to one of these options, left \"\u2716\ufe0f\" (:heavy_multiplication_x:) others: -->\r\n\r\n - \u2716\ufe0f Yes, I have the time, and I know how to start.\r\n - \u2716\ufe0f Yes, I have the time, but I don't know how to start. I would need guidance.\r\n - \u2716\ufe0f No, I don\u2019t have the time, but I can support (using donations) development.\r\n - \u2705 No, I don\u2019t have the time and I\u2019m okay to wait for the community / maintainers to resolve this issue.\r\n\r\n\r\n<!--\r\n  Remember that first-time contributors are welcome! \ud83d\ude4c\r\n  \ud83d\udc4b Have a great day and thank you for the bug report!\r\n-->\r\n", "closed_by": {"login": "pleerock", "id": 1753397, "node_id": "MDQ6VXNlcjE3NTMzOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1753397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pleerock", "html_url": "https://github.com/pleerock", "followers_url": "https://api.github.com/users/pleerock/followers", "following_url": "https://api.github.com/users/pleerock/following{/other_user}", "gists_url": "https://api.github.com/users/pleerock/gists{/gist_id}", "starred_url": "https://api.github.com/users/pleerock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pleerock/subscriptions", "organizations_url": "https://api.github.com/users/pleerock/orgs", "repos_url": "https://api.github.com/users/pleerock/repos", "events_url": "https://api.github.com/users/pleerock/events{/privacy}", "received_events_url": "https://api.github.com/users/pleerock/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/8810/reactions", "total_count": 41, "+1": 41, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/8810/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/4270", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/4270/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/4270/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/4270/events", "html_url": "https://github.com/typeorm/typeorm/issues/4270", "id": 454634846, "node_id": "MDU6SXNzdWU0NTQ2MzQ4NDY=", "number": 4270, "title": "TypeError: Cannot read property 'databaseName' of undefined", "user": {"login": "v1d3rm3", "id": 16581931, "node_id": "MDQ6VXNlcjE2NTgxOTMx", "avatar_url": "https://avatars.githubusercontent.com/u/16581931?v=4", "gravatar_id": "", "url": "https://api.github.com/users/v1d3rm3", "html_url": "https://github.com/v1d3rm3", "followers_url": "https://api.github.com/users/v1d3rm3/followers", "following_url": "https://api.github.com/users/v1d3rm3/following{/other_user}", "gists_url": "https://api.github.com/users/v1d3rm3/gists{/gist_id}", "starred_url": "https://api.github.com/users/v1d3rm3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/v1d3rm3/subscriptions", "organizations_url": "https://api.github.com/users/v1d3rm3/orgs", "repos_url": "https://api.github.com/users/v1d3rm3/repos", "events_url": "https://api.github.com/users/v1d3rm3/events{/privacy}", "received_events_url": "https://api.github.com/users/v1d3rm3/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 712055178, "node_id": "MDU6TGFiZWw3MTIwNTUxNzg=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20mssql", "name": "driver: mssql", "color": "0052cc", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [{"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 44, "created_at": "2019-06-11T11:29:55Z", "updated_at": "2026-01-21T19:19:18Z", "closed_at": "2026-01-21T19:19:18Z", "assignee": {"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Issue type:**\r\n[x] bug report\r\n\r\n**Database system/driver:**\r\n[x] `mssql`\r\n\r\n**TypeORM version:**\r\n[x] `latest`\r\n\r\n**Steps to reproduce or a small repository showing the problem:**\r\n\r\nHere is a repo with the bug:\r\nhttps://github.com/victorschinaider/typeorm-bug\r\n\r\nI think `pagination`+ `embedded orderBy`+ `subquery` + `leftJoinAndSelect` combination is giving me the problem.", "closed_by": {"login": "gioboa", "id": 35845425, "node_id": "MDQ6VXNlcjM1ODQ1NDI1", "avatar_url": "https://avatars.githubusercontent.com/u/35845425?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gioboa", "html_url": "https://github.com/gioboa", "followers_url": "https://api.github.com/users/gioboa/followers", "following_url": "https://api.github.com/users/gioboa/following{/other_user}", "gists_url": "https://api.github.com/users/gioboa/gists{/gist_id}", "starred_url": "https://api.github.com/users/gioboa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gioboa/subscriptions", "organizations_url": "https://api.github.com/users/gioboa/orgs", "repos_url": "https://api.github.com/users/gioboa/repos", "events_url": "https://api.github.com/users/gioboa/events{/privacy}", "received_events_url": "https://api.github.com/users/gioboa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/4270/reactions", "total_count": 30, "+1": 30, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/4270/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/2415", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/2415/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/2415/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/2415/events", "html_url": "https://github.com/typeorm/typeorm/issues/2415", "id": 336090418, "node_id": "MDU6SXNzdWUzMzYwOTA0MTg=", "number": 2415, "title": "DeleteResult / UpdateResult not implemented for all Drivers", "user": {"login": "marko-asplund", "id": 1002541, "node_id": "MDQ6VXNlcjEwMDI1NDE=", "avatar_url": "https://avatars.githubusercontent.com/u/1002541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marko-asplund", "html_url": "https://github.com/marko-asplund", "followers_url": "https://api.github.com/users/marko-asplund/followers", "following_url": "https://api.github.com/users/marko-asplund/following{/other_user}", "gists_url": "https://api.github.com/users/marko-asplund/gists{/gist_id}", "starred_url": "https://api.github.com/users/marko-asplund/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marko-asplund/subscriptions", "organizations_url": "https://api.github.com/users/marko-asplund/orgs", "repos_url": "https://api.github.com/users/marko-asplund/repos", "events_url": "https://api.github.com/users/marko-asplund/events{/privacy}", "received_events_url": "https://api.github.com/users/marko-asplund/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 364554717, "node_id": "MDU6TGFiZWwzNjQ1NTQ3MTc=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/new%20feature", "name": "new feature", "color": "fbca04", "default": false, "description": null}, {"id": 712054568, "node_id": "MDU6TGFiZWw3MTIwNTQ1Njg=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20postgres", "name": "driver: postgres", "color": "0052cc", "default": false, "description": null}, {"id": 712054782, "node_id": "MDU6TGFiZWw3MTIwNTQ3ODI=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20mongodb", "name": "driver: mongodb", "color": "0052cc", "default": false, "description": null}, {"id": 712055300, "node_id": "MDU6TGFiZWw3MTIwNTUzMDA=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20oracle", "name": "driver: oracle", "color": "0052cc", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 41, "created_at": "2018-06-27T06:16:09Z", "updated_at": "2024-02-12T16:50:16Z", "closed_at": "2021-07-11T00:49:06Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Issue type:**\r\n\r\n[ ] question\r\n[x] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[ ] `mongodb`\r\n[ ] `mssql`\r\n[ ] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[x] `postgres`\r\n[ ] `sqlite`\r\n[ ] `sqljs`\r\n[ ] `react-native`\r\n\r\n**TypeORM version:**\r\n\r\n[ ] `latest`\r\n[ ] `@next`\r\n[x] `0.2.7` (or put your version here)\r\n\r\n**Steps to reproduce or a small repository showing the problem:**\r\n1. invoke `Repository.delete`\r\n2. the returned `DeleteResult` does not include any info at all. Expecting to include the number of affected rows.\r\n\r\nI'm having trouble with `Repository.delete`: the operation successfully removes the entity from the database, but `DeleteResult` does not contain count of entities deleted, it's just `DeleteResult { raw: [] }`. This occurs with v0.2.7.\r\n\r\nAlso, there doesn't appear to be a tag for version 0.2.7 on GitHub though there's a release on npmjs. Why is that?\r\n\r\nWhy doesn't `DeleteResult` specify a property for the number of rows affected?", "closed_by": {"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/2415/reactions", "total_count": 21, "+1": 16, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 2, "rocket": 3, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/2415/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/4090", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/4090/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/4090/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/4090/events", "html_url": "https://github.com/typeorm/typeorm/issues/4090", "id": 440480750, "node_id": "MDU6SXNzdWU0NDA0ODA3NTA=", "number": 4090, "title": "Repository save doesn't return autogenerated columns ", "user": {"login": "daniildxb", "id": 15066286, "node_id": "MDQ6VXNlcjE1MDY2Mjg2", "avatar_url": "https://avatars.githubusercontent.com/u/15066286?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daniildxb", "html_url": "https://github.com/daniildxb", "followers_url": "https://api.github.com/users/daniildxb/followers", "following_url": "https://api.github.com/users/daniildxb/following{/other_user}", "gists_url": "https://api.github.com/users/daniildxb/gists{/gist_id}", "starred_url": "https://api.github.com/users/daniildxb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daniildxb/subscriptions", "organizations_url": "https://api.github.com/users/daniildxb/orgs", "repos_url": "https://api.github.com/users/daniildxb/repos", "events_url": "https://api.github.com/users/daniildxb/events{/privacy}", "received_events_url": "https://api.github.com/users/daniildxb/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 712054568, "node_id": "MDU6TGFiZWw3MTIwNTQ1Njg=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20postgres", "name": "driver: postgres", "color": "0052cc", "default": false, "description": null}, {"id": 1179464035, "node_id": "MDU6TGFiZWwxMTc5NDY0MDM1", "url": "https://api.github.com/repos/typeorm/typeorm/labels/needs%20tests", "name": "needs tests", "color": "8ccdd8", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 38, "created_at": "2019-05-05T19:30:27Z", "updated_at": "2025-12-03T10:11:56Z", "closed_at": "2021-02-06T07:17:34Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Issue type:**\r\n\r\n[ ] question\r\n[x] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[ ] `mongodb`\r\n[ ] `mssql`\r\n[ ] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[x] `postgres`\r\n[ ] `cockroachdb`\r\n[ ] `sqlite`\r\n[ ] `sqljs`\r\n[ ] `react-native`\r\n[ ] `expo`\r\n\r\n**TypeORM version:**\r\n\r\n[ ] `latest`\r\n[x] `@next`\r\n[ ] `0.x.x` (or put your version here)\r\n\r\nHi, I've noticed that Repository.save doesn't return several of auto-generated field\r\n\r\nModel Route.ts\r\n```ts\r\n@Entity({ name: 'routes' })\r\nexport class Route {\r\n  @PrimaryGeneratedColumn()\r\n  public id!: number;\r\n\r\n  @Column({ nullable: true })\r\n  public name!: string;\r\n\r\n  @Column({ nullable: true })\r\n  public description!: string;\r\n\r\n  @Column({ nullable: true })\r\n  public distance!: number;\r\n\r\n  @Column({\r\n    default: 'inactive',\r\n    enum: ['active', 'not active', 'testing', 'checking'],\r\n  })\r\n  public status!: string;\r\n\r\n  @Column({ nullable: true })\r\n  public zoom!: number;\r\n\r\n  @Column({ nullable: true, type: 'decimal' })\r\n  public latitude!: number;\r\n\r\n  @Column({ nullable: true, type: 'decimal' })\r\n  public longitude!: number;\r\n\r\n  @CreateDateColumn({ name: 'created_at' })\r\n  public createdAt!: Date;\r\n\r\n  @UpdateDateColumn({ name: 'updated_at' })\r\n  public updatedAt!: Date;\r\n\r\n  @OneToMany(type => RouteLeg, routeLeg => routeLeg.route, { cascade: true })\r\n  public legs!: RouteLeg[];\r\n\r\n  @ManyToOne(type => Route, route => route.id)\r\n  @JoinColumn({ name: 'source_id' })\r\n  public source!: Route;\r\n}\r\n```\r\nMethod call\r\n```getRepository(Route).save(_);```\r\n\r\nFor some reason `id` and `createdAt` are not returned while `updatedAt` is value is returned\r\n\r\n\r\n", "closed_by": {"login": "pleerock", "id": 1753397, "node_id": "MDQ6VXNlcjE3NTMzOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1753397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pleerock", "html_url": "https://github.com/pleerock", "followers_url": "https://api.github.com/users/pleerock/followers", "following_url": "https://api.github.com/users/pleerock/following{/other_user}", "gists_url": "https://api.github.com/users/pleerock/gists{/gist_id}", "starred_url": "https://api.github.com/users/pleerock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pleerock/subscriptions", "organizations_url": "https://api.github.com/users/pleerock/orgs", "repos_url": "https://api.github.com/users/pleerock/repos", "events_url": "https://api.github.com/users/pleerock/events{/privacy}", "received_events_url": "https://api.github.com/users/pleerock/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/4090/reactions", "total_count": 30, "+1": 28, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 1, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/4090/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/10638", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/10638/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/10638/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/10638/events", "html_url": "https://github.com/typeorm/typeorm/issues/10638", "id": 2086165962, "node_id": "I_kwDOAyVBJc58WF3K", "number": 10638, "title": "Bug with @VirtualColumn not being returned correctly", "user": {"login": "macleysousa", "id": 17185046, "node_id": "MDQ6VXNlcjE3MTg1MDQ2", "avatar_url": "https://avatars.githubusercontent.com/u/17185046?v=4", "gravatar_id": "", "url": "https://api.github.com/users/macleysousa", "html_url": "https://github.com/macleysousa", "followers_url": "https://api.github.com/users/macleysousa/followers", "following_url": "https://api.github.com/users/macleysousa/following{/other_user}", "gists_url": "https://api.github.com/users/macleysousa/gists{/gist_id}", "starred_url": "https://api.github.com/users/macleysousa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/macleysousa/subscriptions", "organizations_url": "https://api.github.com/users/macleysousa/orgs", "repos_url": "https://api.github.com/users/macleysousa/repos", "events_url": "https://api.github.com/users/macleysousa/events{/privacy}", "received_events_url": "https://api.github.com/users/macleysousa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 712054568, "node_id": "MDU6TGFiZWw3MTIwNTQ1Njg=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20postgres", "name": "driver: postgres", "color": "0052cc", "default": false, "description": null}, {"id": 2454823078, "node_id": "MDU6TGFiZWwyNDU0ODIzMDc4", "url": "https://api.github.com/repos/typeorm/typeorm/labels/requires%20triage", "name": "requires triage", "color": "f9aeb0", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 37, "created_at": "2024-01-17T13:12:03Z", "updated_at": "2025-03-30T23:34:37Z", "closed_at": "2025-03-30T23:34:35Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Issue description\n\n@VirtualColumn not being returned correctly\n\n### Expected Behavior\n\n``` js\r\n@Entity({ name: 'integrations' })\r\nexport class IntegrationEntity {\r\n  @Exclude()\r\n  @PrimaryGeneratedColumn('uuid')\r\n  id: string;\r\n\r\n  @ApiProperty()\r\n  @PrimaryColumn({ name: 'client_id', type: 'uuid' })\r\n  client_id: string;\r\n\r\n  @ApiProperty()\r\n  @VirtualColumn({ query: (alias) => `select \"DMS\" from config_client where \"client_id\"=${alias}.client_id` })\r\n  dms: string;\r\n}\r\n\r\n```\r\n\r\nIt was expected that @VirtualColumn would return the correct values according to the logic defined in the decorator.\r\n\r\n``` json\r\n{\r\n  \"client_id\": \"1b97a2d2-91b8-4dab-9593-906da6d95d36\",\r\n  \"dms\": \"NBS\"\r\n}\r\n```\n\n### Actual Behavior\n\n``` js\r\n@Entity({ name: 'integrations' })\r\nexport class IntegrationEntity {\r\n  @Exclude()\r\n  @PrimaryGeneratedColumn('uuid')\r\n  id: string;\r\n\r\n  @ApiProperty()\r\n  @PrimaryColumn({ name: 'client_id', type: 'uuid' })\r\n  client_id: string;\r\n\r\n  @ApiProperty()\r\n  @VirtualColumn({ query: (alias) => `select \"DMS\" from config_client where \"client_id\"=${alias}.client_id` })\r\n  dms: string;\r\n}\r\n\r\n```\r\n\r\nDNS column is not being returned\r\n\r\n``` json\r\n{\r\n  \"client_id\": \"1b97a2d2-91b8-4dab-9593-906da6d95d36\"\r\n}\r\n```\n\n### Steps to reproduce\n\n1. Add the @VirtualColumn decorator to an entity or class.\r\n2. Define the expected logic for the virtual value.\r\n3. Observe the obtained result.\n\n### My Environment\n\n| Dependency          | Version  |\r\n| ---                 | ---      |\r\n| Operating System    |  windows 10       |\r\n| Node.js version     |  18.18.0  |\r\n| Typescript version  |  5.3.3  |\r\n| TypeORM version     | 0.3.19  |\r\n\n\n### Additional Context\n\n_No response_\n\n### Relevant Database Driver(s)\n\n- [ ] aurora-mysql\n- [ ] aurora-postgres\n- [ ] better-sqlite3\n- [ ] cockroachdb\n- [ ] cordova\n- [ ] expo\n- [ ] mongodb\n- [ ] mysql\n- [ ] nativescript\n- [ ] oracle\n- [X] postgres\n- [ ] react-native\n- [ ] sap\n- [ ] spanner\n- [ ] sqlite\n- [ ] sqlite-abstract\n- [ ] sqljs\n- [ ] sqlserver\n\n### Are you willing to resolve this issue by submitting a Pull Request?\n\nYes, I have the time, and I know how to start.", "closed_by": {"login": "alumni", "id": 611745, "node_id": "MDQ6VXNlcjYxMTc0NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/611745?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alumni", "html_url": "https://github.com/alumni", "followers_url": "https://api.github.com/users/alumni/followers", "following_url": "https://api.github.com/users/alumni/following{/other_user}", "gists_url": "https://api.github.com/users/alumni/gists{/gist_id}", "starred_url": "https://api.github.com/users/alumni/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alumni/subscriptions", "organizations_url": "https://api.github.com/users/alumni/orgs", "repos_url": "https://api.github.com/users/alumni/repos", "events_url": "https://api.github.com/users/alumni/events{/privacy}", "received_events_url": "https://api.github.com/users/alumni/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/10638/reactions", "total_count": 25, "+1": 25, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/10638/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/7736", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/7736/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/7736/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/7736/events", "html_url": "https://github.com/typeorm/typeorm/issues/7736", "id": 918050178, "node_id": "MDU6SXNzdWU5MTgwNTAxNzg=", "number": 7736, "title": ".save() is throwing duplicate key value violates unique constraint on Postgresql", "user": {"login": "fabiensabatie", "id": 4497692, "node_id": "MDQ6VXNlcjQ0OTc2OTI=", "avatar_url": "https://avatars.githubusercontent.com/u/4497692?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fabiensabatie", "html_url": "https://github.com/fabiensabatie", "followers_url": "https://api.github.com/users/fabiensabatie/followers", "following_url": "https://api.github.com/users/fabiensabatie/following{/other_user}", "gists_url": "https://api.github.com/users/fabiensabatie/gists{/gist_id}", "starred_url": "https://api.github.com/users/fabiensabatie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fabiensabatie/subscriptions", "organizations_url": "https://api.github.com/users/fabiensabatie/orgs", "repos_url": "https://api.github.com/users/fabiensabatie/repos", "events_url": "https://api.github.com/users/fabiensabatie/events{/privacy}", "received_events_url": "https://api.github.com/users/fabiensabatie/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 489019544, "node_id": "MDU6TGFiZWw0ODkwMTk1NDQ=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/needs%20more%20info", "name": "needs more info", "color": "bfd4f2", "default": false, "description": null}, {"id": 712054568, "node_id": "MDU6TGFiZWw3MTIwNTQ1Njg=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20postgres", "name": "driver: postgres", "color": "0052cc", "default": false, "description": null}, {"id": 1179464035, "node_id": "MDU6TGFiZWwxMTc5NDY0MDM1", "url": "https://api.github.com/repos/typeorm/typeorm/labels/needs%20tests", "name": "needs tests", "color": "8ccdd8", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [{"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 37, "created_at": "2021-06-10T23:36:52Z", "updated_at": "2025-01-02T08:56:50Z", "closed_at": "2022-02-26T09:15:39Z", "assignee": {"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "## Issue Description\r\n\r\nWhen trying to upsert an entity to a Postgresql DB, I get a `QueryFailedError: duplicate key value violates unique constraint`.\r\n\r\n### Expected Behavior\r\n\r\nI currently have a simple case : \r\n\r\n````ts\r\nawait this.save(user); // works \ud83c\udf89\r\nawait this.save(user); // should upsert the user\r\n````\r\n\r\nWhere the User entity is defined as such :\r\n\r\n````ts\r\n@Entity()\r\nclass User  {\r\n\r\n  @PrimaryColumn(\"text\")\r\n  id: string; // idem with a number\r\n\r\n  @Column(\"text\")\r\n  name: string;\r\n}\r\n````\r\n\r\n\r\n### Actual Behavior\r\n\r\n````ts\r\nawait this.save(user); // works \ud83c\udf89\r\nawait this.save(user); // fails the second time \u2639\r\n````\r\n with a `QueryFailedError: duplicate key value violates unique constraint`.\r\n\r\n### Steps to Reproduce\r\n\r\nA simple typeorm + Postgresql  stack should suffice\r\n\r\n### My Environment\r\n\r\nI'm on a plain TS stack, nothing fancy atm.\r\n\r\n\r\n\r\n### Relevant Database Driver(s)\r\n\r\n- [ ] `aurora-data-api`\r\n- [ ] `aurora-data-api-pg`\r\n- [ ] `better-sqlite3`\r\n- [ ] `cockroachdb`\r\n- [ ] `cordova`\r\n- [ ] `expo`\r\n- [ ] `mongodb`\r\n- [ ] `mysql`\r\n- [ ] `nativescript`\r\n- [ ] `oracle`\r\n- [x] `postgres`\r\n- [ ] `react-native`\r\n- [ ] `sap`\r\n- [ ] `sqlite`\r\n- [ ] `sqlite-abstract`\r\n- [ ] `sqljs`\r\n- [ ] `sqlserver`\r\n\r\n\r\n### Are you willing to resolve this issue by submitting a Pull Request?\r\n\r\n\r\n- [ ] Yes, I have the time, and I know how to start.\r\n- [x] Yes, I have the time, but I don't know how to start. I would need guidance.\r\n- [ ] No, I don't have the time, although I believe I could do it if I had the time...\r\n- [ ] No, I don't have the time and I wouldn't even know how to start.\r\n\r\n", "closed_by": {"login": "pleerock", "id": 1753397, "node_id": "MDQ6VXNlcjE3NTMzOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1753397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pleerock", "html_url": "https://github.com/pleerock", "followers_url": "https://api.github.com/users/pleerock/followers", "following_url": "https://api.github.com/users/pleerock/following{/other_user}", "gists_url": "https://api.github.com/users/pleerock/gists{/gist_id}", "starred_url": "https://api.github.com/users/pleerock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pleerock/subscriptions", "organizations_url": "https://api.github.com/users/pleerock/orgs", "repos_url": "https://api.github.com/users/pleerock/repos", "events_url": "https://api.github.com/users/pleerock/events{/privacy}", "received_events_url": "https://api.github.com/users/pleerock/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/7736/reactions", "total_count": 19, "+1": 19, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/7736/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/10769", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/10769/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/10769/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/10769/events", "html_url": "https://github.com/typeorm/typeorm/pull/10769", "id": 2182930358, "node_id": "PR_kwDOAyVBJc5pctp7", "number": 10769, "title": "fix: use subquery with join map one methods", "user": {"login": "xdc0", "id": 554933, "node_id": "MDQ6VXNlcjU1NDkzMw==", "avatar_url": "https://avatars.githubusercontent.com/u/554933?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xdc0", "html_url": "https://github.com/xdc0", "followers_url": "https://api.github.com/users/xdc0/followers", "following_url": "https://api.github.com/users/xdc0/following{/other_user}", "gists_url": "https://api.github.com/users/xdc0/gists{/gist_id}", "starred_url": "https://api.github.com/users/xdc0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xdc0/subscriptions", "organizations_url": "https://api.github.com/users/xdc0/orgs", "repos_url": "https://api.github.com/users/xdc0/repos", "events_url": "https://api.github.com/users/xdc0/events{/privacy}", "received_events_url": "https://api.github.com/users/xdc0/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 628504132, "node_id": "MDU6TGFiZWw2Mjg1MDQxMzI=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/comp:%20query%20builder", "name": "comp: query builder", "color": "1d76db", "default": false, "description": null}, {"id": 8048806041, "node_id": "LA_kwDOAyVBJc8AAAAB378ImQ", "url": "https://api.github.com/repos/typeorm/typeorm/labels/size-s", "name": "size-s", "color": "bfdadc", "default": false, "description": "Simple tasks that require minimal effort. Estimated effort: 1-2 hours."}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 15, "created_at": "2024-03-13T01:14:05Z", "updated_at": "2026-01-25T12:58:06Z", "closed_at": "2026-01-25T12:56:30Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/typeorm/typeorm/pulls/10769", "html_url": "https://github.com/typeorm/typeorm/pull/10769", "diff_url": "https://github.com/typeorm/typeorm/pull/10769.diff", "patch_url": "https://github.com/typeorm/typeorm/pull/10769.patch", "merged_at": null}, "body": "<!--\r\n  \ud83d\ude00 Wonderful!  Thank you for opening a pull request for TypeORM.\r\n\r\n  Please fill in the information below to expedite the review\r\n  and (hopefully) merge of your change.\r\n\r\n  If unsure about something.. just do as best as you're able,\r\n  or reach out through our community support channels!\r\n  https://github.com/typeorm/typeorm/blob/master/docs/support.md\r\n-->\r\n\r\n### Description of change\r\n\r\nOn https://github.com/typeorm/typeorm/pull/9354 there was a patch to map subquery results to an entity when using the `leftJoinAndMapOne` and `innerJoinAndMapOne` methods through a new parameter: `mapAsEntity`.\r\n\r\nThis unfortunately does not quite work as expected because the subquery is ignored since the join logic detects that there is metadata and the logic will override the subquery in favor of generated queries via metadata.\r\n\r\nThis problem is described by @cjsauer on the following comment: https://github.com/typeorm/typeorm/pull/9354#issuecomment-1841165218\r\n\r\nFixes #5637 \r\n\r\n### Pull-Request Checklist\r\n\r\n<!--\r\n  Please make sure to review and check all of the following.\r\n\r\n  If an item is not applicable, you can add \"N/A\" to the end.\r\n-->\r\n\r\n- [x] Code is up-to-date with the `master` branch\r\n- [x] `npm run format` to apply prettier formatting\r\n- [x] `npm run test` passes with this change\r\n- [x] This pull request links relevant issues as `Fixes #0000`\r\n- [x] There are new or updated unit tests validating the change\r\n- [x] Documentation has been updated to reflect this change\r\n- [x] The new commits follow conventions explained in [CONTRIBUTING.md](https://github.com/typeorm/typeorm/blob/master/CONTRIBUTING.md)\r\n\r\n<!--\r\n  \ud83c\udf89 Thank you for contributing and making TypeORM even better!\r\n-->\r\n\n\n<!-- This is an auto-generated comment: release notes by coderabbit.ai -->\n\n## Summary by CodeRabbit\n\n- **Tests**\n\t- Added new test cases to verify correct behavior when join subqueries with conditions do not find matching data, ensuring left joins map to null and inner joins return no entity.\n- **Refactor**\n\t- Improved and unified the internal handling of subqueries within join operations for more consistent and maintainable logic.\n\n<!-- end of auto-generated comment: release notes by coderabbit.ai -->", "closed_by": {"login": "gioboa", "id": 35845425, "node_id": "MDQ6VXNlcjM1ODQ1NDI1", "avatar_url": "https://avatars.githubusercontent.com/u/35845425?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gioboa", "html_url": "https://github.com/gioboa", "followers_url": "https://api.github.com/users/gioboa/followers", "following_url": "https://api.github.com/users/gioboa/following{/other_user}", "gists_url": "https://api.github.com/users/gioboa/gists{/gist_id}", "starred_url": "https://api.github.com/users/gioboa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gioboa/subscriptions", "organizations_url": "https://api.github.com/users/gioboa/orgs", "repos_url": "https://api.github.com/users/gioboa/repos", "events_url": "https://api.github.com/users/gioboa/events{/privacy}", "received_events_url": "https://api.github.com/users/gioboa/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/10769/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/10769/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/4499", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/4499/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/4499/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/4499/events", "html_url": "https://github.com/typeorm/typeorm/issues/4499", "id": 473988665, "node_id": "MDU6SXNzdWU0NzM5ODg2NjU=", "number": 4499, "title": "Excessive memory usage when loading models with relations", "user": {"login": "nikolovjd", "id": 25425863, "node_id": "MDQ6VXNlcjI1NDI1ODYz", "avatar_url": "https://avatars.githubusercontent.com/u/25425863?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nikolovjd", "html_url": "https://github.com/nikolovjd", "followers_url": "https://api.github.com/users/nikolovjd/followers", "following_url": "https://api.github.com/users/nikolovjd/following{/other_user}", "gists_url": "https://api.github.com/users/nikolovjd/gists{/gist_id}", "starred_url": "https://api.github.com/users/nikolovjd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nikolovjd/subscriptions", "organizations_url": "https://api.github.com/users/nikolovjd/orgs", "repos_url": "https://api.github.com/users/nikolovjd/repos", "events_url": "https://api.github.com/users/nikolovjd/events{/privacy}", "received_events_url": "https://api.github.com/users/nikolovjd/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 637618257, "node_id": "MDU6TGFiZWw2Mzc2MTgyNTc=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/performance", "name": "performance", "color": "dd35bc", "default": false, "description": null}, {"id": 712054568, "node_id": "MDU6TGFiZWw3MTIwNTQ1Njg=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20postgres", "name": "driver: postgres", "color": "0052cc", "default": false, "description": null}, {"id": 1179464035, "node_id": "MDU6TGFiZWwxMTc5NDY0MDM1", "url": "https://api.github.com/repos/typeorm/typeorm/labels/needs%20tests", "name": "needs tests", "color": "8ccdd8", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 36, "created_at": "2019-07-29T11:04:42Z", "updated_at": "2025-08-04T12:54:32Z", "closed_at": "2021-07-01T05:27:51Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Issue type:**\r\n\r\n[ ] question\r\n[x] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[ ] `mongodb`\r\n[ ] `mssql`\r\n[ ] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[x] `postgres`\r\n[ ] `cockroachdb`\r\n[ ] `sqlite`\r\n[ ] `sqljs`\r\n[ ] `react-native`\r\n[ ] `expo`\r\n\r\n**TypeORM version:**\r\n\r\n[x] `latest`\r\n[ ] `@next`\r\n[ ] `0.x.x` (or put your version here)\r\n\r\n**Steps to reproduce or a small repository showing the problem:**\r\n\r\nIf I load a list of models like this:\r\n\r\n```ts\r\nconst models = await this.modelRepository\r\n  .createQueryBuilder('model')\r\n  .innerJoinAndSelect('model.relationshipA')\r\n  .innerJoinAndSelect('model.relationshipB')\r\n  .innerJoinAndSelect('model.relationshipC')\r\n  // etc\r\n  .getManyAndCount();\r\n```\r\nWith many elements (100 in my case) it gets up to 2+ GB of memory usage for the query, where if i load the model by itself, and then make separate queries for each relationship such as:\r\n\r\n```ts\r\n  const galleries: Gallery[] = await relationshipAModel.createQueryBuilder('model')\r\n          .leftJoinAndSelect('model.subRelationshipA', 'a')\r\n          .leftJoinAndSelect('model.subRelationshipB', 'b')\r\n          .whereInIds(firstResultIds)\r\n          .getMany();\r\n```\r\n\r\nAnd then map the results to the original list, the memory footprint is not even noticeable.\r\n\r\n<!--\r\n    To answer those questions you need to put \"x\" inside the square brackets, for example:\r\n    [x] `mysql`\r\n    [ ] `postgres`\r\n\r\n    Also, please format your code properly (by taking code blocks into ```ts .... ```)\r\n!>\r\n", "closed_by": {"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/4499/reactions", "total_count": 24, "+1": 24, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/4499/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/8939", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/8939/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/8939/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/8939/events", "html_url": "https://github.com/typeorm/typeorm/issues/8939", "id": 1216588270, "node_id": "I_kwDOAyVBJc5Ig6nu", "number": 8939, "title": "0.3 generic findOneBy typescript error", "user": {"login": "Scalahansolo", "id": 4317253, "node_id": "MDQ6VXNlcjQzMTcyNTM=", "avatar_url": "https://avatars.githubusercontent.com/u/4317253?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Scalahansolo", "html_url": "https://github.com/Scalahansolo", "followers_url": "https://api.github.com/users/Scalahansolo/followers", "following_url": "https://api.github.com/users/Scalahansolo/following{/other_user}", "gists_url": "https://api.github.com/users/Scalahansolo/gists{/gist_id}", "starred_url": "https://api.github.com/users/Scalahansolo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Scalahansolo/subscriptions", "organizations_url": "https://api.github.com/users/Scalahansolo/orgs", "repos_url": "https://api.github.com/users/Scalahansolo/repos", "events_url": "https://api.github.com/users/Scalahansolo/events{/privacy}", "received_events_url": "https://api.github.com/users/Scalahansolo/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 2454823078, "node_id": "MDU6TGFiZWwyNDU0ODIzMDc4", "url": "https://api.github.com/repos/typeorm/typeorm/labels/requires%20triage", "name": "requires triage", "color": "f9aeb0", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 35, "created_at": "2022-04-26T23:19:00Z", "updated_at": "2025-02-12T17:23:21Z", "closed_at": "2022-07-06T11:44:28Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "## Issue Description\r\n\r\nWith the upgrade to the new syntax in 0.3 there is a typescript issue with using `findOneBy` on a generic repro.\r\n\r\n```typescript\r\nexport abstract class BaseEntity {\r\n  abstract readonly id: string\r\n}\r\n\r\nexport async function checkAuth<T extends BaseEntity>(\r\n  entity: T,\r\n  repo?: Repository<T>,\r\n): Promise<[T, boolean]> {\r\n  let existingEntity: T | null\r\n\r\n  let exists = false\r\n  if (repo) {\r\n    existingEntity = await repo.findOneBy({ id: entity.id })\r\n\r\n```\r\n### Expected Behavior\r\nThe code above should compile fine, no issues\r\n\r\n\r\n### Actual Behavior\r\nI get the following typescript error.\r\n\r\n```\r\nTS2345: Argument of type '{ id: string; }' is not assignable to parameter of type 'FindOptionsWhere<T> | FindOptionsWhere<T>[]'. \u00a0\u00a0Types of property 'id' are incompatible. \u00a0\u00a0\u00a0\u00a0Type 'string' is not assignable to type 'FindOptionsWhereProperty<NonNullable<T[\"id\"]>> | undefined'.\r\n```\r\n\r\n - \u2716\ufe0f Yes, I have the time, and I know how to start.\r\n - \u2705Yes, I have the time, but I don't know how to start. I would need guidance.\r\n - \u2716\ufe0f No, I don\u2019t have the time, but I can support (using donations) development.\r\n - \u2716\ufe0f No, I don\u2019t have the time and I\u2019m okay to wait for the community / maintainers to resolve this issue.\r\n\r\n", "closed_by": {"login": "pleerock", "id": 1753397, "node_id": "MDQ6VXNlcjE3NTMzOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1753397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pleerock", "html_url": "https://github.com/pleerock", "followers_url": "https://api.github.com/users/pleerock/followers", "following_url": "https://api.github.com/users/pleerock/following{/other_user}", "gists_url": "https://api.github.com/users/pleerock/gists{/gist_id}", "starred_url": "https://api.github.com/users/pleerock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pleerock/subscriptions", "organizations_url": "https://api.github.com/users/pleerock/orgs", "repos_url": "https://api.github.com/users/pleerock/repos", "events_url": "https://api.github.com/users/pleerock/events{/privacy}", "received_events_url": "https://api.github.com/users/pleerock/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/8939/reactions", "total_count": 18, "+1": 18, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/8939/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/2904", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/2904/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/2904/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/2904/events", "html_url": "https://github.com/typeorm/typeorm/issues/2904", "id": 368098126, "node_id": "MDU6SXNzdWUzNjgwOTgxMjY=", "number": 2904, "title": "Type DeepPartial issue when used with generics", "user": {"login": "Hulago", "id": 14819876, "node_id": "MDQ6VXNlcjE0ODE5ODc2", "avatar_url": "https://avatars.githubusercontent.com/u/14819876?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Hulago", "html_url": "https://github.com/Hulago", "followers_url": "https://api.github.com/users/Hulago/followers", "following_url": "https://api.github.com/users/Hulago/following{/other_user}", "gists_url": "https://api.github.com/users/Hulago/gists{/gist_id}", "starred_url": "https://api.github.com/users/Hulago/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Hulago/subscriptions", "organizations_url": "https://api.github.com/users/Hulago/orgs", "repos_url": "https://api.github.com/users/Hulago/repos", "events_url": "https://api.github.com/users/Hulago/events{/privacy}", "received_events_url": "https://api.github.com/users/Hulago/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 333605716, "node_id": "MDU6TGFiZWwzMzM2MDU3MTY=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/question", "name": "question", "color": "cc317c", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 35, "created_at": "2018-10-09T08:35:32Z", "updated_at": "2025-02-06T22:54:45Z", "closed_at": "2022-02-16T03:56:51Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Issue type:**\r\n\r\n[ x ] question\r\n[ x ] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[ ] `mongodb`\r\n[ ] `mssql`\r\n[ ] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[ ] `postgres`\r\n[ ] `sqlite`\r\n[ ] `sqljs`\r\n[ ] `react-native`\r\n[ ] `expo`\r\n\r\n**TypeORM version:**\r\n\r\n[ x ] `latest`\r\n[ x ] `@next`\r\n[ x ] `0.x.x` (or put your version here)\r\n\r\n**Steps to reproduce or a small repository showing the problem:**\r\n```typescript\r\n\r\nimport {\r\n  EntityManager,\r\n  Transaction,\r\n  TransactionManager,\r\n  DeepPartial,\r\n  PrimaryGeneratedColumn,\r\n  CreateDateColumn,\r\n  UpdateDateColumn,\r\n  Connection,\r\n  getConnection,\r\n  getManager\r\n} from 'typeorm';\r\n\r\nnamespace interfaces {\r\n  export type klass<T> = { new (...args: any[]): T } | Function;\r\n}\r\n\r\nexport class AuditedEntity {\r\n  @PrimaryGeneratedColumn()\r\n  id: number;\r\n\r\n  savedBy: string;\r\n\r\n  @CreateDateColumn()\r\n  createdAt: Date;\r\n\r\n  @UpdateDateColumn()\r\n  updatedAt: Date;\r\n}\r\n\r\nexport abstract class AbsBaseDao<E, PK = number> {\r\n  conn: Connection;\r\n  manager: EntityManager;\r\n  baseEntity: interfaces.klass<E>;\r\n\r\n  constructor(entity: interfaces.klass<E>) {\r\n    this.conn = getConnection();\r\n    this.manager = getManager();\r\n    this.baseEntity = entity;\r\n  }\r\n\r\n  @Transaction()\r\n  async create(entity: DeepPartial<E>, @TransactionManager() manager?: EntityManager) {\r\n    return await manager.create(this.baseEntity, entity);\r\n  }\r\n}\r\nexport class TestDao<E extends AuditedEntity, PK = number> extends AbsBaseDao<E, PK> {\r\n  async create(entity: DeepPartial<E>, @TransactionManager() manager?: EntityManager) {\r\n    entity.createdAt = new Date();\r\n    entity.updatedAt = new Date();\r\n    entity.savedBy = 'SomeUSer';\r\n\r\n    return super.create(entity);\r\n  }\r\n}\r\n```\r\nTypescript is giving me error on entity.createdAt, entity.updatedAt , entity.savedBy.\r\n\r\n[ts] Type 'Date' is not assignable to type 'DeepPartial<E[\"createdAt\"]>'.\r\n\r\n\r\nBut if I change the DeepPartial type from:\r\n\r\nexport declare type DeepPartial<T> = { [P in keyof T]?: DeepPartial<T[P]> };\r\n\r\nto\r\n\r\nexport declare type DeepPartial<T> = { [P in keyof T]?: DeepPartial<T[P]> | **T[P]** };\r\n\r\nthe error disappears.\r\n\r\nCould we change the DeepPartial type ?\r\n\r\nRegards\r\n\r\nHugo\r\n\r\n<!--\r\n    To answer those questions you need to put \"x\" inside the square brackets, for example:\r\n    [x] `mysql`\r\n    [ ] `postgres`\r\n\r\n    Also, please format your code properly (by taking code blocks into ```ts .... ```)\r\n!>\r\n", "closed_by": {"login": "pleerock", "id": 1753397, "node_id": "MDQ6VXNlcjE3NTMzOTc=", "avatar_url": "https://avatars.githubusercontent.com/u/1753397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pleerock", "html_url": "https://github.com/pleerock", "followers_url": "https://api.github.com/users/pleerock/followers", "following_url": "https://api.github.com/users/pleerock/following{/other_user}", "gists_url": "https://api.github.com/users/pleerock/gists{/gist_id}", "starred_url": "https://api.github.com/users/pleerock/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pleerock/subscriptions", "organizations_url": "https://api.github.com/users/pleerock/orgs", "repos_url": "https://api.github.com/users/pleerock/repos", "events_url": "https://api.github.com/users/pleerock/events{/privacy}", "received_events_url": "https://api.github.com/users/pleerock/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/2904/reactions", "total_count": 32, "+1": 32, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/2904/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/1668", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/1668/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/1668/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/1668/events", "html_url": "https://github.com/typeorm/typeorm/issues/1668", "id": 300880642, "node_id": "MDU6SXNzdWUzMDA4ODA2NDI=", "number": 1668, "title": "JoinTable query generates incorrectly when entity doesn't match standard naming conventions", "user": {"login": "vados-p7e", "id": 32691572, "node_id": "MDQ6VXNlcjMyNjkxNTcy", "avatar_url": "https://avatars.githubusercontent.com/u/32691572?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vados-p7e", "html_url": "https://github.com/vados-p7e", "followers_url": "https://api.github.com/users/vados-p7e/followers", "following_url": "https://api.github.com/users/vados-p7e/following{/other_user}", "gists_url": "https://api.github.com/users/vados-p7e/gists{/gist_id}", "starred_url": "https://api.github.com/users/vados-p7e/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vados-p7e/subscriptions", "organizations_url": "https://api.github.com/users/vados-p7e/orgs", "repos_url": "https://api.github.com/users/vados-p7e/repos", "events_url": "https://api.github.com/users/vados-p7e/events{/privacy}", "received_events_url": "https://api.github.com/users/vados-p7e/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [{"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 34, "created_at": "2018-02-28T03:42:33Z", "updated_at": "2025-06-17T16:38:17Z", "closed_at": "2025-06-17T16:38:17Z", "assignee": {"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Steps to reproduce or a small repository showing the problem:**\r\n\r\n1. Create two entities that don't follow the naming convention (ex. `Thing` in table `things` and `Tag` in table `tags`)\r\n\r\n2. Create a join table for them (`thing_tags`) (note that due to the departure from naming convention earlier, this is also a departure from naming convention)\r\n\r\n3. Create a `@ManyToMany` relation using `@JoinTable` inside `Thing` as follows:\r\n\r\n```ts\r\n  @ManyToMany(type => Tag, {eager: true})\r\n  @JoinTable({\r\n    name: \"thing_tags\",\r\n    joinColumn: {name: \"thing_id\", referencedColumnName: \"id\"}\r\n    inverseJoinColumn: {name: \"tag_id\", referencedColumnName: \"id\"}\r\n  })\r\n  tags: Tag[];\r\n```\r\nWhen trying to retrieve a `Thing`, the query is just barely wrong:\r\n\r\n```sql\r\nSELECT Thing_tags_relation_id.tag_id AS \"tag_id\", Thing_tags_relation_id.thing_id AS \"thing_id\" FROM \"tags\" \"tags\" INNER JOIN \"thing_tags\" \"Thing_tags_relation_id\" ON (Thing_tags_relation_id.thing_id = $1 AND Thing_tags_relation_id.tag_id = \"tags\".\"id\") ORDER BY Thing_tags_relation_id.tag_id ASC, Thing_tags_relation_id.thing_id ASC;\r\nERROR:  missing FROM-clause entry for table \"thing_tags_relation_id\"\r\n```\r\nThe problem here is that `Thing_tags_relation_id` is not quoted everywhere it's mentioned. If I take the query to postgres, and add quotes around every unquoted `Thing_tags_relation_id`, the query works great:\r\n\r\n```sql\r\ndb_test=# SELECT \"Thing_tags_relation_id\".tag_id AS \"tag_id\", \"Thing_tags_relation_id\".thing_id AS \"thing_id\" FROM \"tags\" \"tags\" INNER JOIN \"thing_tags\" \"Thing_tags_relation_id\" ON (\"Thing_tags_relation_id\".thing_id = 1743 AND \"Thing_tags_relation_id\".tag_id = \"tags\". \"id\") ORDER BY \"Thing_tags_relation_id\".tag_id ASC, \"Thing_tags_relation_id\".thing_id ASC;\r\ntag_id | thing_id\r\n--------+-----------\r\n(0 rows)\r\n```\r\n\r\n**PS** I personally would love a `parametrizedQuery` parameter in error reports that prints the complete query with params filled out (exactly as it would have been sent).\r\n\r\nAs always thanks for all the work on `typeorm`, it is 100% improving the development lives of me and my team :)", "closed_by": {"login": "alumni", "id": 611745, "node_id": "MDQ6VXNlcjYxMTc0NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/611745?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alumni", "html_url": "https://github.com/alumni", "followers_url": "https://api.github.com/users/alumni/followers", "following_url": "https://api.github.com/users/alumni/following{/other_user}", "gists_url": "https://api.github.com/users/alumni/gists{/gist_id}", "starred_url": "https://api.github.com/users/alumni/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alumni/subscriptions", "organizations_url": "https://api.github.com/users/alumni/orgs", "repos_url": "https://api.github.com/users/alumni/repos", "events_url": "https://api.github.com/users/alumni/events{/privacy}", "received_events_url": "https://api.github.com/users/alumni/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/1668/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/1668/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/5877", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/5877/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/5877/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/5877/events", "html_url": "https://github.com/typeorm/typeorm/issues/5877", "id": 599946567, "node_id": "MDU6SXNzdWU1OTk5NDY1Njc=", "number": 5877, "title": "SoftDelete in relationships cascade does not work", "user": {"login": "halain", "id": 18603728, "node_id": "MDQ6VXNlcjE4NjAzNzI4", "avatar_url": "https://avatars.githubusercontent.com/u/18603728?v=4", "gravatar_id": "", "url": "https://api.github.com/users/halain", "html_url": "https://github.com/halain", "followers_url": "https://api.github.com/users/halain/followers", "following_url": "https://api.github.com/users/halain/following{/other_user}", "gists_url": "https://api.github.com/users/halain/gists{/gist_id}", "starred_url": "https://api.github.com/users/halain/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/halain/subscriptions", "organizations_url": "https://api.github.com/users/halain/orgs", "repos_url": "https://api.github.com/users/halain/repos", "events_url": "https://api.github.com/users/halain/events{/privacy}", "received_events_url": "https://api.github.com/users/halain/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 712054471, "node_id": "MDU6TGFiZWw3MTIwNTQ0NzE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20mysql", "name": "driver: mysql", "color": "0052cc", "default": false, "description": null}, {"id": 712054626, "node_id": "MDU6TGFiZWw3MTIwNTQ2MjY=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20mariadb", "name": "driver: mariadb", "color": "0052cc", "default": false, "description": null}, {"id": 9302551618, "node_id": "LA_kwDOAyVBJc8AAAACKnmsQg", "url": "https://api.github.com/repos/typeorm/typeorm/labels/stale", "name": "stale", "color": "ededed", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [{"login": "naorpeled", "id": 6171622, "node_id": "MDQ6VXNlcjYxNzE2MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/6171622?v=4", "gravatar_id": "", "url": "https://api.github.com/users/naorpeled", "html_url": "https://github.com/naorpeled", "followers_url": "https://api.github.com/users/naorpeled/followers", "following_url": "https://api.github.com/users/naorpeled/following{/other_user}", "gists_url": "https://api.github.com/users/naorpeled/gists{/gist_id}", "starred_url": "https://api.github.com/users/naorpeled/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/naorpeled/subscriptions", "organizations_url": "https://api.github.com/users/naorpeled/orgs", "repos_url": "https://api.github.com/users/naorpeled/repos", "events_url": "https://api.github.com/users/naorpeled/events{/privacy}", "received_events_url": "https://api.github.com/users/naorpeled/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 33, "created_at": "2020-04-15T00:55:05Z", "updated_at": "2025-09-18T15:55:23Z", "closed_at": "2025-09-18T15:55:23Z", "assignee": {"login": "naorpeled", "id": 6171622, "node_id": "MDQ6VXNlcjYxNzE2MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/6171622?v=4", "gravatar_id": "", "url": "https://api.github.com/users/naorpeled", "html_url": "https://github.com/naorpeled", "followers_url": "https://api.github.com/users/naorpeled/followers", "following_url": "https://api.github.com/users/naorpeled/following{/other_user}", "gists_url": "https://api.github.com/users/naorpeled/gists{/gist_id}", "starred_url": "https://api.github.com/users/naorpeled/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/naorpeled/subscriptions", "organizations_url": "https://api.github.com/users/naorpeled/orgs", "repos_url": "https://api.github.com/users/naorpeled/repos", "events_url": "https://api.github.com/users/naorpeled/events{/privacy}", "received_events_url": "https://api.github.com/users/naorpeled/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Issue type:**\r\n\r\n[ ] question\r\n[x] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[ ] `mongodb`\r\n[ ] `mssql`\r\n[x] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[ ] `postgres`\r\n[ ] `cockroachdb`\r\n[ ] `sqlite`\r\n[ ] `sqljs`\r\n[ ] `react-native`\r\n[ ] `expo`\r\n\r\n**TypeORM version:**\r\n\r\n[ ] `latest`\r\n[ ] `@next`\r\n[ ] `0.2.24` (or put your version here)\r\n\r\n**In one to many relationship the sofdelete does not update the related entity:**\r\n\r\nThe Gestion entity has a one-to-many relationship with the Incedence entity\r\n\r\nGestion entity\r\n```\r\n....\r\n\r\n@DeleteDateColumn({ type: \"datetime\" })\r\ndeletedAt: Date;\r\n\r\n....\r\n\r\n @OneToMany(type => Incidence, incidence => incidence.gestion,{ \r\n    cascade: true \r\n  })\r\n  incidences: Incidence[];\r\n```\r\n\r\nInverse relationship\r\n\r\nIncidence entity\r\n\r\n```\r\n...\r\n\r\n@DeleteDateColumn({ type: \"datetime\" })\r\n  deletedAt: Date;\r\n\r\n...\r\n\r\n@ManyToOne(type => Gestion, gestion => gestion.incidences)\r\n  gestion: Gestion;\r\n\r\n```\r\n\r\n\r\n```\r\n await gestRepository.softDelete({id:gestionId})\r\n\r\n```\r\n\r\nThe deleteAt column of the Gestion entity is set correctly with the date but the related entity Incidence is not affected, it remains null\r\n", "closed_by": {"login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/5877/reactions", "total_count": 6, "+1": 6, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/5877/timeline", "performed_via_github_app": null, "state_reason": "not_planned", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/5103", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/5103/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/5103/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/5103/events", "html_url": "https://github.com/typeorm/typeorm/issues/5103", "id": 524480785, "node_id": "MDU6SXNzdWU1MjQ0ODA3ODU=", "number": 5103, "title": "migrations doesnt run even after doing everything", "user": {"login": "rubiin", "id": 8222059, "node_id": "MDQ6VXNlcjgyMjIwNTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8222059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rubiin", "html_url": "https://github.com/rubiin", "followers_url": "https://api.github.com/users/rubiin/followers", "following_url": "https://api.github.com/users/rubiin/following{/other_user}", "gists_url": "https://api.github.com/users/rubiin/gists{/gist_id}", "starred_url": "https://api.github.com/users/rubiin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rubiin/subscriptions", "organizations_url": "https://api.github.com/users/rubiin/orgs", "repos_url": "https://api.github.com/users/rubiin/repos", "events_url": "https://api.github.com/users/rubiin/events{/privacy}", "received_events_url": "https://api.github.com/users/rubiin/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 712054568, "node_id": "MDU6TGFiZWw3MTIwNTQ1Njg=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20postgres", "name": "driver: postgres", "color": "0052cc", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 33, "created_at": "2019-11-18T16:35:24Z", "updated_at": "2020-10-07T03:05:12Z", "closed_at": "2020-10-07T03:05:12Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Issue type:**\r\n\r\n[ ] question\r\n[x] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[ ] `mongodb`\r\n[ ] `mssql`\r\n[ ] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[x] `postgres`\r\n[ ] `cockroachdb`\r\n[ ] `sqlite`\r\n[ ] `sqljs`\r\n[ ] `react-native`\r\n[ ] `expo`\r\n\r\n**TypeORM version:**\r\n\r\n[x] `latest`\r\n[ ] `@next`\r\n[ ] `0.x.x` (or put your version here)\r\n\r\n**Steps to reproduce or a small repository showing the problem:**\r\n\r\nI am working on a project with typeorm on nestjs. the problem is even after running mgration after generating migration files, i get ```No migrations are pending```\r\n\r\nThe commands i am using are \r\n```\r\n \"typeorm\": \"NODE_ENV=dev ts-node -r tsconfig-paths/register ./node_modules/typeorm/cli.js --config src/config/typeorm.config.ts\",\r\n \r\n\"typeorm:migrate\": \"npm run typeorm migration:generate -- -n\",\r\n \r\n\"typeorm:run\": \"npm run typeorm migration:run\"\r\n```\r\nI am doing \r\n```\r\nnpm run typeorm:migrate test\r\nnpm run typeorm:run\r\n```\r\nBTW: my ormconfig looks like this\r\n\r\n```js\r\n\r\nimport config from '@config/index';\r\nimport { join } from 'path';\r\nimport { ConnectionOptions } from 'typeorm';\r\n\r\nconst typeormConfig: ConnectionOptions = {\r\n  type: 'postgres',\r\n  host: config.db.host,\r\n  port: config.db.port,\r\n  logging: ['error'],\r\n  username: config.db.username,\r\n  password: config.db.password,\r\n  database: config.db.database,\r\n  entities: [join(__dirname, '../entities/**{.ts,.js}')],\r\n  synchronize: false,\r\n  migrations: ['migrations/**/*{.ts,.js}'],\r\n  cli: {\r\n    migrationsDir: 'migration',\r\n  },\r\n};\r\n\r\nexport = typeormConfig;\r\n\r\n\r\n```\r\n\r\n<!--\r\n    To answer those questions you need to put \"x\" inside the square brackets, for example:\r\n    [x] `mysql`\r\n    [ ] `postgres`\r\n\r\n    Also, please format your code properly (by taking code blocks into ```ts .... ```)\r\n!>\r\n\r\n", "closed_by": {"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/5103/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/5103/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/typeorm/typeorm/issues/3194", "repository_url": "https://api.github.com/repos/typeorm/typeorm", "labels_url": "https://api.github.com/repos/typeorm/typeorm/issues/3194/labels{/name}", "comments_url": "https://api.github.com/repos/typeorm/typeorm/issues/3194/comments", "events_url": "https://api.github.com/repos/typeorm/typeorm/issues/3194/events", "html_url": "https://github.com/typeorm/typeorm/issues/3194", "id": 387157656, "node_id": "MDU6SXNzdWUzODcxNTc2NTY=", "number": 3194, "title": "TS2321: Excessive stack depth comparing types 'MongoRepository<Entity>' and 'Repository<Entity>'", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 333605711, "node_id": "MDU6TGFiZWwzMzM2MDU3MTE=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 489019544, "node_id": "MDU6TGFiZWw0ODkwMTk1NDQ=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/needs%20more%20info", "name": "needs more info", "color": "bfd4f2", "default": false, "description": null}, {"id": 712054782, "node_id": "MDU6TGFiZWw3MTIwNTQ3ODI=", "url": "https://api.github.com/repos/typeorm/typeorm/labels/driver:%20mongodb", "name": "driver: mongodb", "color": "0052cc", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 33, "created_at": "2018-12-04T07:42:42Z", "updated_at": "2021-12-13T18:14:20Z", "closed_at": "2021-06-25T05:26:46Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "**Issue type:**\r\n\r\n[ ] question\r\n[x] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[x] `mongodb`\r\n[ ] `mssql`\r\n[ ] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[ ] `postgres`\r\n[ ] `sqlite`\r\n[ ] `sqljs`\r\n[ ] `react-native`\r\n[ ] `expo`\r\n\r\n**TypeORM version:**\r\n\r\n[x] `latest`\r\n[ ] `@next`\r\n[ ] `0.x.x` (or put your version here)\r\n\r\n**Steps to reproduce or a small repository showing the problem:**\r\nI am trying to build an API with typeorm and type-graphql. The following code should work, but it gives me a strange error: `[at-loader] TS2321: Excessive stack depth comparing types 'MongoRepository<Entity>' and 'Repository<Entity>'.`\r\n\r\n```ts\r\nimport { Resolver, Mutation, Query, Arg, Ctx } from \"type-graphql\";\r\nimport { MongoRepository } from \"typeorm\";\r\nimport { InjectRepository } from \"typeorm-typedi-extensions\";\r\nimport { User } from \"../entities/user\";\r\n\r\n@Resolver(of => User)\r\nexport class UserResolver {\r\n  constructor(\r\n    @InjectRepository(User) private readonly userRepository: MongoRepository<User>\r\n  ) {}\r\n\r\n  @Query(returns => User, { nullable: true })\r\n  userBySlug(@Arg(\"slug\") slug: string) {\r\n    return this.userRepository.findOne({slug});\r\n  }\r\n}\r\n```\r\nIt works just fine, if I use `Repository` instead of `MongoRepository`, and I've found a way to circumvent this by calling `createEntityCursor(query)`, but I want to use projections in my queries. The projection object cannot be passed to `createEntityCursor()`, and `find()` & `findOne()` methods raise that `TS2321` error. I've also found [this typescript issue](https://github.com/Microsoft/TypeScript/issues/21592), but I am unsure what to do next. Is there a way to get pass this error?", "closed_by": {"login": "imnotjames", "id": 1551593, "node_id": "MDQ6VXNlcjE1NTE1OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/1551593?v=4", "gravatar_id": "", "url": "https://api.github.com/users/imnotjames", "html_url": "https://github.com/imnotjames", "followers_url": "https://api.github.com/users/imnotjames/followers", "following_url": "https://api.github.com/users/imnotjames/following{/other_user}", "gists_url": "https://api.github.com/users/imnotjames/gists{/gist_id}", "starred_url": "https://api.github.com/users/imnotjames/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/imnotjames/subscriptions", "organizations_url": "https://api.github.com/users/imnotjames/orgs", "repos_url": "https://api.github.com/users/imnotjames/repos", "events_url": "https://api.github.com/users/imnotjames/events{/privacy}", "received_events_url": "https://api.github.com/users/imnotjames/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/typeorm/typeorm/issues/3194/reactions", "total_count": 7, "+1": 7, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/typeorm/typeorm/issues/3194/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}]}