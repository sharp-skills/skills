{"d": [{"url": "https://api.github.com/repos/pmndrs/zustand/issues/3108", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/3108/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/3108/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/3108/events", "html_url": "https://github.com/pmndrs/zustand/pull/3108", "id": 3040454718, "node_id": "PR_kwDOCr-ZC86U-sp2", "number": 3108, "title": "feat(vanilla): update shallow compare function and tests", "user": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [{"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/pmndrs/zustand/milestones/40", "html_url": "https://github.com/pmndrs/zustand/milestone/40", "labels_url": "https://api.github.com/repos/pmndrs/zustand/milestones/40/labels", "id": 12854428, "node_id": "MI_kwDOCr-ZC84AxCSc", "number": 40, "title": "v5.0.5", "description": "", "creator": {"login": "dai-shi", "id": 490574, "node_id": "MDQ6VXNlcjQ5MDU3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/490574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dai-shi", "html_url": "https://github.com/dai-shi", "followers_url": "https://api.github.com/users/dai-shi/followers", "following_url": "https://api.github.com/users/dai-shi/following{/other_user}", "gists_url": "https://api.github.com/users/dai-shi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dai-shi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dai-shi/subscriptions", "organizations_url": "https://api.github.com/users/dai-shi/orgs", "repos_url": "https://api.github.com/users/dai-shi/repos", "events_url": "https://api.github.com/users/dai-shi/events{/privacy}", "received_events_url": "https://api.github.com/users/dai-shi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 3, "state": "closed", "created_at": "2025-05-07T13:52:27Z", "updated_at": "2025-06-08T23:52:39Z", "due_on": "2025-05-21T00:00:00Z", "closed_at": "2025-06-08T23:52:39Z"}, "comments": 8, "created_at": "2025-05-05T18:22:59Z", "updated_at": "2025-05-21T00:46:37Z", "closed_at": "2025-05-21T00:46:37Z", "assignee": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/pmndrs/zustand/pulls/3108", "html_url": "https://github.com/pmndrs/zustand/pull/3108", "diff_url": "https://github.com/pmndrs/zustand/pull/3108.diff", "patch_url": "https://github.com/pmndrs/zustand/pull/3108.patch", "merged_at": "2025-05-21T00:46:37Z"}, "body": "## Related Bug Reports or Discussions\r\n\r\nFixes #3107\r\n\r\n## Summary\r\n\r\n## Check List\r\n\r\n- [x] `pnpm run fix` for formatting and linting code and docs\r\n", "closed_by": {"login": "dai-shi", "id": 490574, "node_id": "MDQ6VXNlcjQ5MDU3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/490574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dai-shi", "html_url": "https://github.com/dai-shi", "followers_url": "https://api.github.com/users/dai-shi/followers", "following_url": "https://api.github.com/users/dai-shi/following{/other_user}", "gists_url": "https://api.github.com/users/dai-shi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dai-shi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dai-shi/subscriptions", "organizations_url": "https://api.github.com/users/dai-shi/orgs", "repos_url": "https://api.github.com/users/dai-shi/repos", "events_url": "https://api.github.com/users/dai-shi/events{/privacy}", "received_events_url": "https://api.github.com/users/dai-shi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/3108/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/3108/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/2170", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/2170/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/2170/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/2170/events", "html_url": "https://github.com/pmndrs/zustand/pull/2170", "id": 1972529740, "node_id": "PR_kwDOCr-ZC85eV6Vq", "number": 2170, "title": "Update export types", "user": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [{"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/pmndrs/zustand/milestones/28", "html_url": "https://github.com/pmndrs/zustand/milestone/28", "labels_url": "https://api.github.com/repos/pmndrs/zustand/milestones/28/labels", "id": 10139272, "node_id": "MI_kwDOCr-ZC84AmraI", "number": 28, "title": "v4.4.6", "description": "", "creator": {"login": "dai-shi", "id": 490574, "node_id": "MDQ6VXNlcjQ5MDU3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/490574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dai-shi", "html_url": "https://github.com/dai-shi", "followers_url": "https://api.github.com/users/dai-shi/followers", "following_url": "https://api.github.com/users/dai-shi/following{/other_user}", "gists_url": "https://api.github.com/users/dai-shi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dai-shi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dai-shi/subscriptions", "organizations_url": "https://api.github.com/users/dai-shi/orgs", "repos_url": "https://api.github.com/users/dai-shi/repos", "events_url": "https://api.github.com/users/dai-shi/events{/privacy}", "received_events_url": "https://api.github.com/users/dai-shi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 1, "state": "closed", "created_at": "2023-11-02T23:53:31Z", "updated_at": "2023-11-03T00:02:28Z", "due_on": "2023-11-03T00:00:00Z", "closed_at": "2023-11-03T00:02:28Z"}, "comments": 18, "created_at": "2023-11-01T14:50:28Z", "updated_at": "2025-01-31T04:25:44Z", "closed_at": "2023-11-02T23:54:20Z", "assignee": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/pmndrs/zustand/pulls/2170", "html_url": "https://github.com/pmndrs/zustand/pull/2170", "diff_url": "https://github.com/pmndrs/zustand/pull/2170.diff", "patch_url": "https://github.com/pmndrs/zustand/pull/2170.patch", "merged_at": "2023-11-02T23:54:20Z"}, "body": "## Related Issues or Discussions\r\n\r\nFixes #2163\r\n\r\n## Summary\r\n\r\nThe types for should be under each type of import. For instance \"import\", \"module\", \"require\" and \"default\"\r\n\r\n## Check List\r\n\r\n- [x] `yarn run prettier` for formatting code and docs\r\n", "closed_by": {"login": "dai-shi", "id": 490574, "node_id": "MDQ6VXNlcjQ5MDU3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/490574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dai-shi", "html_url": "https://github.com/dai-shi", "followers_url": "https://api.github.com/users/dai-shi/followers", "following_url": "https://api.github.com/users/dai-shi/following{/other_user}", "gists_url": "https://api.github.com/users/dai-shi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dai-shi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dai-shi/subscriptions", "organizations_url": "https://api.github.com/users/dai-shi/orgs", "repos_url": "https://api.github.com/users/dai-shi/repos", "events_url": "https://api.github.com/users/dai-shi/events{/privacy}", "received_events_url": "https://api.github.com/users/dai-shi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/2170/reactions", "total_count": 8, "+1": 0, "-1": 1, "laugh": 0, "hooray": 0, "confused": 0, "heart": 7, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/2170/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/77", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/77/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/77/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/77/events", "html_url": "https://github.com/pmndrs/zustand/issues/77", "id": 516937727, "node_id": "MDU6SXNzdWU1MTY5Mzc3Mjc=", "number": 77, "title": "[devtools] doesn't log actions since v2", "user": {"login": "pzi", "id": 2037851, "node_id": "MDQ6VXNlcjIwMzc4NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/2037851?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pzi", "html_url": "https://github.com/pzi", "followers_url": "https://api.github.com/users/pzi/followers", "following_url": "https://api.github.com/users/pzi/following{/other_user}", "gists_url": "https://api.github.com/users/pzi/gists{/gist_id}", "starred_url": "https://api.github.com/users/pzi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pzi/subscriptions", "organizations_url": "https://api.github.com/users/pzi/orgs", "repos_url": "https://api.github.com/users/pzi/repos", "events_url": "https://api.github.com/users/pzi/events{/privacy}", "received_events_url": "https://api.github.com/users/pzi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 20, "created_at": "2019-11-04T02:55:17Z", "updated_at": "2020-08-26T13:59:30Z", "closed_at": "2020-08-26T13:59:30Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "When updating from 1.0.7 to 2.2.1, I lose the tracking of all actions in the Redux devtools:\r\n\r\n## 2.2.1\r\n![image](https://user-images.githubusercontent.com/2037851/68097209-a2e47c80-fef0-11e9-9495-0830ef579b87.png)\r\n\r\n## 1.0.7\r\n![image](https://user-images.githubusercontent.com/2037851/68097276-1b4b3d80-fef1-11e9-89db-4f67f84c5867.png)\r\n\r\nThe app works just fine and the store updates correctly when using the app, it just doesn't log out the commits any more.\r\n\r\nUsing it like:\r\n\r\n```ts\r\nimport create, { StateCreator } from 'zustand'\r\nimport { devtools } from 'zustand/middleware'\r\n\r\nexport const DefaultStoreState: DefaultStateGetters = {\r\n  lastDataUpdate: new Date(),\r\n  loading: false,\r\n  showDrawer: false,\r\n  message: null,\r\n  ...\r\n}\r\n\r\nconst store: StateCreator<DefaultState> = (set, get) => ({\r\n  ...DefaultStoreState,\r\n  ...\r\n})\r\n\r\nexport const [useStore, Store] = create<DefaultState>(devtools(store, 'WACHS App Store'))\r\n```\r\n\r\nAny pointers would be appreciated. Let me know if you need more detail and I will update this post.\r\n\r\nCheers & thanks\r\nPatrik", "closed_by": {"login": "dai-shi", "id": 490574, "node_id": "MDQ6VXNlcjQ5MDU3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/490574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dai-shi", "html_url": "https://github.com/dai-shi", "followers_url": "https://api.github.com/users/dai-shi/followers", "following_url": "https://api.github.com/users/dai-shi/following{/other_user}", "gists_url": "https://api.github.com/users/dai-shi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dai-shi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dai-shi/subscriptions", "organizations_url": "https://api.github.com/users/dai-shi/orgs", "repos_url": "https://api.github.com/users/dai-shi/repos", "events_url": "https://api.github.com/users/dai-shi/events{/privacy}", "received_events_url": "https://api.github.com/users/dai-shi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/77/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/77/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/2576", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/2576/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/2576/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/2576/events", "html_url": "https://github.com/pmndrs/zustand/pull/2576", "id": 2329858595, "node_id": "PR_kwDOCr-ZC85xOz6p", "number": 2576, "title": "Install only stable versions on fresh installs", "user": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [{"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 3, "created_at": "2024-06-02T20:50:43Z", "updated_at": "2024-06-04T05:53:42Z", "closed_at": "2024-06-04T05:53:35Z", "assignee": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/pmndrs/zustand/pulls/2576", "html_url": "https://github.com/pmndrs/zustand/pull/2576", "diff_url": "https://github.com/pmndrs/zustand/pull/2576.diff", "patch_url": "https://github.com/pmndrs/zustand/pull/2576.patch", "merged_at": null}, "body": "## Summary\r\n\r\nAvoid install react 19 on fresh installs\r\n\r\n## Check List\r\n\r\n- [x] `pnpm run prettier` for formatting code and docs\r\n", "closed_by": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/2576/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/2576/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/47", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/47/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/47/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/47/events", "html_url": "https://github.com/pmndrs/zustand/issues/47", "id": 467423090, "node_id": "MDU6SXNzdWU0Njc0MjMwOTA=", "number": 47, "title": "Using zustand/middleware warns about enabling devtools in tests", "user": {"login": "timkindberg", "id": 168046, "node_id": "MDQ6VXNlcjE2ODA0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/168046?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timkindberg", "html_url": "https://github.com/timkindberg", "followers_url": "https://api.github.com/users/timkindberg/followers", "following_url": "https://api.github.com/users/timkindberg/following{/other_user}", "gists_url": "https://api.github.com/users/timkindberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/timkindberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timkindberg/subscriptions", "organizations_url": "https://api.github.com/users/timkindberg/orgs", "repos_url": "https://api.github.com/users/timkindberg/repos", "events_url": "https://api.github.com/users/timkindberg/events{/privacy}", "received_events_url": "https://api.github.com/users/timkindberg/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 13, "created_at": "2019-07-12T13:46:43Z", "updated_at": "2023-05-29T21:52:31Z", "closed_at": "2023-05-29T21:52:31Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I'm getting superfluous warnings during tests:\r\n```\r\n  \u25cf Console\r\n\r\n    console.warn node_modules/zustand/middleware.cjs.js:50\r\n      Please install/enable Redux devtools extension\r\n    console.warn node_modules/zustand/middleware.cjs.js:50\r\n      Please install/enable Redux devtools extension\r\n    console.warn node_modules/zustand/middleware.cjs.js:50\r\n      Please install/enable Redux devtools extension\r\n    console.warn node_modules/zustand/middleware.cjs.js:50\r\n      Please install/enable Redux devtools extension\r\n    console.warn node_modules/zustand/middleware.cjs.js:50\r\n      Please install/enable Redux devtools extension\r\n```\r\nBecause obviously it's not finding devtools. Maybe we can either disable this warning completely (I'd be fine with that), or put it behind a `if (NODE_ENV === 'development')` check or something.", "closed_by": {"login": "dai-shi", "id": 490574, "node_id": "MDQ6VXNlcjQ5MDU3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/490574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dai-shi", "html_url": "https://github.com/dai-shi", "followers_url": "https://api.github.com/users/dai-shi/followers", "following_url": "https://api.github.com/users/dai-shi/following{/other_user}", "gists_url": "https://api.github.com/users/dai-shi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dai-shi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dai-shi/subscriptions", "organizations_url": "https://api.github.com/users/dai-shi/orgs", "repos_url": "https://api.github.com/users/dai-shi/repos", "events_url": "https://api.github.com/users/dai-shi/events{/privacy}", "received_events_url": "https://api.github.com/users/dai-shi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/47/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/47/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/123", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/123/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/123/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/123/events", "html_url": "https://github.com/pmndrs/zustand/issues/123", "id": 646776727, "node_id": "MDU6SXNzdWU2NDY3NzY3Mjc=", "number": 123, "title": "Selectors defined outside of a render function do not always return the associated store value", "user": {"login": "andrew-me", "id": 2700262, "node_id": "MDQ6VXNlcjI3MDAyNjI=", "avatar_url": "https://avatars.githubusercontent.com/u/2700262?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andrew-me", "html_url": "https://github.com/andrew-me", "followers_url": "https://api.github.com/users/andrew-me/followers", "following_url": "https://api.github.com/users/andrew-me/following{/other_user}", "gists_url": "https://api.github.com/users/andrew-me/gists{/gist_id}", "starred_url": "https://api.github.com/users/andrew-me/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andrew-me/subscriptions", "organizations_url": "https://api.github.com/users/andrew-me/orgs", "repos_url": "https://api.github.com/users/andrew-me/repos", "events_url": "https://api.github.com/users/andrew-me/events{/privacy}", "received_events_url": "https://api.github.com/users/andrew-me/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 12, "created_at": "2020-06-27T22:09:34Z", "updated_at": "2020-09-08T18:34:04Z", "closed_at": "2020-09-07T22:54:32Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I'm having a problem where store values output via a custom hook do not all have the values from the current store. Some have values from the previous store. Here's a brief explanation, I've also pasted more complete code at the end. Appreciate your help!\r\n\r\nThe crux of the issue is that if I have my selectors in an object useStore(selectors.blah), values from the store are incorrect. If I do this useStore(state => state.blah) there's no problem. More info:\r\n\r\nI've grouped my selectors like this (living in a module with the store):\r\n\r\n```\r\nexport const selectors = {\r\n  status: (state) => state.status,\r\n  profile: (state) => state.profile,\r\n};\r\n```\r\n\r\nAnd use them like this in a custom hook in a separate module\r\n\r\n```\r\n  const status = useStore(selectors.status);\r\n  const profile = useStore(selectors.profile);\r\n\r\n```\r\n\r\nA login and a logout button change store status and profile together from\r\n\r\n```\r\n{ status: statusType.LOGGED_OUT, groups: [], profile: null }\r\n```\r\n\r\nto\r\n\r\n```\r\n{\r\n      status: statusType.LOGGED_IN,\r\n      profile: {\r\n        familyName: 'bob',\r\n      },\r\n    }\r\n```\r\n\r\nThe values output in the custom hook are not what I was expecting. status has the current value of the store (statusType.LOGGED_IN), profile has the previous value of the store (null). Odd!\r\n\r\nIf instead I do this in the custom hook\r\n\r\n```\r\n  const status = useStore((state) => state.status);\r\n  const profile = useStore(state => state.profile);\r\n```\r\n\r\nAll is well. status and profile values have the current values of the store on every render\r\n\r\nHere's some more complete code:\r\n\r\n------\r\n\r\nCustom hook\r\n\r\n```\r\nimport { useStore, selectors, mutators, statusType } from './store';\r\n\r\nexport function useCustom() {\r\n  const status = useStore(selectors.status);\r\n  const profile = useStore(selectors.profile);\r\n\r\n  const login = useStore(mutators.login);\r\n  const logout = useStore(mutators.logout);\r\n\r\n  // these do not match the current version of the store on every render\r\n  console.log('profile', profile); // null\r\n  console.log('status', status); // statusType.LOGGED_IN\r\n\r\n  switch (status) {\r\n    case statusType.LOGGED_IN:\r\n      return {\r\n        status: statusType.LOGGED_IN,\r\n        isLoggedIn: true,\r\n        profile,\r\n        logout,\r\n      };\r\n    case statusType.LOGGED_OUT:\r\n      return {\r\n        status: statusType.LOGGED_OUT,\r\n        isLoggedIn: false,\r\n        profile,\r\n        login,\r\n      };\r\n    default:\r\n      return {};\r\n  }\r\n}\r\n\r\n```\r\nstore\r\n\r\n```\r\nimport create from 'zustand';\r\n\r\nexport const statusType = {\r\n  LOADING: 'loading',\r\n  LOGGED_IN: 'logged_in',\r\n  LOGGED_OUT: 'logged_out',\r\n};\r\n\r\nexport const [useStore, store] = create((set) => ({\r\n  status: statusType.LOADING,\r\n  profile: null,\r\n  login: async () => {\r\n    set({\r\n      status: statusType.LOGGED_IN,\r\n      profile: {\r\n        familyName: 'bob',\r\n      },\r\n    });\r\n  },\r\n  logout: async () => {\r\n    set({ status: statusType.LOGGED_OUT, groups: [], profile: null });\r\n  },\r\n}));\r\n\r\nif (typeof window !== 'undefined') {\r\n  init();\r\n}\r\n\r\nasync function init() {\r\n  store.setState({\r\n    status: statusType.LOGGED_IN,\r\n    profile: {\r\n      familyName: 'bob',\r\n    },\r\n  });\r\n}\r\n\r\nexport const selectors = {\r\n  status: (state) => state.status,\r\n  profile: (state) => state.profile,\r\n};\r\n\r\nexport const mutators = {\r\n  login: (state) => state.login,\r\n  logout: (state) => state.logout,\r\n};\r\n\r\n```", "closed_by": {"login": "dai-shi", "id": 490574, "node_id": "MDQ6VXNlcjQ5MDU3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/490574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dai-shi", "html_url": "https://github.com/dai-shi", "followers_url": "https://api.github.com/users/dai-shi/followers", "following_url": "https://api.github.com/users/dai-shi/following{/other_user}", "gists_url": "https://api.github.com/users/dai-shi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dai-shi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dai-shi/subscriptions", "organizations_url": "https://api.github.com/users/dai-shi/orgs", "repos_url": "https://api.github.com/users/dai-shi/repos", "events_url": "https://api.github.com/users/dai-shi/events{/privacy}", "received_events_url": "https://api.github.com/users/dai-shi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/123/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/123/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/2877", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/2877/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/2877/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/2877/events", "html_url": "https://github.com/pmndrs/zustand/pull/2877", "id": 2713738642, "node_id": "PR_kwDOCr-ZC86D0wJ3", "number": 2877, "title": "fix(persist): fix async migrate on persist middleware", "user": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [{"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/pmndrs/zustand/milestones/37", "html_url": "https://github.com/pmndrs/zustand/milestone/37", "labels_url": "https://api.github.com/repos/pmndrs/zustand/milestones/37/labels", "id": 11978863, "node_id": "MI_kwDOCr-ZC84Atshv", "number": 37, "title": "v5.0.2", "description": "", "creator": {"login": "dai-shi", "id": 490574, "node_id": "MDQ6VXNlcjQ5MDU3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/490574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dai-shi", "html_url": "https://github.com/dai-shi", "followers_url": "https://api.github.com/users/dai-shi/followers", "following_url": "https://api.github.com/users/dai-shi/following{/other_user}", "gists_url": "https://api.github.com/users/dai-shi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dai-shi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dai-shi/subscriptions", "organizations_url": "https://api.github.com/users/dai-shi/orgs", "repos_url": "https://api.github.com/users/dai-shi/repos", "events_url": "https://api.github.com/users/dai-shi/events{/privacy}", "received_events_url": "https://api.github.com/users/dai-shi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 2, "state": "closed", "created_at": "2024-12-02T06:14:08Z", "updated_at": "2025-01-05T13:25:31Z", "due_on": "2024-12-04T00:00:00Z", "closed_at": "2025-01-05T13:25:31Z"}, "comments": 5, "created_at": "2024-12-03T01:15:49Z", "updated_at": "2025-04-17T14:42:30Z", "closed_at": "2024-12-04T13:06:36Z", "assignee": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/pmndrs/zustand/pulls/2877", "html_url": "https://github.com/pmndrs/zustand/pull/2877", "diff_url": "https://github.com/pmndrs/zustand/pull/2877.diff", "patch_url": "https://github.com/pmndrs/zustand/pull/2877.patch", "merged_at": "2024-12-04T13:06:36Z"}, "body": "## Related Bug Reports or Discussions\r\n\r\nFixes #2827\r\n\r\n## Check List\r\n\r\n- [x] `pnpm run prettier` for formatting code and docs\r\n", "closed_by": {"login": "dai-shi", "id": 490574, "node_id": "MDQ6VXNlcjQ5MDU3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/490574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dai-shi", "html_url": "https://github.com/dai-shi", "followers_url": "https://api.github.com/users/dai-shi/followers", "following_url": "https://api.github.com/users/dai-shi/following{/other_user}", "gists_url": "https://api.github.com/users/dai-shi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dai-shi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dai-shi/subscriptions", "organizations_url": "https://api.github.com/users/dai-shi/orgs", "repos_url": "https://api.github.com/users/dai-shi/repos", "events_url": "https://api.github.com/users/dai-shi/events{/privacy}", "received_events_url": "https://api.github.com/users/dai-shi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/2877/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/2877/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/1107", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/1107/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/1107/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/1107/events", "html_url": "https://github.com/pmndrs/zustand/issues/1107", "id": 1308899158, "node_id": "I_kwDOCr-ZC85OBDdW", "number": 1107, "title": "types error after update to zustand rc1 => rc2", "user": {"login": "dohomi", "id": 489221, "node_id": "MDQ6VXNlcjQ4OTIyMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/489221?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dohomi", "html_url": "https://github.com/dohomi", "followers_url": "https://api.github.com/users/dohomi/followers", "following_url": "https://api.github.com/users/dohomi/following{/other_user}", "gists_url": "https://api.github.com/users/dohomi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dohomi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dohomi/subscriptions", "organizations_url": "https://api.github.com/users/dohomi/orgs", "repos_url": "https://api.github.com/users/dohomi/repos", "events_url": "https://api.github.com/users/dohomi/events{/privacy}", "received_events_url": "https://api.github.com/users/dohomi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 9, "created_at": "2022-07-19T02:38:07Z", "updated_at": "2025-01-23T09:41:21Z", "closed_at": "2022-07-20T23:15:07Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Hello\r\n\r\nI used rc1 for a while without an issue. After updating to rc2 all my functions where I am using `shallow` are breaking:\r\n\r\n```\r\nconst villages = useStore(state => state.villages, shallow)\r\n\r\nTS2322: Type 'Village[]' is not assignable to type 'Record<string, unknown>'. \u00a0\u00a0Index signature for type 'string' is missing in type 'Village[]'.\r\n```\r\nAre there additional steps necessary to make this work?", "closed_by": {"login": "dai-shi", "id": 490574, "node_id": "MDQ6VXNlcjQ5MDU3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/490574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dai-shi", "html_url": "https://github.com/dai-shi", "followers_url": "https://api.github.com/users/dai-shi/followers", "following_url": "https://api.github.com/users/dai-shi/following{/other_user}", "gists_url": "https://api.github.com/users/dai-shi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dai-shi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dai-shi/subscriptions", "organizations_url": "https://api.github.com/users/dai-shi/orgs", "repos_url": "https://api.github.com/users/dai-shi/repos", "events_url": "https://api.github.com/users/dai-shi/events{/privacy}", "received_events_url": "https://api.github.com/users/dai-shi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/1107/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/1107/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/3187", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/3187/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/3187/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/3187/events", "html_url": "https://github.com/pmndrs/zustand/pull/3187", "id": 3246374338, "node_id": "PR_kwDOCr-ZC86fvFpg", "number": 3187, "title": "docs: update how to reset state guide", "user": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [{"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2025-07-20T13:51:19Z", "updated_at": "2025-07-20T14:26:18Z", "closed_at": "2025-07-20T14:26:07Z", "assignee": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/pmndrs/zustand/pulls/3187", "html_url": "https://github.com/pmndrs/zustand/pull/3187", "diff_url": "https://github.com/pmndrs/zustand/pull/3187.diff", "patch_url": "https://github.com/pmndrs/zustand/pull/3187.patch", "merged_at": "2025-07-20T14:26:07Z"}, "body": "## Check List\r\n\r\n- [x] `pnpm run fix` for formatting and linting code and docs\r\n", "closed_by": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/3187/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/3187/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/3406", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/3406/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/3406/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/3406/events", "html_url": "https://github.com/pmndrs/zustand/pull/3406", "id": 4000831178, "node_id": "PR_kwDOCr-ZC87G0KNC", "number": 3406, "title": "Fix indentation for actions in index.md", "user": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [{"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 5, "created_at": "2026-02-27T12:36:00Z", "updated_at": "2026-02-27T22:08:37Z", "closed_at": "2026-02-27T12:37:11Z", "assignee": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/pmndrs/zustand/pulls/3406", "html_url": "https://github.com/pmndrs/zustand/pull/3406", "diff_url": "https://github.com/pmndrs/zustand/pull/3406.diff", "patch_url": "https://github.com/pmndrs/zustand/pull/3406.patch", "merged_at": "2026-02-27T12:37:11Z"}, "body": null, "closed_by": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/3406/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/3406/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/3277", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/3277/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/3277/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/3277/events", "html_url": "https://github.com/pmndrs/zustand/pull/3277", "id": 3564063777, "node_id": "PR_kwDOCr-ZC86wRgrN", "number": 3277, "title": "docs: use curried version when using middlewares", "user": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [{"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 4, "created_at": "2025-10-29T02:20:42Z", "updated_at": "2025-10-29T02:25:50Z", "closed_at": "2025-10-29T02:25:42Z", "assignee": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/pmndrs/zustand/pulls/3277", "html_url": "https://github.com/pmndrs/zustand/pull/3277", "diff_url": "https://github.com/pmndrs/zustand/pull/3277.diff", "patch_url": "https://github.com/pmndrs/zustand/pull/3277.patch", "merged_at": "2025-10-29T02:25:42Z"}, "body": "## Check List\r\n\r\n- [x] `pnpm run fix` for formatting and linting code and docs\r\n", "closed_by": {"login": "dbritto-dev", "id": 1697714, "node_id": "MDQ6VXNlcjE2OTc3MTQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1697714?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dbritto-dev", "html_url": "https://github.com/dbritto-dev", "followers_url": "https://api.github.com/users/dbritto-dev/followers", "following_url": "https://api.github.com/users/dbritto-dev/following{/other_user}", "gists_url": "https://api.github.com/users/dbritto-dev/gists{/gist_id}", "starred_url": "https://api.github.com/users/dbritto-dev/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dbritto-dev/subscriptions", "organizations_url": "https://api.github.com/users/dbritto-dev/orgs", "repos_url": "https://api.github.com/users/dbritto-dev/repos", "events_url": "https://api.github.com/users/dbritto-dev/events{/privacy}", "received_events_url": "https://api.github.com/users/dbritto-dev/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/3277/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/3277/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/1688", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/1688/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/1688/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/1688/events", "html_url": "https://github.com/pmndrs/zustand/issues/1688", "id": 1622778683, "node_id": "I_kwDOCr-ZC85guaM7", "number": 1688, "title": "State updates within the 'onRehydrateStorage' callback using a synchronous storage API get dropped", "user": {"login": "coffeebeats", "id": 108542400, "node_id": "U_kgDOBng5wA", "avatar_url": "https://avatars.githubusercontent.com/u/108542400?v=4", "gravatar_id": "", "url": "https://api.github.com/users/coffeebeats", "html_url": "https://github.com/coffeebeats", "followers_url": "https://api.github.com/users/coffeebeats/followers", "following_url": "https://api.github.com/users/coffeebeats/following{/other_user}", "gists_url": "https://api.github.com/users/coffeebeats/gists{/gist_id}", "starred_url": "https://api.github.com/users/coffeebeats/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/coffeebeats/subscriptions", "organizations_url": "https://api.github.com/users/coffeebeats/orgs", "repos_url": "https://api.github.com/users/coffeebeats/repos", "events_url": "https://api.github.com/users/coffeebeats/events{/privacy}", "received_events_url": "https://api.github.com/users/coffeebeats/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}, {"id": 1310793695, "node_id": "MDU6TGFiZWwxMzEwNzkzNjk1", "url": "https://api.github.com/repos/pmndrs/zustand/labels/enhancement", "name": "enhancement", "color": "a2eeef", "default": true, "description": "New feature or request"}, {"id": 3008683584, "node_id": "MDU6TGFiZWwzMDA4NjgzNTg0", "url": "https://api.github.com/repos/pmndrs/zustand/labels/middleware/persist", "name": "middleware/persist", "color": "EC9FA9", "default": false, "description": "This issue is about the persist middleware"}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 3, "created_at": "2023-03-14T05:49:45Z", "updated_at": "2023-05-06T13:33:22Z", "closed_at": "2023-03-31T13:06:40Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "## Summary\r\n\r\nUpdating a store's state within the `onRehydrateStorage` callback when using a synchronous storage API results in the state update getting overwritten by the persisted state. The overwritten state update will still get persisted, however, resulting in a scenario where (1) the update failed to be applied to the current in-memory store and (2) the in-memory state and the persisted state do not match.\r\n\r\nThis issue is caused by [the return value of `createState`](https://github.com/pmndrs/zustand/blob/962f83e01599257aa6eceaaa993965a0e296d359/src/vanilla.ts#L101) (which in the synchronous case is [`stateFromStorage`](https://github.com/pmndrs/zustand/blob/962f83e01599257aa6eceaaa993965a0e296d359/src/middleware/persist.ts#L347)) overwriting [state updates within the 'onRehydrateStorage' hook](https://github.com/pmndrs/zustand/blob/962f83e01599257aa6eceaaa993965a0e296d359/src/middleware/persist.ts#L303). The in-callback updates do _initially_ update the current state (and get persisted) via [`set` and `setItem`](https://github.com/pmndrs/zustand/blob/962f83e01599257aa6eceaaa993965a0e296d359/src/middleware/persist.ts#L398-L399), but they then get lost because [`stateFromStorage` is never updated to reflect those changes](https://github.com/pmndrs/zustand/blob/962f83e01599257aa6eceaaa993965a0e296d359/src/middleware/persist.ts#L294-L306).\r\n\r\nThis doesn't occur in the asynchronous case because the `createState` function immediately returns, setting the initial state to `undefined`. Then, when the hydration promises resolve during subsequent event loop ticks, they never get overwritten because the `createState` method already returned.\r\n\r\nI believe this is also the root cause of #1527 - I tested that issue (using the sandbox provided) without `partialize` defined but it still had the same problem.\r\n\r\n## Link to reproduction\r\n\r\nI forked the sandbox from #1527 and isolated the issue described above. Feel free to toggle between (1) synchronously and asynchronously updating the state within `onRehydrateStorage` and (2) `localStorage` and `asyncStorage` to see how synchronous/asynchronous APIs affect the issue.\r\n\r\nhttps://codesandbox.io/s/zustand-4-3-x-bug-forked-45m5jq?file=/src/App.js\r\n\r\n## Check List\r\n\r\nPlease do not ask questions in issues.\r\n\r\n- [X] I've already opened a [discussion](https://github.com/pmndrs/zustand/discussions) before opening this issue, or already discussed in other media.\r\n\r\nPlease include a minimal reproduction.\r\n\r\n> N/A - I've got a reproducible example and opened a PR to fix.\r\n\r\n- [X] I've added a link to a [typescript playground](https://www.typescriptlang.org/play) or [codesandbox](https://codesandbox.io) with a minimal reproduction.\r\n\r\nPlease check this if you're filing an issue regarding TypeScript.\r\n\r\n- [X] I've read the [typescript guide](https://github.com/pmndrs/zustand/blob/main/docs/guides/typescript.md), in particular that `create` is to be used as `create<T>()(...)` and not `create<T>(...)`.\r\n", "closed_by": {"login": "dai-shi", "id": 490574, "node_id": "MDQ6VXNlcjQ5MDU3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/490574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dai-shi", "html_url": "https://github.com/dai-shi", "followers_url": "https://api.github.com/users/dai-shi/followers", "following_url": "https://api.github.com/users/dai-shi/following{/other_user}", "gists_url": "https://api.github.com/users/dai-shi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dai-shi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dai-shi/subscriptions", "organizations_url": "https://api.github.com/users/dai-shi/orgs", "repos_url": "https://api.github.com/users/dai-shi/repos", "events_url": "https://api.github.com/users/dai-shi/events{/privacy}", "received_events_url": "https://api.github.com/users/dai-shi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/1688/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/1688/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/46", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/46/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/46/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/46/events", "html_url": "https://github.com/pmndrs/zustand/issues/46", "id": 467422128, "node_id": "MDU6SXNzdWU0Njc0MjIxMjg=", "number": 46, "title": "zustand/shallow and zustand/middleware are not transpiled to cjs", "user": {"login": "timkindberg", "id": 168046, "node_id": "MDQ6VXNlcjE2ODA0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/168046?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timkindberg", "html_url": "https://github.com/timkindberg", "followers_url": "https://api.github.com/users/timkindberg/followers", "following_url": "https://api.github.com/users/timkindberg/following{/other_user}", "gists_url": "https://api.github.com/users/timkindberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/timkindberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timkindberg/subscriptions", "organizations_url": "https://api.github.com/users/timkindberg/orgs", "repos_url": "https://api.github.com/users/timkindberg/repos", "events_url": "https://api.github.com/users/timkindberg/events{/privacy}", "received_events_url": "https://api.github.com/users/timkindberg/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 3, "created_at": "2019-07-12T13:44:45Z", "updated_at": "2019-10-10T12:02:46Z", "closed_at": "2019-10-10T12:02:46Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I'm getting errors because zustand/middleware.js and zustand/shallow.js have non-supported syntax in them. \r\n\r\nThere is a .cjs.js file for each but then I have to import from 'zustand/middleware.cjs' which feels a bit weird, but it's a successful workaround.\r\n\r\nIt seems with additional non-main entries like these, they do not have the convenience of specifying `main` and `module` in the package.json like the main entry has. So the safest bet would probably be to have their `.js` file be the lowest common demoninator, commonjs.\r\n\r\nI'm not sure these two entries need to be exported as anything but commonjs.", "closed_by": {"login": "JeremyRH", "id": 12418905, "node_id": "MDQ6VXNlcjEyNDE4OTA1", "avatar_url": "https://avatars.githubusercontent.com/u/12418905?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JeremyRH", "html_url": "https://github.com/JeremyRH", "followers_url": "https://api.github.com/users/JeremyRH/followers", "following_url": "https://api.github.com/users/JeremyRH/following{/other_user}", "gists_url": "https://api.github.com/users/JeremyRH/gists{/gist_id}", "starred_url": "https://api.github.com/users/JeremyRH/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JeremyRH/subscriptions", "organizations_url": "https://api.github.com/users/JeremyRH/orgs", "repos_url": "https://api.github.com/users/JeremyRH/repos", "events_url": "https://api.github.com/users/JeremyRH/events{/privacy}", "received_events_url": "https://api.github.com/users/JeremyRH/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/46/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/46/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/pmndrs/zustand/issues/358", "repository_url": "https://api.github.com/repos/pmndrs/zustand", "labels_url": "https://api.github.com/repos/pmndrs/zustand/issues/358/labels{/name}", "comments_url": "https://api.github.com/repos/pmndrs/zustand/issues/358/comments", "events_url": "https://api.github.com/repos/pmndrs/zustand/issues/358/events", "html_url": "https://github.com/pmndrs/zustand/issues/358", "id": 855901347, "node_id": "MDU6SXNzdWU4NTU5MDEzNDc=", "number": 358, "title": "Deserialize option of PersistOptions has an incorrect type", "user": {"login": "Birbone", "id": 3794842, "node_id": "MDQ6VXNlcjM3OTQ4NDI=", "avatar_url": "https://avatars.githubusercontent.com/u/3794842?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Birbone", "html_url": "https://github.com/Birbone", "followers_url": "https://api.github.com/users/Birbone/followers", "following_url": "https://api.github.com/users/Birbone/following{/other_user}", "gists_url": "https://api.github.com/users/Birbone/gists{/gist_id}", "starred_url": "https://api.github.com/users/Birbone/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Birbone/subscriptions", "organizations_url": "https://api.github.com/users/Birbone/orgs", "repos_url": "https://api.github.com/users/Birbone/repos", "events_url": "https://api.github.com/users/Birbone/events{/privacy}", "received_events_url": "https://api.github.com/users/Birbone/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 1310793691, "node_id": "MDU6TGFiZWwxMzEwNzkzNjkx", "url": "https://api.github.com/repos/pmndrs/zustand/labels/bug", "name": "bug", "color": "d73a4a", "default": true, "description": "Something isn't working"}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 1, "created_at": "2021-04-12T12:01:17Z", "updated_at": "2021-04-12T22:43:37Z", "closed_at": "2021-04-12T22:43:37Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Option `deserialize` has the following definition in PersistOptions type:\r\n`deserialize?: (str: string) => StorageValue<S> | Promise<S>;`\r\nBecause of that asynchronous version demands to return Store value itself and not the object that incapsulates state and version of the state. While code that uses this option always expects `StorageValue<S>` to be returned out of deserialize method, for both sync and async versions.\r\nI think the type should be defined like this:\r\n`deserialize?: (str: string) => StorageValue<S> | Promise<StorageValue<S>>;`", "closed_by": {"login": "dai-shi", "id": 490574, "node_id": "MDQ6VXNlcjQ5MDU3NA==", "avatar_url": "https://avatars.githubusercontent.com/u/490574?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dai-shi", "html_url": "https://github.com/dai-shi", "followers_url": "https://api.github.com/users/dai-shi/followers", "following_url": "https://api.github.com/users/dai-shi/following{/other_user}", "gists_url": "https://api.github.com/users/dai-shi/gists{/gist_id}", "starred_url": "https://api.github.com/users/dai-shi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dai-shi/subscriptions", "organizations_url": "https://api.github.com/users/dai-shi/orgs", "repos_url": "https://api.github.com/users/dai-shi/repos", "events_url": "https://api.github.com/users/dai-shi/events{/privacy}", "received_events_url": "https://api.github.com/users/dai-shi/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/pmndrs/zustand/issues/358/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/pmndrs/zustand/issues/358/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}]}