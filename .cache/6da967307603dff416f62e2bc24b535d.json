{"d": [{"url": "https://api.github.com/repos/exceljs/exceljs/issues/984", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/984/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/984/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/984/events", "html_url": "https://github.com/exceljs/exceljs/issues/984", "id": 505057992, "node_id": "MDU6SXNzdWU1MDUwNTc5OTI=", "number": 984, "title": "exceljs 3.0.1 and Angular 8 installation issue", "user": {"login": "elementalTIMING", "id": 34397071, "node_id": "MDQ6VXNlcjM0Mzk3MDcx", "avatar_url": "https://avatars.githubusercontent.com/u/34397071?v=4", "gravatar_id": "", "url": "https://api.github.com/users/elementalTIMING", "html_url": "https://github.com/elementalTIMING", "followers_url": "https://api.github.com/users/elementalTIMING/followers", "following_url": "https://api.github.com/users/elementalTIMING/following{/other_user}", "gists_url": "https://api.github.com/users/elementalTIMING/gists{/gist_id}", "starred_url": "https://api.github.com/users/elementalTIMING/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/elementalTIMING/subscriptions", "organizations_url": "https://api.github.com/users/elementalTIMING/orgs", "repos_url": "https://api.github.com/users/elementalTIMING/repos", "events_url": "https://api.github.com/users/elementalTIMING/events{/privacy}", "received_events_url": "https://api.github.com/users/elementalTIMING/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 155905148, "node_id": "MDU6TGFiZWwxNTU5MDUxNDg=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 26, "created_at": "2019-10-10T06:12:37Z", "updated_at": "2020-06-12T12:03:10Z", "closed_at": "2020-06-12T12:03:09Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I love exceljs and with version 2 it was no problem to get it to work with Angular. But after the upgrade to the new major release 3 I can't get it to work anymore. The compilation works fine, but it breaks on starting the application with:\r\n\r\n```\r\nError: Zone.js has detected that ZoneAwarePromise `(window|global).Promise` has been overwritten.\r\nMost likely cause is that a Promise polyfill has been loaded after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. If you must load one, do so before loading zone.js.)\r\n\r\n```\r\nDoes anybody has an idea or solution how this can be fixed so that it runs smoothly again?\r\n\r\nThx and regards,\r\nLars", "closed_by": {"login": "alubbe", "id": 2028065, "node_id": "MDQ6VXNlcjIwMjgwNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/2028065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alubbe", "html_url": "https://github.com/alubbe", "followers_url": "https://api.github.com/users/alubbe/followers", "following_url": "https://api.github.com/users/alubbe/following{/other_user}", "gists_url": "https://api.github.com/users/alubbe/gists{/gist_id}", "starred_url": "https://api.github.com/users/alubbe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alubbe/subscriptions", "organizations_url": "https://api.github.com/users/alubbe/orgs", "repos_url": "https://api.github.com/users/alubbe/repos", "events_url": "https://api.github.com/users/alubbe/events{/privacy}", "received_events_url": "https://api.github.com/users/alubbe/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/984/reactions", "total_count": 15, "+1": 15, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/984/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/810", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/810/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/810/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/810/events", "html_url": "https://github.com/exceljs/exceljs/issues/810", "id": 442319580, "node_id": "MDU6SXNzdWU0NDIzMTk1ODA=", "number": 810, "title": "Can't use this package on browser", "user": {"login": "macabeus", "id": 9501115, "node_id": "MDQ6VXNlcjk1MDExMTU=", "avatar_url": "https://avatars.githubusercontent.com/u/9501115?v=4", "gravatar_id": "", "url": "https://api.github.com/users/macabeus", "html_url": "https://github.com/macabeus", "followers_url": "https://api.github.com/users/macabeus/followers", "following_url": "https://api.github.com/users/macabeus/following{/other_user}", "gists_url": "https://api.github.com/users/macabeus/gists{/gist_id}", "starred_url": "https://api.github.com/users/macabeus/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/macabeus/subscriptions", "organizations_url": "https://api.github.com/users/macabeus/orgs", "repos_url": "https://api.github.com/users/macabeus/repos", "events_url": "https://api.github.com/users/macabeus/events{/privacy}", "received_events_url": "https://api.github.com/users/macabeus/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 155905148, "node_id": "MDU6TGFiZWwxNTU5MDUxNDg=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 24, "created_at": "2019-05-09T16:16:18Z", "updated_at": "2022-12-01T08:15:13Z", "closed_at": "2020-02-26T02:16:52Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I'm trying to use `exceljs` on browser to read some XLSX files.\r\nBut, when I tried to import using\r\n\r\n```js\r\nimport Excel from 'exceljs';\r\n```\r\n\r\nI received an error on build because can't resolve `fs` module:\r\n\r\n```\r\nERROR in ./node_modules/exceljs/dist/es5/csv/csv.js\r\nModule not found: Error: Can't resolve 'fs' in '/my-project/node_modules/exceljs/dist/es5/csv'\r\nERROR in ./node_modules/exceljs/dist/es5/utils/utils.js\r\nModule not found: Error: Can't resolve 'fs' in '/my-project/node_modules/exceljs/dist/es5/utils'\r\nERROR in ./node_modules/exceljs/dist/es5/xlsx/xlsx.js\r\nModule not found: Error: Can't resolve 'fs' in '/my-project/node_modules/exceljs/dist/es5/xlsx'\r\n...\r\n```\r\n\r\nSearching about how is the correct way to import on browser, [I found this example](https://github.com/exceljs/exceljs/blob/master/spec/browser/exceljs.spec.js), and following it I tried importing using\r\n\r\n```js\r\nconst ExcelJS = require('exceljs/dist/es5/exceljs.browser');\r\n```\r\n\r\nBut this command also didn't work, returning the same errors.\r\n\r\n[Also I found a related open issue about this problem.](https://github.com/exceljs/exceljs/issues/510)\r\n\r\nThen.... is there a way to import `exceljs` on browser?", "closed_by": {"login": "Siemienik", "id": 2893099, "node_id": "MDQ6VXNlcjI4OTMwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2893099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Siemienik", "html_url": "https://github.com/Siemienik", "followers_url": "https://api.github.com/users/Siemienik/followers", "following_url": "https://api.github.com/users/Siemienik/following{/other_user}", "gists_url": "https://api.github.com/users/Siemienik/gists{/gist_id}", "starred_url": "https://api.github.com/users/Siemienik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Siemienik/subscriptions", "organizations_url": "https://api.github.com/users/Siemienik/orgs", "repos_url": "https://api.github.com/users/Siemienik/repos", "events_url": "https://api.github.com/users/Siemienik/events{/privacy}", "received_events_url": "https://api.github.com/users/Siemienik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/810/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/810/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/1168", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/1168/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/1168/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/1168/events", "html_url": "https://github.com/exceljs/exceljs/issues/1168", "id": 584397735, "node_id": "MDU6SXNzdWU1ODQzOTc3MzU=", "number": 1168, "title": "[BUG] readFile error", "user": {"login": "jshin07", "id": 25307507, "node_id": "MDQ6VXNlcjI1MzA3NTA3", "avatar_url": "https://avatars.githubusercontent.com/u/25307507?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jshin07", "html_url": "https://github.com/jshin07", "followers_url": "https://api.github.com/users/jshin07/followers", "following_url": "https://api.github.com/users/jshin07/following{/other_user}", "gists_url": "https://api.github.com/users/jshin07/gists{/gist_id}", "starred_url": "https://api.github.com/users/jshin07/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jshin07/subscriptions", "organizations_url": "https://api.github.com/users/jshin07/orgs", "repos_url": "https://api.github.com/users/jshin07/repos", "events_url": "https://api.github.com/users/jshin07/events{/privacy}", "received_events_url": "https://api.github.com/users/jshin07/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 155905149, "node_id": "MDU6TGFiZWwxNTU5MDUxNDk=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/help%20wanted", "name": "help wanted", "color": "c0e509", "default": true, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 21, "created_at": "2020-03-19T13:05:31Z", "updated_at": "2021-02-12T02:11:31Z", "closed_at": "2021-02-12T02:11:31Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "readFile gives ```TypeError: Cannot read property 'F_OK' of undefined```\r\n\r\nI have \r\n```\r\nimport { Workbook } from \"exceljs\";\r\nlet workbook = new Workbook();\r\nfiles.forEach((file) => {\r\nconst data = workbook.csv.readFile(file.name)\r\n})\r\n```\r\n\r\nTried with `workbook.xlsx.readFile` and this gives same error. \r\n\r\n\r\nI have version 3.8.1 installed. \r\n", "closed_by": {"login": "Siemienik", "id": 2893099, "node_id": "MDQ6VXNlcjI4OTMwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2893099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Siemienik", "html_url": "https://github.com/Siemienik", "followers_url": "https://api.github.com/users/Siemienik/followers", "following_url": "https://api.github.com/users/Siemienik/following{/other_user}", "gists_url": "https://api.github.com/users/Siemienik/gists{/gist_id}", "starred_url": "https://api.github.com/users/Siemienik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Siemienik/subscriptions", "organizations_url": "https://api.github.com/users/Siemienik/orgs", "repos_url": "https://api.github.com/users/Siemienik/repos", "events_url": "https://api.github.com/users/Siemienik/events{/privacy}", "received_events_url": "https://api.github.com/users/Siemienik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/1168/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/1168/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/615", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/615/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/615/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/615/events", "html_url": "https://github.com/exceljs/exceljs/issues/615", "id": 344732344, "node_id": "MDU6SXNzdWUzNDQ3MzIzNDQ=", "number": 615, "title": "Unhandled Promise rejection: Cannot read property 'then' of null ; Zone: <root> ; Task: Promise.then ; Value: TypeError: Cannot read property 'then' of null", "user": {"login": "akmalul", "id": 24810809, "node_id": "MDQ6VXNlcjI0ODEwODA5", "avatar_url": "https://avatars.githubusercontent.com/u/24810809?v=4", "gravatar_id": "", "url": "https://api.github.com/users/akmalul", "html_url": "https://github.com/akmalul", "followers_url": "https://api.github.com/users/akmalul/followers", "following_url": "https://api.github.com/users/akmalul/following{/other_user}", "gists_url": "https://api.github.com/users/akmalul/gists{/gist_id}", "starred_url": "https://api.github.com/users/akmalul/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/akmalul/subscriptions", "organizations_url": "https://api.github.com/users/akmalul/orgs", "repos_url": "https://api.github.com/users/akmalul/repos", "events_url": "https://api.github.com/users/akmalul/events{/privacy}", "received_events_url": "https://api.github.com/users/akmalul/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 155905149, "node_id": "MDU6TGFiZWwxNTU5MDUxNDk=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/help%20wanted", "name": "help wanted", "color": "c0e509", "default": true, "description": ""}, {"id": 155905152, "node_id": "MDU6TGFiZWwxNTU5MDUxNTI=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/wontfix", "name": "wontfix", "color": "ffffff", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 15, "created_at": "2018-07-26T07:49:14Z", "updated_at": "2019-04-17T11:51:58Z", "closed_at": "2019-04-17T11:51:58Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I try to use \r\n\r\n`res.attachment(monthNames[parseInt(month)-1]+\".xlsx\");\r\n        workbook.xlsx.write(res).then(function() {\r\n            res.end();\r\n        })`\r\n\r\nThe code working well in the local, but when I upload it into Ms. Azure, I got the following error.\r\n\r\n`Unhandled Promise rejection: Cannot read property 'then' of null ; Zone: <root> ; Task: Promise.then ; Value: TypeError: Cannot read property 'then' of null\r\n    at Promish (D:\\home\\site\\wwwroot\\node_modules\\promish\\lib\\promish-class.js:16:46)\r\n    at Promish.ZoneAwarePromise.then (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:616:32)\r\n    at module.exports.write (D:\\home\\site\\wwwroot\\node_modules\\exceljs\\dist\\es5\\xlsx\\xlsx.js:598:41)\r\n    at Promise.all.then (D:\\home\\site\\wwwroot\\application\\controllers\\shift_schedule.js:670:23)\r\n    at ZoneDelegate.invoke (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:242:26)\r\n    at Zone.run (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:113:43)\r\n    at D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:535:57\r\n    at ZoneDelegate.invokeTask (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:275:35)\r\n    at Zone.runTask (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:151:47)\r\n    at drainMicroTaskQueue (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:433:35)\r\n    at Immediate.ZoneTask.invoke (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:349:25)\r\n    at Immediate.data.args.(anonymous function) (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:1359:25)\r\n    at runCallback (timers.js:672:20)\r\n    at tryOnImmediate (timers.js:645:5)\r\n    at processImmediate [as _immediateCallback] (timers.js:617:5) TypeError: Cannot read property 'then' of null\r\n    at Promish (D:\\home\\site\\wwwroot\\node_modules\\promish\\lib\\promish-class.js:16:46)\r\n    at Promish.ZoneAwarePromise.then (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:616:32)\r\n    at module.exports.write (D:\\home\\site\\wwwroot\\node_modules\\exceljs\\dist\\es5\\xlsx\\xlsx.js:598:41)\r\n    at Promise.all.then (D:\\home\\site\\wwwroot\\application\\controllers\\shift_schedule.js:670:23)\r\n    at ZoneDelegate.invoke (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:242:26)\r\n    at Zone.run (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:113:43)\r\n    at D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:535:57\r\n    at ZoneDelegate.invokeTask (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:275:35)\r\n    at Zone.runTask (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:151:47)\r\n    at drainMicroTaskQueue (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:433:35)\r\n    at Immediate.ZoneTask.invoke (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:349:25)\r\n    at Immediate.data.args.(anonymous function) (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:1359:25)\r\n    at runCallback (timers.js:672:20)\r\n    at tryOnImmediate (timers.js:645:5)\r\n    at processImmediate [as _immediateCallback] (timers.js:617:5)\r\n{ Error: Uncaught (in promise): TypeError: Cannot read property 'then' of null\r\nTypeError: Cannot read property 'then' of null\r\n    at Promish (D:\\home\\site\\wwwroot\\node_modules\\promish\\lib\\promish-class.js:16:46)\r\n    at Promish.ZoneAwarePromise.then (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:616:32)\r\n    at module.exports.write (D:\\home\\site\\wwwroot\\node_modules\\exceljs\\dist\\es5\\xlsx\\xlsx.js:598:41)\r\n    at Promise.all.then (D:\\home\\site\\wwwroot\\application\\controllers\\shift_schedule.js:670:23)\r\n    at ZoneDelegate.invoke (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:242:26)\r\n    at Zone.run (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:113:43)\r\n    at D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:535:57\r\n    at ZoneDelegate.invokeTask (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:275:35)\r\n    at Zone.runTask (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:151:47)\r\n    at drainMicroTaskQueue (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:433:35)\r\n    at Immediate.ZoneTask.invoke (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:349:25)\r\n    at Immediate.data.args.(anonymous function) (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:1359:25)\r\n    at runCallback (timers.js:672:20)\r\n    at tryOnImmediate (timers.js:645:5)\r\n    at processImmediate [as _immediateCallback] (timers.js:617:5)\r\n    at AppInsightsAsyncCorrelatedErrorWrapper.ZoneAwareError (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:811:33)\r\n    at AppInsightsAsyncCorrelatedErrorWrapper (D:\\home\\site\\wwwroot\\node_modules\\applicationinsights\\out\\AutoCollection\\CorrelationContextManager.js:172:18)\r\n    at resolvePromise (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:501:31)\r\n    at D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:538:17\r\n    at ZoneDelegate.invokeTask (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:275:35)\r\n    at Zone.runTask (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:151:47)\r\n    at drainMicroTaskQueue (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:433:35)\r\n    at Immediate.ZoneTask.invoke (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:349:25)\r\n    at Immediate.data.args.(anonymous function) (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:1359:25)\r\n    at runCallback (timers.js:672:20)\r\n    at tryOnImmediate (timers.js:645:5)\r\n    at processImmediate [as _immediateCallback] (timers.js:617:5)\r\n  rejection: \r\n   TypeError: Cannot read property 'then' of null\r\n       at Promish (D:\\home\\site\\wwwroot\\node_modules\\promish\\lib\\promish-class.js:16:46)\r\n       at Promish.ZoneAwarePromise.then (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:616:32)\r\n       at module.exports.write (D:\\home\\site\\wwwroot\\node_modules\\exceljs\\dist\\es5\\xlsx\\xlsx.js:598:41)\r\n       at Promise.all.then (D:\\home\\site\\wwwroot\\application\\controllers\\shift_schedule.js:670:23)\r\n       at ZoneDelegate.invoke (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:242:26)\r\n       at Zone.run (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:113:43)\r\n       at D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:535:57\r\n       at ZoneDelegate.invokeTask (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:275:35)\r\n       at Zone.runTask (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:151:47)\r\n       at drainMicroTaskQueue (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:433:35)\r\n       at Immediate.ZoneTask.invoke (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:349:25)\r\n       at Immediate.data.args.(anonymous function) (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:1359:25)\r\n       at runCallback (timers.js:672:20)\r\n       at tryOnImmediate (timers.js:645:5)\r\n       at processImmediate [as _immediateCallback] (timers.js:617:5),\r\n  promise: \r\n   ZoneAwarePromise {\r\n     __zone_symbol__state: 0,\r\n     __zone_symbol__value: \r\n      TypeError: Cannot read property 'then' of null\r\n          at Promish (D:\\home\\site\\wwwroot\\node_modules\\promish\\lib\\promish-class.js:16:46)\r\n          at Promish.ZoneAwarePromise.then (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:616:32)\r\n          at module.exports.write (D:\\home\\site\\wwwroot\\node_modules\\exceljs\\dist\\es5\\xlsx\\xlsx.js:598:41)\r\n          at Promise.all.then (D:\\home\\site\\wwwroot\\application\\controllers\\shift_schedule.js:670:23)\r\n          at ZoneDelegate.invoke (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:242:26)\r\n          at Zone.run (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:113:43)\r\n          at D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:535:57\r\n          at ZoneDelegate.invokeTask (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:275:35)\r\n          at Zone.runTask (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:151:47)\r\n          at drainMicroTaskQueue (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:433:35)\r\n          at Immediate.ZoneTask.invoke (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:349:25)\r\n          at Immediate.data.args.(anonymous function) (D:\\home\\site\\wwwroot\\node_modules\\zone.js\\dist\\zone-node.js:1359:25)\r\n          at runCallback (timers.js:672:20)\r\n          at tryOnImmediate (timers.js:645:5)\r\n          at processImmediate [as _immediateCallback] (timers.js:617:5) },\r\n  zone: \r\n   Zone {\r\n     _properties: {},\r\n     _parent: null,\r\n     _name: '<root>',\r\n     _zoneDelegate: \r\n      ZoneDelegate {\r\n        _taskCounts: [Object],\r\n        zone: [Circular],\r\n        _parentDelegate: null,\r\n        _forkZS: null,\r\n        _forkDlgt: null,\r\n        _forkCurrZone: null,\r\n        _interceptZS: null,\r\n        _interceptDlgt: null,\r\n        _interceptCurrZone: null,\r\n        _invokeZS: null,\r\n        _invokeDlgt: null,\r\n        _invokeCurrZone: null,\r\n        _handleErrorZS: null,\r\n        _handleErrorDlgt: null,\r\n        _handleErrorCurrZone: null,\r\n        _scheduleTaskZS: null,\r\n        _scheduleTaskDlgt: null,\r\n        _scheduleTaskCurrZone: null,\r\n        _invokeTaskZS: null,\r\n        _invokeTaskDlgt: null,\r\n        _invokeTaskCurrZone: null,\r\n        _cancelTaskZS: null,\r\n        _cancelTaskDlgt: null,\r\n        _cancelTaskCurrZone: null,\r\n        _hasTaskZS: null,\r\n        _hasTaskDlgt: null,\r\n        _hasTaskCurrZone: null } },\r\n  task: \r\n   ZoneTask {\r\n     runCount: 1,\r\n     type: 'microTask',\r\n     zone: \r\n      Zone {\r\n        _properties: {},\r\n        _parent: null,\r\n        _name: '<root>',\r\n        _zoneDelegate: [Object] },\r\n     source: 'Promise.then',\r\n     data: undefined,\r\n     scheduleFn: undefined,\r\n     cancelFn: null,\r\n     callback: [Function],\r\n     invoke: [Function] } }`\r\n\r\n `at Promise.all.then (D:\\home\\site\\wwwroot\\application\\controllers\\shift_schedule.js:670:23)` is pointed `to workbook.xlsx.write(res).then(function() {`\r\n\r\nI used Node.js version 8.1.3\r\nAny help in this regard? \r\nThanks in advance", "closed_by": {"login": "Siemienik", "id": 2893099, "node_id": "MDQ6VXNlcjI4OTMwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2893099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Siemienik", "html_url": "https://github.com/Siemienik", "followers_url": "https://api.github.com/users/Siemienik/followers", "following_url": "https://api.github.com/users/Siemienik/following{/other_user}", "gists_url": "https://api.github.com/users/Siemienik/gists{/gist_id}", "starred_url": "https://api.github.com/users/Siemienik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Siemienik/subscriptions", "organizations_url": "https://api.github.com/users/Siemienik/orgs", "repos_url": "https://api.github.com/users/Siemienik/repos", "events_url": "https://api.github.com/users/Siemienik/events{/privacy}", "received_events_url": "https://api.github.com/users/Siemienik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/615/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/615/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/63", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/63/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/63/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/63/events", "html_url": "https://github.com/exceljs/exceljs/issues/63", "id": 127099960, "node_id": "MDU6SXNzdWUxMjcwOTk5NjA=", "number": 63, "title": " How to use the new stream.xlsx.WorkbookReader()", "user": {"login": "alangunning", "id": 1153886, "node_id": "MDQ6VXNlcjExNTM4ODY=", "avatar_url": "https://avatars.githubusercontent.com/u/1153886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alangunning", "html_url": "https://github.com/alangunning", "followers_url": "https://api.github.com/users/alangunning/followers", "following_url": "https://api.github.com/users/alangunning/following{/other_user}", "gists_url": "https://api.github.com/users/alangunning/gists{/gist_id}", "starred_url": "https://api.github.com/users/alangunning/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alangunning/subscriptions", "organizations_url": "https://api.github.com/users/alangunning/orgs", "repos_url": "https://api.github.com/users/alangunning/repos", "events_url": "https://api.github.com/users/alangunning/events{/privacy}", "received_events_url": "https://api.github.com/users/alangunning/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}], "state": "closed", "locked": true, "assignees": [], "milestone": null, "comments": 13, "created_at": "2016-01-17T14:59:40Z", "updated_at": "2023-09-21T22:47:50Z", "closed_at": "2023-09-21T22:47:50Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Hi,\n\nIs there any example of how to use the new stream.xlsx.WorkbookReader() where the input is a file stream? I have been unable to detect 'entry' or 'worksheet' events only can detect 'finished'.\n\nThanks,\nAlan\n", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/63/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/63/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/1063", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/1063/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/1063/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/1063/events", "html_url": "https://github.com/exceljs/exceljs/issues/1063", "id": 542493524, "node_id": "MDU6SXNzdWU1NDI0OTM1MjQ=", "number": 1063, "title": "Read from a csv file", "user": {"login": "dm-ibtissam", "id": 11412077, "node_id": "MDQ6VXNlcjExNDEyMDc3", "avatar_url": "https://avatars.githubusercontent.com/u/11412077?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dm-ibtissam", "html_url": "https://github.com/dm-ibtissam", "followers_url": "https://api.github.com/users/dm-ibtissam/followers", "following_url": "https://api.github.com/users/dm-ibtissam/following{/other_user}", "gists_url": "https://api.github.com/users/dm-ibtissam/gists{/gist_id}", "starred_url": "https://api.github.com/users/dm-ibtissam/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dm-ibtissam/subscriptions", "organizations_url": "https://api.github.com/users/dm-ibtissam/orgs", "repos_url": "https://api.github.com/users/dm-ibtissam/repos", "events_url": "https://api.github.com/users/dm-ibtissam/events{/privacy}", "received_events_url": "https://api.github.com/users/dm-ibtissam/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 155905149, "node_id": "MDU6TGFiZWwxNTU5MDUxNDk=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/help%20wanted", "name": "help wanted", "color": "c0e509", "default": true, "description": ""}], "state": "closed", "locked": true, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-12-26T09:17:19Z", "updated_at": "2023-09-21T22:35:18Z", "closed_at": "2023-09-21T22:35:18Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I have a csv file uploaded in input type file and I want to read this file the exceljs but I don't know how ? can you please help me with that.\r\nIn the documentation it's not mention how to read before prepossessing with exceljs this are the examples in the documentation :\r\n\r\n```\r\n// read from a file\r\nvar workbook = new Excel.Workbook();\r\nworkbook.csv.readFile(filename)\r\n    .then(function(worksheet) {\r\n        // use workbook or worksheet\r\n    });\r\n \r\n// read from a stream\r\nvar workbook = new Excel.Workbook();\r\nworkbook.csv.read(stream)\r\n    .then(function(worksheet) {\r\n        // use workbook or worksheet\r\n    });\r\n \r\n// pipe from stream\r\nvar workbook = new Excel.Workbook();\r\nstream.pipe(workbook.csv.createInputStream());\r\n```\r\nThis the begining of my code :\r\n\r\n```\r\nfunction ValidateFile(input) {\r\n  \r\n    var files = input.files || [];\r\n    if (!files.length) return;\r\n    var file = files[0];\r\n\r\n    fileName = file.name;\r\n    \r\n   //what to do here ???\r\n\r\n   var workbook = new Excel.Workbook();\r\n   workbook.csv.read(stream)\r\n    .then(function(worksheet) {\r\n        \r\n    });\r\n}\r\n```\r\n\r\nWich one can I use and how ?\r\nThank you.", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/1063/reactions", "total_count": 3, "+1": 3, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/1063/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/749", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/749/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/749/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/749/events", "html_url": "https://github.com/exceljs/exceljs/issues/749", "id": 412071898, "node_id": "MDU6SXNzdWU0MTIwNzE4OTg=", "number": 749, "title": "Internal Hyperlink generation is broken on Windows", "user": {"login": "jayden-chan", "id": 32287958, "node_id": "MDQ6VXNlcjMyMjg3OTU4", "avatar_url": "https://avatars.githubusercontent.com/u/32287958?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jayden-chan", "html_url": "https://github.com/jayden-chan", "followers_url": "https://api.github.com/users/jayden-chan/followers", "following_url": "https://api.github.com/users/jayden-chan/following{/other_user}", "gists_url": "https://api.github.com/users/jayden-chan/gists{/gist_id}", "starred_url": "https://api.github.com/users/jayden-chan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jayden-chan/subscriptions", "organizations_url": "https://api.github.com/users/jayden-chan/orgs", "repos_url": "https://api.github.com/users/jayden-chan/repos", "events_url": "https://api.github.com/users/jayden-chan/events{/privacy}", "received_events_url": "https://api.github.com/users/jayden-chan/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 155905148, "node_id": "MDU6TGFiZWwxNTU5MDUxNDg=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 11, "created_at": "2019-02-19T18:50:16Z", "updated_at": "2025-05-31T20:33:40Z", "closed_at": "2020-02-19T10:14:20Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "The following example works correctly on macOS/Linux, but not on Windows:\r\n\r\n```javascript\r\nconst Excel = require('exceljs');\r\nconst wb = new Excel.Workbook();\r\n\r\nwb.addWorksheet('TOC').state = 'visible';\r\nwb.addWorksheet('Test Sheet').state = 'visible';\r\n\r\nconst ws = wb.getWorksheet('TOC');\r\n\r\nws.getCell('A1').value = {\r\n  text: 'Test Hyperlink',\r\n  hyperlink: `#'Test Sheet'.A1`\r\n};\r\n\r\nwb.xlsx.writeFile('output.xlsx');\r\n```\r\n\r\nFor the hyperlink value I have tried:\r\n```\r\n* `#'Test Sheet'!A1`\r\n* `#\"Test Sheet\"!A1`\r\n* `#'Test Sheet'.A1`\r\n* `#\"Test Sheet\".A1`\r\n* `#\\\\\"Test Sheet\\\\\"!A1`\r\n* `#\\\\'Test Sheet\\\\'!A1`\r\n* `#\\\\\"Test Sheet\\\\\".A1`\r\n* `#\\\\'Test Sheet\\\\'.A1`\r\n```\r\nand a few others. None work.", "closed_by": {"login": "Siemienik", "id": 2893099, "node_id": "MDQ6VXNlcjI4OTMwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2893099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Siemienik", "html_url": "https://github.com/Siemienik", "followers_url": "https://api.github.com/users/Siemienik/followers", "following_url": "https://api.github.com/users/Siemienik/following{/other_user}", "gists_url": "https://api.github.com/users/Siemienik/gists{/gist_id}", "starred_url": "https://api.github.com/users/Siemienik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Siemienik/subscriptions", "organizations_url": "https://api.github.com/users/Siemienik/orgs", "repos_url": "https://api.github.com/users/Siemienik/repos", "events_url": "https://api.github.com/users/Siemienik/events{/privacy}", "received_events_url": "https://api.github.com/users/Siemienik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/749/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/749/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/1120", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/1120/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/1120/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/1120/events", "html_url": "https://github.com/exceljs/exceljs/issues/1120", "id": 563815730, "node_id": "MDU6SXNzdWU1NjM4MTU3MzA=", "number": 1120, "title": "[BUG] Typescript error from getColumn.eachCell", "user": {"login": "weelillad", "id": 3506248, "node_id": "MDQ6VXNlcjM1MDYyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/3506248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/weelillad", "html_url": "https://github.com/weelillad", "followers_url": "https://api.github.com/users/weelillad/followers", "following_url": "https://api.github.com/users/weelillad/following{/other_user}", "gists_url": "https://api.github.com/users/weelillad/gists{/gist_id}", "starred_url": "https://api.github.com/users/weelillad/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/weelillad/subscriptions", "organizations_url": "https://api.github.com/users/weelillad/orgs", "repos_url": "https://api.github.com/users/weelillad/repos", "events_url": "https://api.github.com/users/weelillad/events{/privacy}", "received_events_url": "https://api.github.com/users/weelillad/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 1855987643, "node_id": "MDU6TGFiZWwxODU1OTg3NjQz", "url": "https://api.github.com/repos/exceljs/exceljs/labels/Typescript", "name": "Typescript", "color": "0459c9", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 9, "created_at": "2020-02-12T07:48:18Z", "updated_at": "2021-06-16T14:38:04Z", "closed_at": "2020-10-05T12:37:55Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "## \ud83d\udc1b Bug Report\r\n\r\nTypescript error when using `Worksheet.getColumn().eachCell` - `TS2722: Cannot invoke an object which is possibly 'undefined'.`\r\n\r\nLib version: 3.8.0\r\n\r\n## Steps To Reproduce\r\n\r\nCode example\r\n\r\n```javascript\r\nconst wb = new ExcelJS.Workbook();\r\nconst ws = wb.addWorksheet('XYZ');\r\n...\r\nws.getColumn(1).eachCell((cell, rowNum) => {\r\n  cell.fill = headerFill;\r\n});\r\n```\r\n\r\n## The expected behaviour:\r\n\r\nThere should be no error.\r\n\r\n\r\n## Possible solution (optional, but very helpful):\r\n\r\nIs it possible to clearly define the functions and properties that are available from `getColumn`?", "closed_by": {"login": "alubbe", "id": 2028065, "node_id": "MDQ6VXNlcjIwMjgwNjU=", "avatar_url": "https://avatars.githubusercontent.com/u/2028065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/alubbe", "html_url": "https://github.com/alubbe", "followers_url": "https://api.github.com/users/alubbe/followers", "following_url": "https://api.github.com/users/alubbe/following{/other_user}", "gists_url": "https://api.github.com/users/alubbe/gists{/gist_id}", "starred_url": "https://api.github.com/users/alubbe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/alubbe/subscriptions", "organizations_url": "https://api.github.com/users/alubbe/orgs", "repos_url": "https://api.github.com/users/alubbe/repos", "events_url": "https://api.github.com/users/alubbe/events{/privacy}", "received_events_url": "https://api.github.com/users/alubbe/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/1120/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/1120/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/1024", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/1024/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/1024/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/1024/events", "html_url": "https://github.com/exceljs/exceljs/issues/1024", "id": 520237724, "node_id": "MDU6SXNzdWU1MjAyMzc3MjQ=", "number": 1024, "title": "Conditional formatting is lost after reading and writing", "user": {"login": "plynchnlm", "id": 6410979, "node_id": "MDQ6VXNlcjY0MTA5Nzk=", "avatar_url": "https://avatars.githubusercontent.com/u/6410979?v=4", "gravatar_id": "", "url": "https://api.github.com/users/plynchnlm", "html_url": "https://github.com/plynchnlm", "followers_url": "https://api.github.com/users/plynchnlm/followers", "following_url": "https://api.github.com/users/plynchnlm/following{/other_user}", "gists_url": "https://api.github.com/users/plynchnlm/gists{/gist_id}", "starred_url": "https://api.github.com/users/plynchnlm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/plynchnlm/subscriptions", "organizations_url": "https://api.github.com/users/plynchnlm/orgs", "repos_url": "https://api.github.com/users/plynchnlm/repos", "events_url": "https://api.github.com/users/plynchnlm/events{/privacy}", "received_events_url": "https://api.github.com/users/plynchnlm/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 9, "created_at": "2019-11-08T21:16:52Z", "updated_at": "2020-04-07T10:43:14Z", "closed_at": "2020-04-07T10:43:14Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "If I use workbook.xlsx.readFile to read in an Excel file that has conditional formatting rules, and then write the data back out with writeFile, the conditional formatting is not present in the newly written file.", "closed_by": {"login": "Siemienik", "id": 2893099, "node_id": "MDQ6VXNlcjI4OTMwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2893099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Siemienik", "html_url": "https://github.com/Siemienik", "followers_url": "https://api.github.com/users/Siemienik/followers", "following_url": "https://api.github.com/users/Siemienik/following{/other_user}", "gists_url": "https://api.github.com/users/Siemienik/gists{/gist_id}", "starred_url": "https://api.github.com/users/Siemienik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Siemienik/subscriptions", "organizations_url": "https://api.github.com/users/Siemienik/orgs", "repos_url": "https://api.github.com/users/Siemienik/repos", "events_url": "https://api.github.com/users/Siemienik/events{/privacy}", "received_events_url": "https://api.github.com/users/Siemienik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/1024/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/1024/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/669", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/669/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/669/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/669/events", "html_url": "https://github.com/exceljs/exceljs/issues/669", "id": 372049127, "node_id": "MDU6SXNzdWUzNzIwNDkxMjc=", "number": 669, "title": "Font Colors aren't Consistent", "user": {"login": "jacoblockett", "id": 24402122, "node_id": "MDQ6VXNlcjI0NDAyMTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24402122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jacoblockett", "html_url": "https://github.com/jacoblockett", "followers_url": "https://api.github.com/users/jacoblockett/followers", "following_url": "https://api.github.com/users/jacoblockett/following{/other_user}", "gists_url": "https://api.github.com/users/jacoblockett/gists{/gist_id}", "starred_url": "https://api.github.com/users/jacoblockett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jacoblockett/subscriptions", "organizations_url": "https://api.github.com/users/jacoblockett/orgs", "repos_url": "https://api.github.com/users/jacoblockett/repos", "events_url": "https://api.github.com/users/jacoblockett/events{/privacy}", "received_events_url": "https://api.github.com/users/jacoblockett/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 1189862016, "node_id": "MDU6TGFiZWwxMTg5ODYyMDE2", "url": "https://api.github.com/repos/exceljs/exceljs/labels/resolved", "name": "resolved", "color": "f4e990", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 9, "created_at": "2018-10-19T17:32:54Z", "updated_at": "2024-01-05T14:46:04Z", "closed_at": "2019-04-25T16:12:26Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I'm attempting to only change the font color of a row that is being passed into a function:\r\n\r\n  ```\r\nwrite(workbook, sheet, info, row_no, chart_path) {\r\n    const worksheet = workbook.getWorksheet(sheet)\r\n    const row = worksheet.getRow(row_no)\r\n    const no_3 = info[2].slice(0, info[2].length - 1)\r\n\r\n    row.font = {color: {argb: 'FFFF0000'}}\r\n\r\n    row.eachCell({includeEmpty: true}, (cell, col_no) => {\r\n      col_no === 1 && (cell.value = info[0])\r\n      col_no === 2 && (cell.value = info[1])\r\n      col_no > 3 && no_3.forEach((i, i_no) => {\r\n        col_no - 4 === i_no && (cell.value = i)\r\n      })\r\n    })\r\n\r\n    workbook.xlsx.writeFile(chart_path)\r\n      .then(() => console.log('done'))\r\n      .catch(error => console.error(error))\r\n  }\r\n```\r\n\r\nUnfortunately when I run this it changes every row between an arbitrary number (i.e. rows 5-14) instead of just the row I specify. Any reason for this that someone can see, or is this a bug?", "closed_by": {"login": "Siemienik", "id": 2893099, "node_id": "MDQ6VXNlcjI4OTMwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2893099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Siemienik", "html_url": "https://github.com/Siemienik", "followers_url": "https://api.github.com/users/Siemienik/followers", "following_url": "https://api.github.com/users/Siemienik/following{/other_user}", "gists_url": "https://api.github.com/users/Siemienik/gists{/gist_id}", "starred_url": "https://api.github.com/users/Siemienik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Siemienik/subscriptions", "organizations_url": "https://api.github.com/users/Siemienik/orgs", "repos_url": "https://api.github.com/users/Siemienik/repos", "events_url": "https://api.github.com/users/Siemienik/events{/privacy}", "received_events_url": "https://api.github.com/users/Siemienik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/669/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/669/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/664", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/664/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/664/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/664/events", "html_url": "https://github.com/exceljs/exceljs/issues/664", "id": 369660419, "node_id": "MDU6SXNzdWUzNjk2NjA0MTk=", "number": 664, "title": "Defined Names Break/Corrupt Excel File into Repair Mode", "user": {"login": "jacoblockett", "id": 24402122, "node_id": "MDQ6VXNlcjI0NDAyMTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24402122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jacoblockett", "html_url": "https://github.com/jacoblockett", "followers_url": "https://api.github.com/users/jacoblockett/followers", "following_url": "https://api.github.com/users/jacoblockett/following{/other_user}", "gists_url": "https://api.github.com/users/jacoblockett/gists{/gist_id}", "starred_url": "https://api.github.com/users/jacoblockett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jacoblockett/subscriptions", "organizations_url": "https://api.github.com/users/jacoblockett/orgs", "repos_url": "https://api.github.com/users/jacoblockett/repos", "events_url": "https://api.github.com/users/jacoblockett/events{/privacy}", "received_events_url": "https://api.github.com/users/jacoblockett/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 8, "created_at": "2018-10-12T18:23:57Z", "updated_at": "2020-02-24T17:29:09Z", "closed_at": "2020-02-24T17:29:09Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### *Problem*\r\n\r\nAfter a bit of time trying to figure out why my files were always being corrupted when using `workbook.xlsx.writeFile()`, I came to find out it was the named ranges (under the formulas tab) in the template I was reading that was causing the issue - more specifically, it was the way the ranges were being extracted and re-entered into a \"new\" xlsx file. To give you an idea of what I was going through, here's the xml for causing the issue:\r\n\r\n**First, the Excel Error**\r\n\r\n```\r\nExcel found unreadable content in 'test.xlsx'. Do you want to recover the contents of this \r\nworkbook? If you trust the source of this workbook, click Yes\r\n```\r\n\r\n**Working XLSX Example**\r\n```\r\n<definedName name=\"_xlnm.Print_Area\" localSheetId=\"0\">'12pm'!$C$1:$AX$12</definedName>\r\n<definedName name=\"_xlnm.Print_Titles\" localSheetId=\"0\">'12pm'!$C:$E</definedName>\r\n```\r\n\r\n**How ExcelJS is Rewriting it**\r\n```\r\n<definedName name=\"_xlnm.Print_Area\" localSheetId=\"0\">12pm!C1:AX12</definedName>\r\n<definedName name=\"_xlnm.Print_Titles\" localSheetId=\"0\">&apos;12pm&apos;!$$C:$$E</definedName>\r\n```\r\n\r\nAs you can see, the first definedName named `_xlnm.Print_Area` had all of its apostrophes and dollar signs removed. `_xlnm.Print_Titles` however is replacing every apostrophe with `&apos;` entities, and for some reason, it is adding a new dollar sign on every run of the program (i.e. if I were to run it again, it would rewrite it as `&apos;12pm&apos;!$$$C:$$$E`)\r\n\r\nFortunately, I found out the apostrophes and dollar signs aren't necessary for these kind of simple names, so the `_xlnm.Print_Area` name works perfectly fine. The unfortunate side of things is the `_xlnm.Print_Titles` corrupts the file and sends excel into repair mode, at which point it manually deletes the names causing the issue.\r\n\r\nBecause I got very impatient trying to navigate through the code to find out why the latter of the two was doing all sorts of weird stuff (hint hint cough cough document the code a little more thoroughly please ^^), I decided to hard-patch the issue with a little filter.\r\n\r\n### *Solution*\r\n\r\nIf you're having the same issue as I am, (v. 1.6.1) navigate to the `exceljs/dist/es5/xlsx/xform/book/defined-name-xform.js` file, go to line 25:25, and replace the\r\n\r\n`xmlStream.writeText(model.ranges.join(','));`\r\n\r\nwith\r\n\r\n`xmlStream.writeText(model.ranges.join(',').split('').filter(s => s !== '$' && s !== \"\\'\").join(''));`\r\n\r\nThis will remove all apostrophes and dollar signs before it writes to a file, thus making it readable by Excel.\r\n\r\nOf course this is just a temporary fix, and I hope @guyonroche will be able to fix it permanently soon.", "closed_by": {"login": "jacoblockett", "id": 24402122, "node_id": "MDQ6VXNlcjI0NDAyMTIy", "avatar_url": "https://avatars.githubusercontent.com/u/24402122?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jacoblockett", "html_url": "https://github.com/jacoblockett", "followers_url": "https://api.github.com/users/jacoblockett/followers", "following_url": "https://api.github.com/users/jacoblockett/following{/other_user}", "gists_url": "https://api.github.com/users/jacoblockett/gists{/gist_id}", "starred_url": "https://api.github.com/users/jacoblockett/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jacoblockett/subscriptions", "organizations_url": "https://api.github.com/users/jacoblockett/orgs", "repos_url": "https://api.github.com/users/jacoblockett/repos", "events_url": "https://api.github.com/users/jacoblockett/events{/privacy}", "received_events_url": "https://api.github.com/users/jacoblockett/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/664/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/664/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/1491", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/1491/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/1491/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/1491/events", "html_url": "https://github.com/exceljs/exceljs/issues/1491", "id": 715503450, "node_id": "MDU6SXNzdWU3MTU1MDM0NTA=", "number": 1491, "title": "[Q] Problem with \"Implicit intersection operator: @\"", "user": {"login": "awn70", "id": 1712315, "node_id": "MDQ6VXNlcjE3MTIzMTU=", "avatar_url": "https://avatars.githubusercontent.com/u/1712315?v=4", "gravatar_id": "", "url": "https://api.github.com/users/awn70", "html_url": "https://github.com/awn70", "followers_url": "https://api.github.com/users/awn70/followers", "following_url": "https://api.github.com/users/awn70/following{/other_user}", "gists_url": "https://api.github.com/users/awn70/gists{/gist_id}", "starred_url": "https://api.github.com/users/awn70/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/awn70/subscriptions", "organizations_url": "https://api.github.com/users/awn70/orgs", "repos_url": "https://api.github.com/users/awn70/repos", "events_url": "https://api.github.com/users/awn70/events{/privacy}", "received_events_url": "https://api.github.com/users/awn70/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 155905149, "node_id": "MDU6TGFiZWwxNTU5MDUxNDk=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/help%20wanted", "name": "help wanted", "color": "c0e509", "default": true, "description": ""}], "state": "closed", "locked": true, "assignees": [], "milestone": null, "comments": 7, "created_at": "2020-10-06T09:29:42Z", "updated_at": "2023-09-21T19:35:17Z", "closed_at": "2023-09-21T19:35:17Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I'm creating a simple sheet which includes an Excel array formula: ```SUM( ROUND( D1:D3, 0 ))```\r\nWith this code (ExcelJS 4.1.1):\r\n```\r\n     const workbook = new Excel.Workbook();\r\n     const worksheet = workbook.addWorksheet( 'test_sheet' );\r\n     worksheet.getCell( 'D1:D1' ).value = 1.2;\r\n     worksheet.getCell( 'D2:D2' ).value = 2.3;\r\n     worksheet.getCell( 'D3:D3' ).value = 5.6;\r\n     worksheet.getCell( 'D4:D4' ).value = {\r\n         formula: \"SUM(ROUND(D1:D3, 0))\",\r\n         result: 0,\r\n         date1904: false,\r\n     };\r\n     await workbook.xlsx.writeFile( \"c:\\\\temp\\\\test.xlsx\" );\r\n```\r\n\r\nWhen I open this sheet with Excel (Excel for Microsoft 365 MSO (16.0.13127.20266)) the new \"[Implicit intersection operator](https://support.microsoft.com/en-us/office/implicit-intersection-operator-ce3be07b-0101-4450-a24e-c1c999be2b34)\" will be inserted into the formula and breaks it:\r\n![Sheet-with-iio](https://user-images.githubusercontent.com/1712315/95175737-35099a80-07bc-11eb-83e3-f474cf85b629.png)\r\n\r\nNow I have to remove the inserted \"@\" and the formula works:\r\n![Sheet-without-iio](https://user-images.githubusercontent.com/1712315/95175971-7e59ea00-07bc-11eb-893f-d206fbf69d23.png)\r\n\r\nHas anybody a solution or workaround for this problem? ", "closed_by": null, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/1491/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/1491/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/882", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/882/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/882/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/882/events", "html_url": "https://github.com/exceljs/exceljs/issues/882", "id": 463185220, "node_id": "MDU6SXNzdWU0NjMxODUyMjA=", "number": 882, "title": "Process doesn't exit < 8.12.0", "user": {"login": "ghost", "id": 10137, "node_id": "MDQ6VXNlcjEwMTM3", "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ghost", "html_url": "https://github.com/ghost", "followers_url": "https://api.github.com/users/ghost/followers", "following_url": "https://api.github.com/users/ghost/following{/other_user}", "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}", "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ghost/subscriptions", "organizations_url": "https://api.github.com/users/ghost/orgs", "repos_url": "https://api.github.com/users/ghost/repos", "events_url": "https://api.github.com/users/ghost/events{/privacy}", "received_events_url": "https://api.github.com/users/ghost/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 1189722953, "node_id": "MDU6TGFiZWwxMTg5NzIyOTUz", "url": "https://api.github.com/repos/exceljs/exceljs/labels/proposal", "name": "proposal", "color": "ddaa52", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 7, "created_at": "2019-07-02T11:53:26Z", "updated_at": "2020-04-27T10:34:25Z", "closed_at": "2020-04-27T10:34:25Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "I had issue closing my app with cmd+x (SIGINT).\r\nThe process doesn't close.\r\n\r\nCould you please add a note in changelog. The problem appeares in version 1.9.1, because temp package got upgraded.\r\n\r\nhttps://www.npmjs.com/package/tmp\r\n\r\nNode Version: < 8.12.0\r\nPackage Version: > 1.9.0\r\n\r\nThanks a lot", "closed_by": {"login": "Siemienik", "id": 2893099, "node_id": "MDQ6VXNlcjI4OTMwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2893099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Siemienik", "html_url": "https://github.com/Siemienik", "followers_url": "https://api.github.com/users/Siemienik/followers", "following_url": "https://api.github.com/users/Siemienik/following{/other_user}", "gists_url": "https://api.github.com/users/Siemienik/gists{/gist_id}", "starred_url": "https://api.github.com/users/Siemienik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Siemienik/subscriptions", "organizations_url": "https://api.github.com/users/Siemienik/orgs", "repos_url": "https://api.github.com/users/Siemienik/repos", "events_url": "https://api.github.com/users/Siemienik/events{/privacy}", "received_events_url": "https://api.github.com/users/Siemienik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/882/reactions", "total_count": 2, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/882/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/446", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/446/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/446/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/446/events", "html_url": "https://github.com/exceljs/exceljs/issues/446", "id": 277623573, "node_id": "MDU6SXNzdWUyNzc2MjM1NzM=", "number": 446, "title": "Is it not possible to add image using the WorkbookWriter?", "user": {"login": "mfahmirukman", "id": 20079170, "node_id": "MDQ6VXNlcjIwMDc5MTcw", "avatar_url": "https://avatars.githubusercontent.com/u/20079170?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mfahmirukman", "html_url": "https://github.com/mfahmirukman", "followers_url": "https://api.github.com/users/mfahmirukman/followers", "following_url": "https://api.github.com/users/mfahmirukman/following{/other_user}", "gists_url": "https://api.github.com/users/mfahmirukman/gists{/gist_id}", "starred_url": "https://api.github.com/users/mfahmirukman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mfahmirukman/subscriptions", "organizations_url": "https://api.github.com/users/mfahmirukman/orgs", "repos_url": "https://api.github.com/users/mfahmirukman/repos", "events_url": "https://api.github.com/users/mfahmirukman/events{/privacy}", "received_events_url": "https://api.github.com/users/mfahmirukman/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-11-29T04:11:04Z", "updated_at": "2020-07-23T23:02:10Z", "closed_at": "2019-04-18T13:11:11Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Previously I tried using the excel file writing method. Works fine, but as the data grows so does the memory consumption. Hence the changing of writing method to streaming method.\r\n\r\nTried doing this on WorkbookWriter\r\n\r\n```\r\nvar sheet = workbook.addWorksheet('Data');\r\n        var base64Data = req.body.img.toString().replace(/^data:image\\/png;base64,/, \"\");\r\n        fs.writeFile('Tagihan/img.png', base64Data, 'base64', function(err) {\r\n            console.log(err);\r\n        })\r\nvar img1 = workbook.addImage({\r\n            filename: 'Tagihan/img.png',\r\n            extension: 'png'\r\n        });\r\n\r\n        sheet.addImage(img1, 'A1: H25');\r\n```\r\n\r\ngot this error\r\n\r\n`TypeError: workbook.addImage is not a function`\r\n\r\n", "closed_by": {"login": "Siemienik", "id": 2893099, "node_id": "MDQ6VXNlcjI4OTMwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2893099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Siemienik", "html_url": "https://github.com/Siemienik", "followers_url": "https://api.github.com/users/Siemienik/followers", "following_url": "https://api.github.com/users/Siemienik/following{/other_user}", "gists_url": "https://api.github.com/users/Siemienik/gists{/gist_id}", "starred_url": "https://api.github.com/users/Siemienik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Siemienik/subscriptions", "organizations_url": "https://api.github.com/users/Siemienik/orgs", "repos_url": "https://api.github.com/users/Siemienik/repos", "events_url": "https://api.github.com/users/Siemienik/events{/privacy}", "received_events_url": "https://api.github.com/users/Siemienik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/446/reactions", "total_count": 5, "+1": 5, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/446/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/353", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/353/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/353/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/353/events", "html_url": "https://github.com/exceljs/exceljs/issues/353", "id": 240213588, "node_id": "MDU6SXNzdWUyNDAyMTM1ODg=", "number": 353, "title": "New line in richText cell", "user": {"login": "real-lazy-coder", "id": 6243027, "node_id": "MDQ6VXNlcjYyNDMwMjc=", "avatar_url": "https://avatars.githubusercontent.com/u/6243027?v=4", "gravatar_id": "", "url": "https://api.github.com/users/real-lazy-coder", "html_url": "https://github.com/real-lazy-coder", "followers_url": "https://api.github.com/users/real-lazy-coder/followers", "following_url": "https://api.github.com/users/real-lazy-coder/following{/other_user}", "gists_url": "https://api.github.com/users/real-lazy-coder/gists{/gist_id}", "starred_url": "https://api.github.com/users/real-lazy-coder/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/real-lazy-coder/subscriptions", "organizations_url": "https://api.github.com/users/real-lazy-coder/orgs", "repos_url": "https://api.github.com/users/real-lazy-coder/repos", "events_url": "https://api.github.com/users/real-lazy-coder/events{/privacy}", "received_events_url": "https://api.github.com/users/real-lazy-coder/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 1189722953, "node_id": "MDU6TGFiZWwxMTg5NzIyOTUz", "url": "https://api.github.com/repos/exceljs/exceljs/labels/proposal", "name": "proposal", "color": "ddaa52", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 7, "created_at": "2017-07-03T16:01:34Z", "updated_at": "2020-02-26T02:17:27Z", "closed_at": "2020-02-26T02:17:27Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Take the following code:\r\n\r\n    let excel = require('exceljs')\r\n    let wb = new excel.Workbook()\r\n    let ws = wb.addWorksheet('test')\r\n\r\n    ws.getCell('B2').value = {\r\n      richText: [\r\n        {\r\n          font: {\r\n            color: {\r\n              argb: `99E391`\r\n            }\r\n          },\r\n          text: `Chuck Norris' tears cure cancer,\\n`\r\n        },\r\n        {\r\n          font: {\r\n            color: {\r\n              argb: `FF6565`\r\n            }\r\n          },\r\n          text: `too bad Chuck Norris has never cries.`\r\n        }\r\n      ]\r\n    }\r\n\r\n    wb.xlsx.writeFile('./test.xlsx').then(err => {\r\n      if (!err) {\r\n        console.log(`file written successfully.`)\r\n      } else {\r\n        console.log(`error writing file: ${err}`)\r\n      }\r\n    })\r\n\r\nThe result will be a string resembling the following (Ignoring the line break):\r\n\r\n> Chuck Norris' tears cure cancer,too bad Chuck Norris never cries.\r\n\r\nIt seems as though the line break is being stripped from the ends of the text property when the file is being written.\r\n\r\nBy simply adding a character after the \\n the line break does not get removed.  Is there a setting somewhere to turn this functionality on or off?", "closed_by": {"login": "Siemienik", "id": 2893099, "node_id": "MDQ6VXNlcjI4OTMwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2893099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Siemienik", "html_url": "https://github.com/Siemienik", "followers_url": "https://api.github.com/users/Siemienik/followers", "following_url": "https://api.github.com/users/Siemienik/following{/other_user}", "gists_url": "https://api.github.com/users/Siemienik/gists{/gist_id}", "starred_url": "https://api.github.com/users/Siemienik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Siemienik/subscriptions", "organizations_url": "https://api.github.com/users/Siemienik/orgs", "repos_url": "https://api.github.com/users/Siemienik/repos", "events_url": "https://api.github.com/users/Siemienik/events{/privacy}", "received_events_url": "https://api.github.com/users/Siemienik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/353/reactions", "total_count": 2, "+1": 2, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/353/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/226", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/226/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/226/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/226/events", "html_url": "https://github.com/exceljs/exceljs/issues/226", "id": 188789492, "node_id": "MDU6SXNzdWUxODg3ODk0OTI=", "number": 226, "title": "hide worksheet and reorder sheets", "user": {"login": "dvsoukup", "id": 13948463, "node_id": "MDQ6VXNlcjEzOTQ4NDYz", "avatar_url": "https://avatars.githubusercontent.com/u/13948463?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dvsoukup", "html_url": "https://github.com/dvsoukup", "followers_url": "https://api.github.com/users/dvsoukup/followers", "following_url": "https://api.github.com/users/dvsoukup/following{/other_user}", "gists_url": "https://api.github.com/users/dvsoukup/gists{/gist_id}", "starred_url": "https://api.github.com/users/dvsoukup/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dvsoukup/subscriptions", "organizations_url": "https://api.github.com/users/dvsoukup/orgs", "repos_url": "https://api.github.com/users/dvsoukup/repos", "events_url": "https://api.github.com/users/dvsoukup/events{/privacy}", "received_events_url": "https://api.github.com/users/dvsoukup/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 7, "created_at": "2016-11-11T15:52:52Z", "updated_at": "2020-05-20T15:09:12Z", "closed_at": "2018-06-24T13:54:27Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Hello,\r\n\r\nWould be useful if I could hide/unhide a worksheet.  Currently couldn't see an option to do so.  \r\n\r\nMaybe as some property:\r\n`var sheet = workbook.addWorksheet('My Sheet', {properties: {hidden: true}});`\r\n\r\nAlong with some function to check hidden status\r\n`workbook.getWorksheet('My Sheet').IsHidden();  // true or false`\r\n\r\nAnd to also toggle hidden status on the fly:\r\n`workbook.getWorksheet('My Sheet').hidden = true;  // or false...`\r\n\r\nWould also be useful to re-order sheets in the workbook programmatically.  I guess you could technically just \"add\" sheets in the correct order then circle back around and add data as necessary... but reordering sheets would allow you to not need to do that.", "closed_by": {"login": "guyonroche", "id": 540916, "node_id": "MDQ6VXNlcjU0MDkxNg==", "avatar_url": "https://avatars.githubusercontent.com/u/540916?v=4", "gravatar_id": "", "url": "https://api.github.com/users/guyonroche", "html_url": "https://github.com/guyonroche", "followers_url": "https://api.github.com/users/guyonroche/followers", "following_url": "https://api.github.com/users/guyonroche/following{/other_user}", "gists_url": "https://api.github.com/users/guyonroche/gists{/gist_id}", "starred_url": "https://api.github.com/users/guyonroche/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/guyonroche/subscriptions", "organizations_url": "https://api.github.com/users/guyonroche/orgs", "repos_url": "https://api.github.com/users/guyonroche/repos", "events_url": "https://api.github.com/users/guyonroche/events{/privacy}", "received_events_url": "https://api.github.com/users/guyonroche/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/226/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/226/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/59", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/59/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/59/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/59/events", "html_url": "https://github.com/exceljs/exceljs/issues/59", "id": 125355089, "node_id": "MDU6SXNzdWUxMjUzNTUwODk=", "number": 59, "title": "this.diagonal.style throws exception", "user": {"login": "cubbuk", "id": 1243896, "node_id": "MDQ6VXNlcjEyNDM4OTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1243896?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cubbuk", "html_url": "https://github.com/cubbuk", "followers_url": "https://api.github.com/users/cubbuk/followers", "following_url": "https://api.github.com/users/cubbuk/following{/other_user}", "gists_url": "https://api.github.com/users/cubbuk/gists{/gist_id}", "starred_url": "https://api.github.com/users/cubbuk/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cubbuk/subscriptions", "organizations_url": "https://api.github.com/users/cubbuk/orgs", "repos_url": "https://api.github.com/users/cubbuk/repos", "events_url": "https://api.github.com/users/cubbuk/events{/privacy}", "received_events_url": "https://api.github.com/users/cubbuk/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 1189862016, "node_id": "MDU6TGFiZWwxMTg5ODYyMDE2", "url": "https://api.github.com/repos/exceljs/exceljs/labels/resolved", "name": "resolved", "color": "f4e990", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 7, "created_at": "2016-01-07T09:17:11Z", "updated_at": "2019-01-14T22:50:15Z", "closed_at": "2019-01-14T22:50:00Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Hi,\n\nWhile reading a xlsx file I am getting the following error at exceljs/lib/xlsx/border.js:159:34:\n\nif (this.diagonal.style) {\n                                 ^\n\nTypeError: Cannot read property 'style' of undefined\nnode_modules/exceljs/lib/xlsx/border.js:159:34)\n\nseems like diagonal object is undefined, and in get xml() method if I instantiate diagonal object I can read the file. I don't know the details but this seems to work, if it seems ok could it be updated in the main code base.\n\nThanks.\n\nget xml() {\n        // return string containing the <border> definition\n        if (this._xml === undefined) {\n            if (this.left) {\n                this.diagonal = this.diagonal || {}; // if diagonal does not exist, create it.\n                var xml = ['<border'];\n                // left, right, top bottom\n                if (this.diagonal.style) {\n                    if (this.diagonal.up) {\n                        xml.push(' diagonalUp=\"1\"');\n                    }\n                    if (this.diagonal.down) {\n                        xml.push(' diagonalDown=\"1\"');\n                    }\n                }\n                xml.push('>');\n                xml.push(this.left.xml);\n                xml.push(this.right.xml);\n                xml.push(this.top.xml);\n                xml.push(this.bottom.xml);\n                xml.push(this.diagonal.xml);\n                xml.push('</border>');\n                this._xml = xml.join('');\n            } else {\n                // special case - empty border\n                this._xml = '<border><left/><right/><top/><bottom/><diagonal/></border>';\n            }\n        }\n        return this._xml;\n    },\n", "closed_by": {"login": "Siemienik", "id": 2893099, "node_id": "MDQ6VXNlcjI4OTMwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2893099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Siemienik", "html_url": "https://github.com/Siemienik", "followers_url": "https://api.github.com/users/Siemienik/followers", "following_url": "https://api.github.com/users/Siemienik/following{/other_user}", "gists_url": "https://api.github.com/users/Siemienik/gists{/gist_id}", "starred_url": "https://api.github.com/users/Siemienik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Siemienik/subscriptions", "organizations_url": "https://api.github.com/users/Siemienik/orgs", "repos_url": "https://api.github.com/users/Siemienik/repos", "events_url": "https://api.github.com/users/Siemienik/events{/privacy}", "received_events_url": "https://api.github.com/users/Siemienik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/59/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/59/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/1188", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/1188/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/1188/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/1188/events", "html_url": "https://github.com/exceljs/exceljs/issues/1188", "id": 590418038, "node_id": "MDU6SXNzdWU1OTA0MTgwMzg=", "number": 1188, "title": "[BUG] spliceRows doesnt move formulas of following rows", "user": {"login": "MR4online", "id": 17498992, "node_id": "MDQ6VXNlcjE3NDk4OTky", "avatar_url": "https://avatars.githubusercontent.com/u/17498992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MR4online", "html_url": "https://github.com/MR4online", "followers_url": "https://api.github.com/users/MR4online/followers", "following_url": "https://api.github.com/users/MR4online/following{/other_user}", "gists_url": "https://api.github.com/users/MR4online/gists{/gist_id}", "starred_url": "https://api.github.com/users/MR4online/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MR4online/subscriptions", "organizations_url": "https://api.github.com/users/MR4online/orgs", "repos_url": "https://api.github.com/users/MR4online/repos", "events_url": "https://api.github.com/users/MR4online/events{/privacy}", "received_events_url": "https://api.github.com/users/MR4online/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 6, "created_at": "2020-03-30T16:17:48Z", "updated_at": "2021-02-02T08:55:46Z", "closed_at": "2021-02-02T08:55:46Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "## \ud83d\udc1b Bug Report\r\n\r\nWhen I use spliceRows() to add more rows inside a table, all formulas in cells/rows after the added row are NOT moved.\r\nText, Style, ... of the Cells are moved, Formulas NOT!\r\n\r\nEDIT:\r\nIt looks like this happens only for rows further down. May be, when empty rows are between the inserted and the cell with formula.\r\n\r\n\r\nLib version: 3.8.1\r\n\r\n## Steps To Reproduce\r\n\r\nHave an Excel File with a row \"2\" and e.g. a SUM(D2:D5) in D6.\r\nNow use spliceRows(2, [something]).\r\nThe formula stays in D6.\r\n\r\n## The expected behaviour:\r\n\r\nThe Formular moves to D7, because I insered a row before.\r\n", "closed_by": {"login": "MR4online", "id": 17498992, "node_id": "MDQ6VXNlcjE3NDk4OTky", "avatar_url": "https://avatars.githubusercontent.com/u/17498992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MR4online", "html_url": "https://github.com/MR4online", "followers_url": "https://api.github.com/users/MR4online/followers", "following_url": "https://api.github.com/users/MR4online/following{/other_user}", "gists_url": "https://api.github.com/users/MR4online/gists{/gist_id}", "starred_url": "https://api.github.com/users/MR4online/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MR4online/subscriptions", "organizations_url": "https://api.github.com/users/MR4online/orgs", "repos_url": "https://api.github.com/users/MR4online/repos", "events_url": "https://api.github.com/users/MR4online/events{/privacy}", "received_events_url": "https://api.github.com/users/MR4online/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/1188/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/1188/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/684", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/684/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/684/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/684/events", "html_url": "https://github.com/exceljs/exceljs/issues/684", "id": 376925728, "node_id": "MDU6SXNzdWUzNzY5MjU3Mjg=", "number": 684, "title": "Hyperlink Cells Randomly Changing to String Cells", "user": {"login": "FriendOfTheNight", "id": 9436937, "node_id": "MDQ6VXNlcjk0MzY5Mzc=", "avatar_url": "https://avatars.githubusercontent.com/u/9436937?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FriendOfTheNight", "html_url": "https://github.com/FriendOfTheNight", "followers_url": "https://api.github.com/users/FriendOfTheNight/followers", "following_url": "https://api.github.com/users/FriendOfTheNight/following{/other_user}", "gists_url": "https://api.github.com/users/FriendOfTheNight/gists{/gist_id}", "starred_url": "https://api.github.com/users/FriendOfTheNight/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FriendOfTheNight/subscriptions", "organizations_url": "https://api.github.com/users/FriendOfTheNight/orgs", "repos_url": "https://api.github.com/users/FriendOfTheNight/repos", "events_url": "https://api.github.com/users/FriendOfTheNight/events{/privacy}", "received_events_url": "https://api.github.com/users/FriendOfTheNight/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 1189862016, "node_id": "MDU6TGFiZWwxMTg5ODYyMDE2", "url": "https://api.github.com/repos/exceljs/exceljs/labels/resolved", "name": "resolved", "color": "f4e990", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 6, "created_at": "2018-11-02T18:42:12Z", "updated_at": "2019-01-12T00:37:56Z", "closed_at": "2019-01-12T00:37:56Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "Hi,\r\n\r\nI'm experiencing a pretty nasty bug where hyperlink cells in rows I have added change to plain string cells after adding a new row. Most of the time adding a new row does not cause the issue but it happens maybe 1/10th of the time. It only seems to affect the cells in the last row (the last row before the new row was added).\r\n\r\nHere is how I'm adding rows:\r\n\r\n```\r\n  let book = [];\r\n  let isbn13 = '';\r\n  for (let i = 1; i <= worksheet.columnCount; i++) {\r\n    let cell = $('#add-row-display tbody td:nth-child('+i+')')[0];\r\n    if (i === 1) {\r\n      isbn13 = cell.innerText;\r\n    }\r\n    if (i === 3) {\r\n      let obj = {\r\n        isHyperlink: true,\r\n        text: cell.innerText,\r\n        hyperlink: 'https://www.amazon.com/dp/' + convISBN13toISBN10(isbn13)\r\n      };\r\n      book.push(obj);\r\n    }\r\n    else {\r\n      book.push(cell.innerText);\r\n    }\r\n  }\r\n  worksheet.addRow(book);\r\n````\r\n\r\nAs I cannot reproduce the issue consistently I'm hoping someone can point me in the right direction. I have debugged the code extensively already but can't find what's causing this to happen. Before adding a new row the relevant cell in the previous row has a ValueType of 5, isHyperlink is true, and the hyperlink is stored in the hyperlink property. After adding a new row the same cell will have a ValueType of 3, isHyperlink is false, and the hyperlink is gone.\r\n\r\nAny help with this would be greatly appreciated.\r\n\r\nThanks,\r\nBrian\r\n\r\n", "closed_by": {"login": "Siemienik", "id": 2893099, "node_id": "MDQ6VXNlcjI4OTMwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2893099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Siemienik", "html_url": "https://github.com/Siemienik", "followers_url": "https://api.github.com/users/Siemienik/followers", "following_url": "https://api.github.com/users/Siemienik/following{/other_user}", "gists_url": "https://api.github.com/users/Siemienik/gists{/gist_id}", "starred_url": "https://api.github.com/users/Siemienik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Siemienik/subscriptions", "organizations_url": "https://api.github.com/users/Siemienik/orgs", "repos_url": "https://api.github.com/users/Siemienik/repos", "events_url": "https://api.github.com/users/Siemienik/events{/privacy}", "received_events_url": "https://api.github.com/users/Siemienik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/684/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/684/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/exceljs/exceljs/issues/635", "repository_url": "https://api.github.com/repos/exceljs/exceljs", "labels_url": "https://api.github.com/repos/exceljs/exceljs/issues/635/labels{/name}", "comments_url": "https://api.github.com/repos/exceljs/exceljs/issues/635/comments", "events_url": "https://api.github.com/repos/exceljs/exceljs/issues/635/events", "html_url": "https://github.com/exceljs/exceljs/issues/635", "id": 354659263, "node_id": "MDU6SXNzdWUzNTQ2NTkyNjM=", "number": 635, "title": "The merged cells do not have enough border information", "user": {"login": "zengwe", "id": 19605999, "node_id": "MDQ6VXNlcjE5NjA1OTk5", "avatar_url": "https://avatars.githubusercontent.com/u/19605999?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zengwe", "html_url": "https://github.com/zengwe", "followers_url": "https://api.github.com/users/zengwe/followers", "following_url": "https://api.github.com/users/zengwe/following{/other_user}", "gists_url": "https://api.github.com/users/zengwe/gists{/gist_id}", "starred_url": "https://api.github.com/users/zengwe/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zengwe/subscriptions", "organizations_url": "https://api.github.com/users/zengwe/orgs", "repos_url": "https://api.github.com/users/zengwe/repos", "events_url": "https://api.github.com/users/zengwe/events{/privacy}", "received_events_url": "https://api.github.com/users/zengwe/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 155905146, "node_id": "MDU6TGFiZWwxNTU5MDUxNDY=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/bug", "name": "bug", "color": "2b077f", "default": true, "description": ""}, {"id": 155905148, "node_id": "MDU6TGFiZWwxNTU5MDUxNDg=", "url": "https://api.github.com/repos/exceljs/exceljs/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 5, "created_at": "2018-08-28T10:04:19Z", "updated_at": "2020-02-06T23:50:27Z", "closed_at": "2020-02-06T23:50:27Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "For example, I merged the cells $B$2:$C$3 and set the outer border to red. I get each cell through EXCELJS, with only the information for the top and left borders.\r\nThen I merged $B$5:$C$6 and set only the top and left borders. The resulting border information is the same as $B$2:$C$3.\r\nSo how do I know if the right and bottom borders have color settings?", "closed_by": {"login": "Siemienik", "id": 2893099, "node_id": "MDQ6VXNlcjI4OTMwOTk=", "avatar_url": "https://avatars.githubusercontent.com/u/2893099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Siemienik", "html_url": "https://github.com/Siemienik", "followers_url": "https://api.github.com/users/Siemienik/followers", "following_url": "https://api.github.com/users/Siemienik/following{/other_user}", "gists_url": "https://api.github.com/users/Siemienik/gists{/gist_id}", "starred_url": "https://api.github.com/users/Siemienik/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Siemienik/subscriptions", "organizations_url": "https://api.github.com/users/Siemienik/orgs", "repos_url": "https://api.github.com/users/Siemienik/repos", "events_url": "https://api.github.com/users/Siemienik/events{/privacy}", "received_events_url": "https://api.github.com/users/Siemienik/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/exceljs/exceljs/issues/635/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/exceljs/exceljs/issues/635/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}]}