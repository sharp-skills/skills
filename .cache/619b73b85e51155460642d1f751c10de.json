{"d": [{"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2882", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2882/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2882/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2882/events", "html_url": "https://github.com/SixLabors/ImageSharp/pull/2882", "id": 2837297120, "node_id": "PR_kwDOBE1KVM6KX40m", "number": 2882, "title": "V3 :  Fix GIF, PNG, and WEBP Edge Case Handling", "user": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 592896258, "node_id": "MDU6TGFiZWw1OTI4OTYyNTg=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/formats:png", "name": "formats:png", "color": "b60205", "default": false, "description": ""}, {"id": 592896344, "node_id": "MDU6TGFiZWw1OTI4OTYzNDQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/formats:gif", "name": "formats:gif", "color": "5319e7", "default": false, "description": ""}, {"id": 2189875089, "node_id": "MDU6TGFiZWwyMTg5ODc1MDg5", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/formats:webp", "name": "formats:webp", "color": "c61d80", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 14, "created_at": "2025-02-07T05:51:25Z", "updated_at": "2025-03-28T14:31:49Z", "closed_at": "2025-03-27T23:32:43Z", "assignee": null, "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/pulls/2882", "html_url": "https://github.com/SixLabors/ImageSharp/pull/2882", "diff_url": "https://github.com/SixLabors/ImageSharp/pull/2882.diff", "patch_url": "https://github.com/SixLabors/ImageSharp/pull/2882.patch", "merged_at": "2025-03-27T23:32:43Z"}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive pull-request title\r\n- [x] I have verified that there are no overlapping [pull-requests](https://github.com/SixLabors/ImageSharp/pulls) open\r\n- [x] I have verified that I am following the existing coding patterns and practice as demonstrated in the repository. These follow strict Stylecop rules :cop:.\r\n- [x] I have provided test coverage for my change (where applicable)\r\n\r\n### Description\r\n<!-- A description of the changes proposed in the pull-request -->\r\n\r\nFixes #2866\r\nFixes #2862\r\n\r\nThere's quite a lot going on here:\r\n- Both GIF and WEBP decoders were not handling frame disposal properly.  \r\n- GIF Decoder background color handling was incorrect.\r\n- GIF Encoder incorrectly used global palette for local root frame.\r\n- WEBP Decoder did not clear some buffers on load where it should.\r\n- PNG Encoder palette animations did not work properly\r\n- Fixed pixel sampling in Wu and Octree quantizers\r\n- Improved accuracy for matching first 512 colors in EuclidianPixelMap.\r\n\r\nI'll have to manually rework this for V4 as the code base has migrated significantly there. \r\n\r\n<!-- Thanks for contributing to ImageSharp! -->\r\n", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2882/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2882/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2455", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2455/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2455/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2455/events", "html_url": "https://github.com/SixLabors/ImageSharp/pull/2455", "id": 1709998591, "node_id": "PR_kwDOBE1KVM5QgkJl", "number": 2455, "title": "Preserve Gif color palettes and deduplicate frame pixels.", "user": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 592896344, "node_id": "MDU6TGFiZWw1OTI4OTYzNDQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/formats:gif", "name": "formats:gif", "color": "5319e7", "default": false, "description": ""}, {"id": 2246920924, "node_id": "MDU6TGFiZWwyMjQ2OTIwOTI0", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/breaking", "name": "breaking", "color": "b60205", "default": false, "description": "Signifies a binary breaking change."}, {"id": 3847263926, "node_id": "LA_kwDOBE1KVM7lUJa2", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/arch:arm64", "name": "arch:arm64", "color": "882516", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/milestones/12", "html_url": "https://github.com/SixLabors/ImageSharp/milestone/12", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/milestones/12/labels", "id": 9178988, "node_id": "MI_kwDOBE1KVM4AjA9s", "number": 12, "title": "v3.1.0", "description": "Bugfixes and minor improvements to 3.0.0. Includes breaking changes", "creator": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 32, "state": "closed", "created_at": "2023-03-20T02:53:42Z", "updated_at": "2023-12-09T10:00:34Z", "due_on": "2023-11-30T00:00:00Z", "closed_at": "2023-12-09T10:00:34Z"}, "comments": 16, "created_at": "2023-05-15T12:28:06Z", "updated_at": "2023-09-18T04:59:14Z", "closed_at": "2023-09-18T04:59:13Z", "assignee": null, "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/pulls/2455", "html_url": "https://github.com/SixLabors/ImageSharp/pull/2455", "diff_url": "https://github.com/SixLabors/ImageSharp/pull/2455.diff", "patch_url": "https://github.com/SixLabors/ImageSharp/pull/2455.patch", "merged_at": "2023-09-18T04:59:13Z"}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive pull-request title\r\n- [x] I have verified that there are no overlapping [pull-requests](https://github.com/SixLabors/ImageSharp/pulls) open\r\n- [x] I have verified that I am following the existing coding patterns and practice as demonstrated in the repository. These follow strict Stylecop rules :cop:.\r\n- [x] I have provided test coverage for my change (where applicable)\r\n\r\n### Description\r\n<!-- A description of the changes proposed in the pull-request -->\r\nThis PR does a few things. \r\n1. Reverts an issue introduced in #2289 where a naive attempt to reduce encoded output led to a loss of image data when gifs have been previously optimized.\r\n2. Introduces a new SIMD accelerated (_Avx2, Sse2, Arm64_) algorithm that deduplifies the frame index buffers following quantization to allow much better encoder compression.\r\n3. Introduces a necessary breaking change to the gif metadata and encoder (_Next release will be v3.1_) that allows taking advantage of these optimizations. Without these changes some gifs could encode at nearly 7x the input size using the default settings.\r\n\r\nFixes #635\r\nFixes #2450\r\nFixes #2198 \r\nTouches #2404 \r\n\r\nThe new deduplifier does a comparison of the quantized pixel indexes using the previous and current frame. If duplicates are detected in the current frame, then the indices are replaced with the indez of the background or transparent color. Given the increased repeats this enables better compression.\r\n\r\nThis functionality is limited to gifs encoded using global color palettes as we would require extra work to detect duplicates in local color tables and produce a map of index offsets which could be cumbersome (not to say this might come in a following PR in the future) .\r\n\r\n![Screenshot 2023-05-20 000820](https://github.com/SixLabors/ImageSharp/assets/385879/7910ad98-06be-4bb7-8040-1045769b05dc)\r\n\r\n<!-- Thanks for contributing to ImageSharp! -->\r\n", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2455/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2455/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1275", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1275/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1275/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1275/events", "html_url": "https://github.com/SixLabors/ImageSharp/issues/1275", "id": 656597552, "node_id": "MDU6SXNzdWU2NTY1OTc1NTI=", "number": 1275, "title": "JpegEncoder producing incorrect output on windows-arm (was working on beta0005)", "user": {"login": "peter-bozovic", "id": 3381521, "node_id": "MDQ6VXNlcjMzODE1MjE=", "avatar_url": "https://avatars.githubusercontent.com/u/3381521?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peter-bozovic", "html_url": "https://github.com/peter-bozovic", "followers_url": "https://api.github.com/users/peter-bozovic/followers", "following_url": "https://api.github.com/users/peter-bozovic/following{/other_user}", "gists_url": "https://api.github.com/users/peter-bozovic/gists{/gist_id}", "starred_url": "https://api.github.com/users/peter-bozovic/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peter-bozovic/subscriptions", "organizations_url": "https://api.github.com/users/peter-bozovic/orgs", "repos_url": "https://api.github.com/users/peter-bozovic/repos", "events_url": "https://api.github.com/users/peter-bozovic/events{/privacy}", "received_events_url": "https://api.github.com/users/peter-bozovic/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 471590334, "node_id": "MDU6TGFiZWw0NzE1OTAzMzQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/help%20needed", "name": "help needed", "color": "0e8a16", "default": false, "description": ""}, {"id": 1637116932, "node_id": "MDU6TGFiZWwxNjM3MTE2OTMy", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/area:aot", "name": "area:aot", "color": "bf1142", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 47, "created_at": "2020-07-14T13:06:16Z", "updated_at": "2020-08-07T12:25:50Z", "closed_at": "2020-08-07T12:25:50Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive issue title\r\n- [x] I have verified that I am running the latest version of ImageSharp\r\n- [x] I have verified if the problem exist in both `DEBUG` and `RELEASE` mode\r\n- [x] I have searched [open](https://github.com/SixLabors/ImageSharp/issues) and [closed](https://github.com/SixLabors/ImageSharp/issues?q=is%3Aissue+is%3Aclosed) issues to ensure it has not already been reported\r\n\r\n### Description\r\nI already found the issue #871 which seems to be resolved, but as the issue was for linux-arm this one is maybe specific to windows-arm.\r\nOn beta0005, the image was saving correctly, on rc3 it is kinda grayish with squares.\r\n\r\nOriginal image:\r\n![image](https://user-images.githubusercontent.com/3381521/87428515-b9e08000-c5e2-11ea-9a34-4a96f6660682.png)\r\n\r\nResized image:\r\n![image](https://user-images.githubusercontent.com/3381521/87428545-c7960580-c5e2-11ea-9c1e-bbfd757657cd.png)\r\n\r\n\r\n### Steps to Reproduce\r\nJust loading and saving the image:\r\n\r\n```\r\n// Loading originalImage\r\nusing (var targetImage = new MemoryStream())\r\n{\r\n    using (var image = SixLabors.ImageSharp.Image.Load(originalImage))\r\n    {\r\n        image.SaveAsJpeg(targetImage);\r\n    }\r\n}\r\n// Saving targetImage \r\n```\r\n\r\n### System Configuration\r\n- ImageSharp version: 1.0.0-rc0003\r\n- Other ImageSharp packages and versions: N/A\r\n- Environment (Operating system, version and so on): Windows 10 IoT Core 10.0.17763.1217\r\n- .NET Framework version: UWP - Windows 10, version 1903\r\n- Additional information: Application running on Raspberry PI 3 B / ARM architecture\r\n", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1275/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1275/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2828", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2828/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2828/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2828/events", "html_url": "https://github.com/SixLabors/ImageSharp/pull/2828", "id": 2604814012, "node_id": "PR_kwDOBE1KVM5_blj4", "number": 2828, "title": "Rewrite ChunkedMemoryStream", "user": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 4, "created_at": "2024-10-22T09:18:04Z", "updated_at": "2024-11-13T00:51:23Z", "closed_at": "2024-11-13T00:51:21Z", "assignee": null, "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/pulls/2828", "html_url": "https://github.com/SixLabors/ImageSharp/pull/2828", "diff_url": "https://github.com/SixLabors/ImageSharp/pull/2828.diff", "patch_url": "https://github.com/SixLabors/ImageSharp/pull/2828.patch", "merged_at": "2024-11-13T00:51:21Z"}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive pull-request title\r\n- [x] I have verified that there are no overlapping [pull-requests](https://github.com/SixLabors/ImageSharp/pulls) open\r\n- [x] I have verified that I am following the existing coding patterns and practice as demonstrated in the repository. These follow strict Stylecop rules :cop:.\r\n- [x] I have provided test coverage for my change (where applicable)\r\n\r\n### Description\r\n<!-- A description of the changes proposed in the pull-request -->\r\nFixes #2806 \r\n\r\n~`ChunkedMemoryStream` contained multiple writing bugs and was too costly to fix/maintain relative to performance benefits so I'm just ditching it.~\r\n\r\n- Complete rewrite of `ChunkedMemoryStream` to simplify it and fix numerous bugs. \r\n- Ensure ImageEncoder uses the chunked stream when encoding non-seekable streams.\r\n\r\n<!-- Thanks for contributing to ImageSharp! -->\r\n", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2828/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2828/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1269", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1269/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1269/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1269/events", "html_url": "https://github.com/SixLabors/ImageSharp/pull/1269", "id": 654881472, "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ3NTIwNzAw", "number": 1269, "title": "Buffered Decoding.", "user": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 471129207, "node_id": "MDU6TGFiZWw0NzExMjkyMDc=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/area:performance", "name": "area:performance", "color": "006b75", "default": false, "description": ""}, {"id": 471597544, "node_id": "MDU6TGFiZWw0NzE1OTc1NDQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/area:formats", "name": "area:formats", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/milestones/2", "html_url": "https://github.com/SixLabors/ImageSharp/milestone/2", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/milestones/2/labels", "id": 2981028, "node_id": "MDk6TWlsZXN0b25lMjk4MTAyOA==", "number": 2, "title": "1.0.0", "description": "Public release of version 1.0.0", "creator": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 35, "state": "closed", "created_at": "2017-12-15T01:39:17Z", "updated_at": "2020-08-07T12:27:16Z", "due_on": "2020-08-07T00:00:00Z", "closed_at": "2020-08-07T12:27:16Z"}, "comments": 2, "created_at": "2020-07-10T16:02:49Z", "updated_at": "2020-07-22T08:18:17Z", "closed_at": "2020-07-22T08:18:16Z", "assignee": null, "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/pulls/1269", "html_url": "https://github.com/SixLabors/ImageSharp/pull/1269", "diff_url": "https://github.com/SixLabors/ImageSharp/pull/1269.diff", "patch_url": "https://github.com/SixLabors/ImageSharp/pull/1269.patch", "merged_at": "2020-07-22T08:18:15Z"}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive pull-request title\r\n- [x] I have verified that there are no overlapping [pull-requests](https://github.com/SixLabors/ImageSharp/pulls) open\r\n- [x] I have verified that I am following matches the existing coding patterns and practice as demonstrated in the repository. These follow strict Stylecop rules :cop:.\r\n- [x] I have provided test coverage for my change (where applicable)\r\n\r\n### Description\r\nI've been tinkering about with this for a while...\r\n\r\nWe've used buffered reading via a stream wrapper in our JpegDecoder to reduce the overhead of single byte reads. You end up with a nice performance boost over native reading.\r\nhttps://github.com/SixLabors/ImageSharp/blob/c0594f7031e76ac862ea5f077d707df76ed6560b/src/ImageSharp/Formats/Jpeg/JpegDecoderCore.cs#L246\r\n\r\nHowever, the shape of the class doesn't allow for transparent reuse with other decoders which is a must. The mileage this  buffering gives for each encoder varies based upon individual implementation but the net benefit is worth the investment. \r\n\r\nWith that in mind I refactored the class to turn it into an actual stream that internally wraps our input stream and is transparent to any decoder implementation. A great benefit to this is that we can fix our buffered stream to correctly handle when a stream returns less than expected on `Read(buffer, offset, count)` Fixes #1268 .\r\n\r\nThe following  benchmarks represent our new new implementation `BufferedReadStream` vs the old jpeg wrapper `BufferedReadStreamWrap`, reading a `MemoryStream` preloaded with a buffer, and reading an array directly.\r\n\r\nThings to note:\r\n\r\nWe're a lot faster on .NET Core + than the native stream reader and ~match the wrapping implementation on those frameworks. \r\n\r\nThe performance loss against the wrapper implementation in .NETFX is due to the jitter being unable to inline the appropriate methods on a sealed, inheriting class, I've experimented with several implementations and there seems to be no way around it. Since we are testing against the fastest possible stream reading scenario and we are measuring in `us` I'm not concerned. Our decoder benchmarks on NET FX are unaffected.\r\n\r\n|                         Method |       Runtime |      Mean |      Error |    StdDev | Ratio | RatioSD | Gen 0 | Gen 1 | Gen 2 | Allocated |\r\n|------------------------------- |-------------- |----------:|-----------:|----------:|------:|--------:|------:|------:|------:|----------:|\r\n|             StandardStreamRead |    .NET 4.7.2 | 126.07 us | 126.498 us |  6.934 us |  0.99 |    0.08 |     - |     - |     - |         - |\r\n|         BufferedReadStreamRead |    .NET 4.7.2 | 118.08 us |  42.234 us |  2.315 us |  0.92 |    0.03 |     - |     - |     - |         - |\r\n|     BufferedReadStreamWrapRead |    .NET 4.7.2 |  45.33 us |  22.833 us |  1.252 us |  0.35 |    0.00 |     - |     - |     - |         - |\r\n|         StandardStreamReadByte |    .NET 4.7.2 | 128.17 us |  94.616 us |  5.186 us |  1.00 |    0.00 |     - |     - |     - |         - |\r\n|     BufferedReadStreamReadByte |    .NET 4.7.2 | 143.60 us |  92.871 us |  5.091 us |  1.12 |    0.08 |     - |     - |     - |         - |\r\n| BufferedReadStreamWrapReadByte |    .NET 4.7.2 |  32.72 us |  53.708 us |  2.944 us |  0.26 |    0.02 |     - |     - |     - |         - |\r\n|                  ArrayReadByte |    .NET 4.7.2 |  19.40 us |  12.206 us |  0.669 us |  0.15 |    0.01 |     - |     - |     - |         - |\r\n|                                |               |           |            |           |       |         |       |       |       |           |\r\n|             StandardStreamRead | .NET Core 2.1 |  84.82 us |  55.983 us |  3.069 us |  0.75 |    0.15 |     - |     - |     - |         - |\r\n|         BufferedReadStreamRead | .NET Core 2.1 |  49.62 us |  27.253 us |  1.494 us |  0.44 |    0.08 |     - |     - |     - |         - |\r\n|     BufferedReadStreamWrapRead | .NET Core 2.1 |  67.78 us |  87.546 us |  4.799 us |  0.60 |    0.10 |     - |     - |     - |         - |\r\n|         StandardStreamReadByte | .NET Core 2.1 | 115.81 us | 382.107 us | 20.945 us |  1.00 |    0.00 |     - |     - |     - |         - |\r\n|     BufferedReadStreamReadByte | .NET Core 2.1 |  16.32 us |   6.123 us |  0.336 us |  0.14 |    0.02 |     - |     - |     - |         - |\r\n| BufferedReadStreamWrapReadByte | .NET Core 2.1 |  16.68 us |   4.616 us |  0.253 us |  0.15 |    0.03 |     - |     - |     - |         - |\r\n|                  ArrayReadByte | .NET Core 2.1 |  15.13 us |  60.763 us |  3.331 us |  0.14 |    0.05 |     - |     - |     - |         - |\r\n|                                |               |           |            |           |       |         |       |       |       |           |\r\n|             StandardStreamRead | .NET Core 3.1 |  92.44 us |  88.217 us |  4.835 us |  0.94 |    0.06 |     - |     - |     - |         - |\r\n|         BufferedReadStreamRead | .NET Core 3.1 |  36.41 us |   5.923 us |  0.325 us |  0.37 |    0.00 |     - |     - |     - |         - |\r\n|     BufferedReadStreamWrapRead | .NET Core 3.1 |  37.22 us |   9.628 us |  0.528 us |  0.38 |    0.01 |     - |     - |     - |         - |\r\n|         StandardStreamReadByte | .NET Core 3.1 |  98.67 us |  20.947 us |  1.148 us |  1.00 |    0.00 |     - |     - |     - |         - |\r\n|     BufferedReadStreamReadByte | .NET Core 3.1 |  41.36 us | 123.536 us |  6.771 us |  0.42 |    0.06 |     - |     - |     - |         - |\r\n| BufferedReadStreamWrapReadByte | .NET Core 3.1 |  39.11 us |  93.894 us |  5.147 us |  0.40 |    0.05 |     - |     - |     - |         - |\r\n|                  ArrayReadByte | .NET Core 3.1 |  18.84 us |   4.684 us |  0.257 us |  0.19 |    0.00 |     - |     - |     - |         - |\r\n\r\n<!-- Thanks for contributing to ImageSharp! -->\r\n", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1269/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1269/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2753", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2753/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2753/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2753/events", "html_url": "https://github.com/SixLabors/ImageSharp/issues/2753", "id": 2361235386, "node_id": "I_kwDOBE1KVM6MvZe6", "number": 2753, "title": "Rotation of AffineTransform seems to offset the image by 1 pixel", "user": {"login": "Socolin", "id": 539620, "node_id": "MDQ6VXNlcjUzOTYyMA==", "avatar_url": "https://avatars.githubusercontent.com/u/539620?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Socolin", "html_url": "https://github.com/Socolin", "followers_url": "https://api.github.com/users/Socolin/followers", "following_url": "https://api.github.com/users/Socolin/following{/other_user}", "gists_url": "https://api.github.com/users/Socolin/gists{/gist_id}", "starred_url": "https://api.github.com/users/Socolin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Socolin/subscriptions", "organizations_url": "https://api.github.com/users/Socolin/orgs", "repos_url": "https://api.github.com/users/Socolin/repos", "events_url": "https://api.github.com/users/Socolin/events{/privacy}", "received_events_url": "https://api.github.com/users/Socolin/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 781560199, "node_id": "MDU6TGFiZWw3ODE1NjAxOTk=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/area:transforms", "name": "area:transforms", "color": "e2787a", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 29, "created_at": "2024-06-19T04:19:10Z", "updated_at": "2024-08-17T04:49:11Z", "closed_at": "2024-08-17T04:49:11Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Prerequisites\n\n- [X] I have written a descriptive issue title\n- [X] I have verified that I am running the latest version of ImageSharp\n- [X] I have verified if the problem exist in both `DEBUG` and `RELEASE` mode\n- [X] I have searched [open](https://github.com/SixLabors/ImageSharp/issues) and [closed](https://github.com/SixLabors/ImageSharp/issues?q=is%3Aissue+is%3Aclosed) issues to ensure it has not already been reported\n\n### ImageSharp version\n\n3.1.4\n\n### Other ImageSharp packages and versions\n\nImageSharp.Drawing 2.1.3\n\n### Environment (Operating system, version and so on)\n\nUbuntu 22.04, AMD Ryzen 9 7950X\n\n### .NET Framework version\n\n8.0\n\n### Description\n\nWhen using the rotation through the AffineTransformBuilder the result is not the same as the `.Rotate()` there seems to be 1 pixel offset.\r\n\r\nHere the sample code of what I would expect\r\n```cs\r\nusing (var img = new Image<Rgba32>(100, 100, Color.DimGray))\r\n{\r\n\timg.Mutate(c => c\r\n\t\t.Rotate(180)\r\n\t\t.Fill(Color.Aqua, new RectangleF(49, 49, 2, 2))\r\n\t);\r\n\timg.Save(\"rotation-rotate.png\");\r\n}\r\n```\r\nWhich give this result:\r\n![image](https://github.com/SixLabors/ImageSharp/assets/539620/33235f35-11e1-4702-a0e3-adf857f3a7ee)\r\n\n\n### Steps to Reproduce\n\nWhen I do the same with the `.Transform()` I'm getting this:\r\n\r\n```cs\r\nusing (var img = new Image<Rgb24>(100, 100, Color.DimGray))\r\n{\r\n\timg.Mutate(c => c\r\n\t\t.Transform(new  AffineTransformBuilder().AppendRotationDegrees(180))\r\n\t\t.Fill(Color.Aqua, new RectangleF(49, 49, 2, 2))\r\n\t);\r\n\timg.Save(\"rotation-center.png\");\r\n}\r\n```\r\n\r\n![image](https://github.com/SixLabors/ImageSharp/assets/539620/3b837bf0-8074-4cc6-a61f-cfaffa25815b)\r\n![image](https://github.com/SixLabors/ImageSharp/assets/539620/a1513e27-3fb8-4a31-bbb4-431b7273157f)\r\n\r\nAnother example with non centered rotation\r\n\r\n```cs\r\nfor (int i = 0; i <= 10; i++)\r\n{\r\n\r\n\tusing (var img = new Image<Rgba32>(100, 100, Color.DimGray))\r\n\t{\r\n\t\timg.Mutate(c => c\r\n\t\t\t.Transform(new  AffineTransformBuilder().AppendTranslation(new Vector2(100, 100)))\r\n\t\t\t.Transform(new  AffineTransformBuilder().AppendRotationDegrees(i * 18, new Vector2(100, 100)))\r\n\t\t\t.Fill(Color.Aqua, new RectangleF(99, 99, 2, 2))\r\n\t\t);\r\n\t\timg.Save($\"rotation-{i}.png\");\r\n\t}\r\n}\r\n```\r\n![image](https://github.com/SixLabors/ImageSharp/assets/539620/086e97bb-302a-450c-9235-1f8abf9f1c69)\r\n![image](https://github.com/SixLabors/ImageSharp/assets/539620/f30185c5-c38f-493e-9731-f3e2c14d7c7f)\r\n\r\nThe rotation seems to be centered 1 pixel too much toward the bottom-right\n\n### Images\n\n_No response_", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2753/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2753/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2414", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2414/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2414/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2414/events", "html_url": "https://github.com/SixLabors/ImageSharp/issues/2414", "id": 1640452396, "node_id": "I_kwDOBE1KVM5hx1Es", "number": 2414, "title": "Some unit tests fail with SSE disabled (i.e. scalar path only)", "user": {"login": "gfoidl", "id": 5755834, "node_id": "MDQ6VXNlcjU3NTU4MzQ=", "avatar_url": "https://avatars.githubusercontent.com/u/5755834?v=4", "gravatar_id": "", "url": "https://api.github.com/users/gfoidl", "html_url": "https://github.com/gfoidl", "followers_url": "https://api.github.com/users/gfoidl/followers", "following_url": "https://api.github.com/users/gfoidl/following{/other_user}", "gists_url": "https://api.github.com/users/gfoidl/gists{/gist_id}", "starred_url": "https://api.github.com/users/gfoidl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gfoidl/subscriptions", "organizations_url": "https://api.github.com/users/gfoidl/orgs", "repos_url": "https://api.github.com/users/gfoidl/repos", "events_url": "https://api.github.com/users/gfoidl/events{/privacy}", "received_events_url": "https://api.github.com/users/gfoidl/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 502752744, "node_id": "MDU6TGFiZWw1MDI3NTI3NDQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/unit%20tests", "name": "unit tests", "color": "006b75", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 29, "created_at": "2023-03-25T09:40:01Z", "updated_at": "2023-11-09T11:14:13Z", "closed_at": "2023-11-09T11:14:13Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Prerequisites\n\n- [X] I have written a descriptive issue title\n- [X] I have verified that I am running the latest version of ImageSharp\n- [X] I have verified if the problem exist in both `DEBUG` and `RELEASE` mode\n- [X] I have searched [open](https://github.com/SixLabors/ImageSharp/issues) and [closed](https://github.com/SixLabors/ImageSharp/issues?q=is%3Aissue+is%3Aclosed) issues to ensure it has not already been reported\n\n### ImageSharp version\n\nlocal build with latest main-branch\n\n### Other ImageSharp packages and versions\n\nnone\n\n### Environment (Operating system, version and so on)\n\nwin-x64, DOTNET_EnableSSE=0\n\n### .NET Framework version\n\nall\n\n### Description\n\nWhile hunting the bug (fixed via https://github.com/SixLabors/ImageSharp/pull/2413) I tried several things, amongst others disabling SSE for unit tests run with Visual Studio by using this https://github.com/SixLabors/ImageSharp/blob/0a1f05b746a6cf2e56b863bdc39705db20dff76a/.runsettings#L2\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"utf-8\" ?>\r\n<RunSettings>\r\n    <RunConfiguration>\r\n        <!--Used in conjunction with ActiveIssueAttribute to skip tests with known issues-->\r\n        <TestCaseFilter>category!=failing</TestCaseFilter>\r\n\r\n        <EnvironmentVariables>\r\n            <DOTNET_EnableSSE>0</DOTNET_EnableSSE>\r\n        </EnvironmentVariables>\r\n    </RunConfiguration>\r\n</RunSettings>\r\n```\r\nTests started to fail -- even when going back in the history of main-branch (so no recent commit caused these failures).\r\n\r\nTo me it looks like there are latent bugs in the scalar code-pathes. Can anyone confirm?\r\n\r\n<sub>(description copied and adapted from https://github.com/SixLabors/ImageSharp/pull/2413#issuecomment-1483340464)</sub>\r\n\n\n### Steps to Reproduce\n\nTo reproduce together with that runsettings one can try this [playlist.zip](https://github.com/SixLabors/ImageSharp/files/11066186/playlist.zip) (for filtered tests).\r\n\n\n### Images\n\n_No response_", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2414/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2414/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2082", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2082/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2082/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2082/events", "html_url": "https://github.com/SixLabors/ImageSharp/pull/2082", "id": 1198778498, "node_id": "PR_kwDOBE1KVM418gz_", "number": 2082, "title": "Memory allocation allocation tracker test helper", "user": {"login": "tocsoft", "id": 166440, "node_id": "MDQ6VXNlcjE2NjQ0MA==", "avatar_url": "https://avatars.githubusercontent.com/u/166440?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tocsoft", "html_url": "https://github.com/tocsoft", "followers_url": "https://api.github.com/users/tocsoft/followers", "following_url": "https://api.github.com/users/tocsoft/following{/other_user}", "gists_url": "https://api.github.com/users/tocsoft/gists{/gist_id}", "starred_url": "https://api.github.com/users/tocsoft/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tocsoft/subscriptions", "organizations_url": "https://api.github.com/users/tocsoft/orgs", "repos_url": "https://api.github.com/users/tocsoft/repos", "events_url": "https://api.github.com/users/tocsoft/events{/privacy}", "received_events_url": "https://api.github.com/users/tocsoft/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 502752744, "node_id": "MDU6TGFiZWw1MDI3NTI3NDQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/unit%20tests", "name": "unit tests", "color": "006b75", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/milestones/11", "html_url": "https://github.com/SixLabors/ImageSharp/milestone/11", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/milestones/11/labels", "id": 7872694, "node_id": "MI_kwDOBE1KVM4AeCC2", "number": 11, "title": "2.1.1", "description": "Bugfix release ", "creator": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 10, "state": "closed", "created_at": "2022-04-13T00:36:47Z", "updated_at": "2022-04-21T13:32:25Z", "due_on": "2022-04-20T00:00:00Z", "closed_at": "2022-04-21T13:32:25Z"}, "comments": 5, "created_at": "2022-04-09T21:36:23Z", "updated_at": "2022-04-13T00:41:28Z", "closed_at": "2022-04-12T17:28:30Z", "assignee": null, "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/pulls/2082", "html_url": "https://github.com/SixLabors/ImageSharp/pull/2082", "diff_url": "https://github.com/SixLabors/ImageSharp/pull/2082.diff", "patch_url": "https://github.com/SixLabors/ImageSharp/pull/2082.patch", "merged_at": "2022-04-12T17:28:30Z"}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive pull-request title\r\n- [x] I have verified that there are no overlapping [pull-requests](https://github.com/SixLabors/ImageSharp/pulls) open\r\n- [x] I have verified that I am following the existing coding patterns and practice as demonstrated in the repository. These follow strict Stylecop rules :cop:.\r\n- [x] I have provided test coverage for my change (where applicable)\r\n\r\n### Description\r\n\r\nThis adds some new test helpers APIs + updates the `MemoryDiagnostics` class to consistently track the memory buffers per test.\r\n\r\nAlso adds 2 helpers in to the tests \r\n1. `ValidateDisposedMemoryAllocationsAttribute` - This attributes a can be applied to test classes and `Fact`/`Theory`s directly to automatically apply the memory application tracking and validation.\r\n2. `MemoryAllocatorValidator` static class can be used in places the attribute is not appropriate, i.e. inside Remote Executors.\r\n\r\nI've also applied some fixes targeting the Decoder tests\r\n\r\nthis includes the fix from #2081 (which I will merge into this PR so we don't loose attribute of the fix) if we decide this approach is suitable...otherwise we should just merge that one.\r\n\r\n", "closed_by": {"login": "tocsoft", "id": 166440, "node_id": "MDQ6VXNlcjE2NjQ0MA==", "avatar_url": "https://avatars.githubusercontent.com/u/166440?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tocsoft", "html_url": "https://github.com/tocsoft", "followers_url": "https://api.github.com/users/tocsoft/followers", "following_url": "https://api.github.com/users/tocsoft/following{/other_user}", "gists_url": "https://api.github.com/users/tocsoft/gists{/gist_id}", "starred_url": "https://api.github.com/users/tocsoft/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tocsoft/subscriptions", "organizations_url": "https://api.github.com/users/tocsoft/orgs", "repos_url": "https://api.github.com/users/tocsoft/repos", "events_url": "https://api.github.com/users/tocsoft/events{/privacy}", "received_events_url": "https://api.github.com/users/tocsoft/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2082/reactions", "total_count": 1, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2082/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1935", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1935/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1935/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1935/events", "html_url": "https://github.com/SixLabors/ImageSharp/pull/1935", "id": 1097956851, "node_id": "PR_kwDOBE1KVM4wvKab", "number": 1935, "title": "[EXIF] Support UCS2 and 8-byte encoded string tags", "user": {"login": "IldarKhayrutdinov", "id": 29858598, "node_id": "MDQ6VXNlcjI5ODU4NTk4", "avatar_url": "https://avatars.githubusercontent.com/u/29858598?v=4", "gravatar_id": "", "url": "https://api.github.com/users/IldarKhayrutdinov", "html_url": "https://github.com/IldarKhayrutdinov", "followers_url": "https://api.github.com/users/IldarKhayrutdinov/followers", "following_url": "https://api.github.com/users/IldarKhayrutdinov/following{/other_user}", "gists_url": "https://api.github.com/users/IldarKhayrutdinov/gists{/gist_id}", "starred_url": "https://api.github.com/users/IldarKhayrutdinov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/IldarKhayrutdinov/subscriptions", "organizations_url": "https://api.github.com/users/IldarKhayrutdinov/orgs", "repos_url": "https://api.github.com/users/IldarKhayrutdinov/repos", "events_url": "https://api.github.com/users/IldarKhayrutdinov/events{/privacy}", "received_events_url": "https://api.github.com/users/IldarKhayrutdinov/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 635725423, "node_id": "MDU6TGFiZWw2MzU3MjU0MjM=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/metadata:exif", "name": "metadata:exif", "color": "0052cc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 8, "created_at": "2022-01-10T14:19:31Z", "updated_at": "2022-02-16T22:15:50Z", "closed_at": "2022-02-03T10:17:24Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/pulls/1935", "html_url": "https://github.com/SixLabors/ImageSharp/pull/1935", "diff_url": "https://github.com/SixLabors/ImageSharp/pull/1935.diff", "patch_url": "https://github.com/SixLabors/ImageSharp/pull/1935.patch", "merged_at": "2022-02-03T10:17:24Z"}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive pull-request title\r\n- [x] I have verified that there are no overlapping [pull-requests](https://github.com/SixLabors/ImageSharp/pulls) open\r\n- [x] I have verified that I am following the existing coding patterns and practice as demonstrated in the repository. These follow strict Stylecop rules :cop:.\r\n- [x] I have provided test coverage for my change (where applicable)\r\n\r\n### Description\r\n<!-- A description of the changes proposed in the pull-request -->\r\n\r\nFixes for https://github.com/SixLabors/ImageSharp/issues/1919\r\n\r\n* Support reading and writing `encoded string` tags:\r\n  * [UserComment](https://www.awaresystems.be/imaging/tiff/tifftags/privateifd/exif/usercomment.html)\r\n  * [GPSProcessingMethod](https://www.awaresystems.be/imaging/tiff/tifftags/privateifd/gps/gpsprocessingmethod.html)  \r\n  * [GPSAreaInformation](https://www.awaresystems.be/imaging/tiff/tifftags/privateifd/gps/gpsareainformation.html)\r\n* Support reading and writing `UCS2` encoded string tags:\r\n\r\n<html>\r\n<body>\r\n<!--StartFragment-->\r\n\r\n0x9c9b | 40091 | Image | Exif.Image.XPTitle | Byte | Title tag used by Windows, encoded in UCS2\r\n-- | -- | -- | -- | -- | --\r\n0x9c9c | 40092 | Image | Exif.Image.XPComment | Byte | Comment tag used by Windows, encoded in UCS2\r\n0x9c9d | 40093 | Image | Exif.Image.XPAuthor | Byte | Author tag used by Windows, encoded in UCS2\r\n0x9c9e | 40094 | Image | Exif.Image.XPKeywords | Byte | Keywords tag used by Windows, encoded in UCS2\r\n0x9c9f | 40095 | Image | Exif.Image.XPSubject | Byte | Subject tag used by Windows, encoded in UCS2\r\n\r\n<!--EndFragment-->\r\n</body>\r\n</html>\r\n\r\nSee: https://www.exiv2.org/tags.html\r\n \r\n<!-- Thanks for contributing to ImageSharp! -->\r\n\r\n#### Todo\r\n- [x] Review API\r\n- [x] Add tests\r\n- [x] Review UCS-2 encoded tags", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1935/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1935/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/871", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/871/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/871/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/871/events", "html_url": "https://github.com/SixLabors/ImageSharp/issues/871", "id": 427829011, "node_id": "MDU6SXNzdWU0Mjc4MjkwMTE=", "number": 871, "title": "JpegEncoder producing incorrect output on linux-arm (since Beta006)", "user": {"login": "qdraw", "id": 1826996, "node_id": "MDQ6VXNlcjE4MjY5OTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1826996?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qdraw", "html_url": "https://github.com/qdraw", "followers_url": "https://api.github.com/users/qdraw/followers", "following_url": "https://api.github.com/users/qdraw/following{/other_user}", "gists_url": "https://api.github.com/users/qdraw/gists{/gist_id}", "starred_url": "https://api.github.com/users/qdraw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qdraw/subscriptions", "organizations_url": "https://api.github.com/users/qdraw/orgs", "repos_url": "https://api.github.com/users/qdraw/repos", "events_url": "https://api.github.com/users/qdraw/events{/privacy}", "received_events_url": "https://api.github.com/users/qdraw/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 592896187, "node_id": "MDU6TGFiZWw1OTI4OTYxODc=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/formats:jpeg", "name": "formats:jpeg", "color": "fbca04", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 27, "created_at": "2019-04-01T17:38:27Z", "updated_at": "2019-05-29T12:37:09Z", "closed_at": "2019-05-25T00:36:24Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive issue title\r\n- [x] I have verified that I am running the latest version of ImageSharp\r\n- [x] I have verified if the problem exist in both `DEBUG` and `RELEASE` mode\r\n- [x] I have searched [open](https://github.com/SixLabors/ImageSharp/issues) and [closed](https://github.com/SixLabors/ImageSharp/issues?q=is%3Aissue+is%3Aclosed) issues to ensure it has not already been reported\r\n- [x] I have discussed this on gitter\r\n\r\n### Description\r\n\r\nI have some Image encoding issues on linux-arm. This code bellow works with `beta-0005`, but not `beta-0006` or newer. I have also tested it with the latest nightly build `1.0.0-dev002459` The issues are only visible on linux-arm, on other platforms it is working well \r\n\r\n#### UPDATE (22/05/2019, @antonfirsov)\r\nResizing is not relevant here, it's the issue of the jpeg encoder.\r\n\r\n#### TL;DR:\r\n- load jpeg -> resize -> save jpeg [PINK]\r\n- load jpeg -> save jpeg [PINK]\r\n- load png -> save jpeg [PINK]\r\n- load gif -> save jpeg [PINK]\r\n- load jpeg -> resize -> save png [OK]\r\n- load jpeg -> save png [OK]\r\n\r\nThe images are looking like this, I have tried it with multiple jpeg images\r\n![QZNU6ZQ3I6C7WV76TUB2X7C57E](https://user-images.githubusercontent.com/1826996/55347543-73324980-54b5-11e9-9c1b-7bb2ba2ed6b3.jpg)\r\nSource of the image:\r\nhttps://raw.githubusercontent.com/SixLabors/ImageSharp/master/tests/Images/Input/Jpg/baseline/Lake.jpg\r\n\r\n### Steps to Reproduce\r\n\r\nI'm initially used it for resizing but it happens also when you write the image:\r\nI'm using the following code:\r\n```cs\r\nusing (var inputStream = _iStorage.ReadStream(subPath))\r\nusing (var image = Image.Load(inputStream))\r\n{\r\n\timage.Save(outputStream, new JpegEncoder{\r\n\t\tQuality = 100,\r\n\t});\r\n\t\t\t\t\t\t\r\n\t_iStorage.WriteStream(outputStream, outputHash);  \r\n}\r\n\r\npublic Stream ReadStream(string path, int maxRead = -1)\r\n{\r\n\tif ( ! ExistFile(path) ) throw new FileNotFoundException(path);\r\n\t\r\n\tFileStream fileStream;\r\n\tfileStream = new FileStream(path, FileMode.Open, FileAccess.Read,FileShare.Read, maxRead, false);\r\n\treturn fileStream;\r\n}\r\n\r\npublic bool WriteStream(Stream stream, string path)\r\n{\r\n\tif ( !stream.CanRead ) return false;\r\n\t\r\n\tstream.Seek(0, SeekOrigin.Begin);\r\n\t\t\t\t\r\n\tusing (var fileStream = new FileStream(path, FileMode.Create, FileAccess.Write))\r\n\t{\r\n\t\tstream.CopyTo(fileStream);\r\n\t}\r\n\tstream.Dispose();\r\n\treturn true;\r\n}\r\n```\r\n\r\n### System Configuration\r\nWhen running on linux-arm as release and debug\r\n\r\n- ImageSharp version: 0006 and newer\r\n- Other ImageSharp packages and versions:\r\n- Environment (Operating system, version and so on): linux-arm\r\n- .NET Framework version: build as: 2.2.104, runtime: 2.1.8\r\n- Additional information: running on a Raspberry Pi 2 or 3\r\n\r\n-- \r\nEdit: tested based on the feedback of @JimBobSquarePants:, this produces a 'normal' image  \r\n```cs\r\nimage.Save(outputStream, new PngEncoder{\r\n    ColorType = PngColorType.Rgb, \r\n   CompressionLevel = 9, \r\n});\r\n```\r\n", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/871/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/871/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1316", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1316/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1316/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1316/events", "html_url": "https://github.com/SixLabors/ImageSharp/pull/1316", "id": 679826757, "node_id": "MDExOlB1bGxSZXF1ZXN0NDY4NDk2NjA5", "number": 1316, "title": "Fix non-seekable stream reading.", "user": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 4, "created_at": "2020-08-16T21:10:40Z", "updated_at": "2020-08-21T14:38:44Z", "closed_at": "2020-08-21T14:38:43Z", "assignee": null, "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/pulls/1316", "html_url": "https://github.com/SixLabors/ImageSharp/pull/1316", "diff_url": "https://github.com/SixLabors/ImageSharp/pull/1316.diff", "patch_url": "https://github.com/SixLabors/ImageSharp/pull/1316.patch", "merged_at": "2020-08-21T14:38:42Z"}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive pull-request title\r\n- [x] I have verified that there are no overlapping [pull-requests](https://github.com/SixLabors/ImageSharp/pulls) open\r\n- [x] I have verified that I am following matches the existing coding patterns and practice as demonstrated in the repository. These follow strict Stylecop rules :cop:.\r\n- [x] I have provided test coverage for my change (where applicable)\r\n\r\n### Description\r\nFixes our non-seekable stream loading which was attempting to use the non-supported `Length` property.\r\nhttps://github.com/SixLabors/ImageSharp/blob/8e2792e3ab96dd69d8e39255e83afdee493b1b26/src/ImageSharp/Image.FromStream.cs#L734\r\n\r\n>// If CanSeek is false, Position, Seek, Length, and SetLength should throw.\r\n\r\nhttps://source.dot.net/#System.Private.CoreLib/Stream.cs,51\r\n\r\nThe fix utilizes an internal `ChunkedMemoryStream` implementation to allow pooling of byte buffers via the use of non-contiguous chunks. This let's us allocate chunks from the buffer pool on demand upon read. \r\n\r\n<!-- Thanks for contributing to ImageSharp! -->\r\n", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1316/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1316/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/428", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/428/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/428/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/428/events", "html_url": "https://github.com/SixLabors/ImageSharp/issues/428", "id": 286524167, "node_id": "MDU6SXNzdWUyODY1MjQxNjc=", "number": 428, "title": "Incorrect color bleed when applying processors to images with alpha", "user": {"login": "vpenades", "id": 5433822, "node_id": "MDQ6VXNlcjU0MzM4MjI=", "avatar_url": "https://avatars.githubusercontent.com/u/5433822?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vpenades", "html_url": "https://github.com/vpenades", "followers_url": "https://api.github.com/users/vpenades/followers", "following_url": "https://api.github.com/users/vpenades/following{/other_user}", "gists_url": "https://api.github.com/users/vpenades/gists{/gist_id}", "starred_url": "https://api.github.com/users/vpenades/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vpenades/subscriptions", "organizations_url": "https://api.github.com/users/vpenades/orgs", "repos_url": "https://api.github.com/users/vpenades/repos", "events_url": "https://api.github.com/users/vpenades/events{/privacy}", "received_events_url": "https://api.github.com/users/vpenades/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}], "state": "closed", "locked": false, "assignees": [{"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/milestones/4", "html_url": "https://github.com/SixLabors/ImageSharp/milestone/4", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/milestones/4/labels", "id": 2981030, "node_id": "MDk6TWlsZXN0b25lMjk4MTAzMA==", "number": 4, "title": "1.0.0-beta3", "description": "", "creator": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 16, "state": "closed", "created_at": "2017-12-15T01:43:12Z", "updated_at": "2018-05-09T00:33:34Z", "due_on": null, "closed_at": "2018-05-09T00:28:30Z"}, "comments": 23, "created_at": "2018-01-06T22:19:46Z", "updated_at": "2018-01-24T01:36:45Z", "closed_at": "2018-01-24T01:35:31Z", "assignee": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive issue title\r\n- [x] I have verified that I am running the latest version of ImageSharp\r\n- [x] I have verified if the problem exist in both `DEBUG` and `RELEASE` mode\r\n- [x] I have searched [open](https://github.com/SixLabors/ImageSharp/issues) and [closed](https://github.com/SixLabors/ImageSharp/issues?q=is%3Aissue+is%3Aclosed) issues to ensure it has not already been reported\r\n\r\n### Description\r\n\r\nWhen dealing with images that containt transparent pixels, some filters don't work correctly. Essentially, all processors that take the surrounding of a given pixel as input (the kernel) and return a single pixel color as output.\r\n\r\nUsually, in images with transparent pixels, the fully transparent pixels have a black color,\r\n\r\nThe problem is that the kernels of these processors indiscriminately take all the pixel colors and handle each channel separately, without taking into account if the pixels are transparent, and should be discarded.\r\n\r\nI am aware that handling alpha in such important filters as Resize and Blur might be difficult, and if handling transparency correctly, might end slowing down considerably.\r\n\r\nSolution1: to make all these processors handle transparency correctly, by weighting in the transparency amount into the kernel solution. For example, if a BoxBlur kernel peeks 25 pixels, and all but 2 pixels are fully transparent, only the colors of these two non transparent pixels should be accounted for in the final solution.\r\n\r\nSolution2: before applying any of these filters, do some sort of preprocessing that would \"bleed\" the non transparent colors to the transparent surrounding. Even if all these pixels remain transparent, when aplying processors like blur or resize, the end result will have much better looking borders.\r\n\r\nHere's an example of how the transparent pixels look like when they're all made opaque. This particular solution is typical for texture mipmaps.\r\n\r\n![nd2cd](https://user-images.githubusercontent.com/5433822/34644458-5668c68e-f337-11e7-9331-69ac09c471b5.jpg)\r\n\r\n### Steps to Reproduce\r\n\r\nCase 1: Blur Filters\r\n1- Create a new 256x256 image.\r\n2- Draw a 32x32 white rectangle at the center of the image.\r\n3- Apply a GaussianBlur.\r\n\r\nResult: the blur around the white rectangle has a gradient to Black.\r\n![preview](https://user-images.githubusercontent.com/5433822/34644371-c2a3d5ca-f335-11e7-86e5-54f33d710563.jpg)\r\n\r\nExpected: all the visible pixels should be white.\r\n\r\nCase 2: Resize Filters\r\n1- Create a new 256x256 image.\r\n2- Draw some thin lines, text, or whatever that has a high frequency detail.\r\n3- Downsize the image to 250x250.\r\n\r\nResult: the resize filter has peeked a bit of the surrounding of the text, which is transparent black, that has bleeded to the final image.\r\n![preview](https://user-images.githubusercontent.com/5433822/34644354-510566b8-f335-11e7-81a0-7c19cd9827df.jpg)\r\nExpected: all the pixels should be white.\r\n\r\n### System Configuration\r\n\r\n- ImageSharp version: 1.0.0 beta 2\r\n- Other ImageSharp packages and versions:\r\n- Environment (Operating system, version and so on):\r\n- .NET Framework version:\r\n- Additional information:\r\n\r\n<!-- Thanks for reporting the issue to ImageSharp! -->\r\n", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/428/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/428/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/24", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/24/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/24/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/24/events", "html_url": "https://github.com/SixLabors/ImageSharp/issues/24", "id": 188758454, "node_id": "MDU6SXNzdWUxODg3NTg0NTQ=", "number": 24, "title": "Png's are encoding wrong after 1.0.0-alpha-000047", "user": {"login": "KLuuKer", "id": 12729178, "node_id": "MDQ6VXNlcjEyNzI5MTc4", "avatar_url": "https://avatars.githubusercontent.com/u/12729178?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KLuuKer", "html_url": "https://github.com/KLuuKer", "followers_url": "https://api.github.com/users/KLuuKer/followers", "following_url": "https://api.github.com/users/KLuuKer/following{/other_user}", "gists_url": "https://api.github.com/users/KLuuKer/gists{/gist_id}", "starred_url": "https://api.github.com/users/KLuuKer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KLuuKer/subscriptions", "organizations_url": "https://api.github.com/users/KLuuKer/orgs", "repos_url": "https://api.github.com/users/KLuuKer/repos", "events_url": "https://api.github.com/users/KLuuKer/events{/privacy}", "received_events_url": "https://api.github.com/users/KLuuKer/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 471597544, "node_id": "MDU6TGFiZWw0NzE1OTc1NDQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/area:formats", "name": "area:formats", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 23, "created_at": "2016-11-11T13:18:32Z", "updated_at": "2016-11-15T10:04:11Z", "closed_at": "2016-11-15T10:03:05Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "png's are encoded incorrectly on version v1.0.0-alpha-000053 and higher (including 57)\r\n\r\nlast know good version is v1.0.0-alpha-000052\r\nso i think something went wrong in this commit https://github.com/JimBobSquarePants/ImageSharp/commit/f814dc3609c53d33ba42ac0bdf24f6b799f8420a\r\n\r\nk so after version v1.0.0-alpha-000053 the error's get really obvious (weird colored blocks)\r\nbut before that some images are still encoded incorrectly (getting chopped off) and smaller resize actions turning into black images\r\n\r\ncurrently checking how far back this starts occuring", "closed_by": {"login": "KLuuKer", "id": 12729178, "node_id": "MDQ6VXNlcjEyNzI5MTc4", "avatar_url": "https://avatars.githubusercontent.com/u/12729178?v=4", "gravatar_id": "", "url": "https://api.github.com/users/KLuuKer", "html_url": "https://github.com/KLuuKer", "followers_url": "https://api.github.com/users/KLuuKer/followers", "following_url": "https://api.github.com/users/KLuuKer/following{/other_user}", "gists_url": "https://api.github.com/users/KLuuKer/gists{/gist_id}", "starred_url": "https://api.github.com/users/KLuuKer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/KLuuKer/subscriptions", "organizations_url": "https://api.github.com/users/KLuuKer/orgs", "repos_url": "https://api.github.com/users/KLuuKer/repos", "events_url": "https://api.github.com/users/KLuuKer/events{/privacy}", "received_events_url": "https://api.github.com/users/KLuuKer/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/24/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/24/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/3008", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/3008/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/3008/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/3008/events", "html_url": "https://github.com/SixLabors/ImageSharp/pull/3008", "id": 3565729170, "node_id": "PR_kwDOBE1KVM6wW3Uh", "number": 3008, "title": "Fix detection of canonical sRGB profiles", "user": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 635725317, "node_id": "MDU6TGFiZWw2MzU3MjUzMTc=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/metadata:icc", "name": "metadata:icc", "color": "bfd4f2", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 2, "created_at": "2025-10-29T12:24:15Z", "updated_at": "2025-11-03T13:04:51Z", "closed_at": "2025-11-03T13:04:50Z", "assignee": null, "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/pulls/3008", "html_url": "https://github.com/SixLabors/ImageSharp/pull/3008", "diff_url": "https://github.com/SixLabors/ImageSharp/pull/3008.diff", "patch_url": "https://github.com/SixLabors/ImageSharp/pull/3008.patch", "merged_at": "2025-11-03T13:04:50Z"}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive pull-request title\r\n- [x] I have verified that there are no overlapping [pull-requests](https://github.com/SixLabors/ImageSharp/pulls) open\r\n- [x] I have verified that I am following the existing coding patterns and practice as demonstrated in the repository. These follow strict Stylecop rules :cop:.\r\n- [x] I have provided test coverage for my change (where applicable)\r\n\r\n### Description\r\n<!-- A description of the changes proposed in the pull-request -->\r\nSee #2999 \r\n\r\nThis PR refines the detection of canonical sRGB ICC profiles in ImageSharp by introducing a robust method for identifying standard sRGB matrix+TRC profiles, replacing the previous heuristic approach. It also improves test coverage with new images and reference outputs for various ICC profile scenarios.\r\n\r\n* Added a new method `IsCanonicalSrgbMatrixTrc()` to `IccProfile` that accurately detects canonical IEC 61966-2-1 (sRGB) matrix+TRC ICC profiles by checking profile IDs, required tags, and colorant/TRC values, including handling D65 white point adaptation. This method is more robust than the previous header-based heuristic.\r\n* Changed logic in `DecoderOptions` to use `profile.IsCanonicalSrgbMatrixTrc()` instead of the old `IccProfileHeader.IsLikelySrgb()` for determining sRGB profiles, ensuring more accurate color management decisions.\r\n* Removed the old heuristic `IsLikelySrgb` and related sRGB constants from `IccProfileHeader`, as detection is now handled in `IccProfile`.\r\n* Made `IccProfile` a partial class to support the new logic extension.\r\n* Added new test images and reference outputs for ICC profiles, including perceptual (matrix + cLUT  & cLUT-only) profiles and sRGB gray, to ensure the new detection logic is thoroughly validated. \r\n* Made the extension methods to `ColorProfileConverter` public.\r\n<!-- Thanks for contributing to ImageSharp! -->\r\n", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/3008/reactions", "total_count": 3, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 2, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/3008/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/18", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/18/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/18/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/18/events", "html_url": "https://github.com/SixLabors/ImageSharp/issues/18", "id": 186282718, "node_id": "MDU6SXNzdWUxODYyODI3MTg=", "number": 18, "title": "Progressive jpeg with missing EOI marker throws EOFException", "user": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 471597544, "node_id": "MDU6TGFiZWw0NzE1OTc1NDQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/area:formats", "name": "area:formats", "color": "5319e7", "default": false, "description": null}], "state": "closed", "locked": false, "assignees": [{"login": "antonfirsov", "id": 6835152, "node_id": "MDQ6VXNlcjY4MzUxNTI=", "avatar_url": "https://avatars.githubusercontent.com/u/6835152?v=4", "gravatar_id": "", "url": "https://api.github.com/users/antonfirsov", "html_url": "https://github.com/antonfirsov", "followers_url": "https://api.github.com/users/antonfirsov/followers", "following_url": "https://api.github.com/users/antonfirsov/following{/other_user}", "gists_url": "https://api.github.com/users/antonfirsov/gists{/gist_id}", "starred_url": "https://api.github.com/users/antonfirsov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/antonfirsov/subscriptions", "organizations_url": "https://api.github.com/users/antonfirsov/orgs", "repos_url": "https://api.github.com/users/antonfirsov/repos", "events_url": "https://api.github.com/users/antonfirsov/events{/privacy}", "received_events_url": "https://api.github.com/users/antonfirsov/received_events", "type": "User", "user_view_type": "public", "site_admin": false}], "milestone": null, "comments": 22, "created_at": "2016-10-31T13:26:29Z", "updated_at": "2017-02-05T10:09:27Z", "closed_at": "2017-01-28T06:22:10Z", "assignee": {"login": "antonfirsov", "id": 6835152, "node_id": "MDQ6VXNlcjY4MzUxNTI=", "avatar_url": "https://avatars.githubusercontent.com/u/6835152?v=4", "gravatar_id": "", "url": "https://api.github.com/users/antonfirsov", "html_url": "https://github.com/antonfirsov", "followers_url": "https://api.github.com/users/antonfirsov/followers", "following_url": "https://api.github.com/users/antonfirsov/following{/other_user}", "gists_url": "https://api.github.com/users/antonfirsov/gists{/gist_id}", "starred_url": "https://api.github.com/users/antonfirsov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/antonfirsov/subscriptions", "organizations_url": "https://api.github.com/users/antonfirsov/orgs", "repos_url": "https://api.github.com/users/antonfirsov/repos", "events_url": "https://api.github.com/users/antonfirsov/events{/privacy}", "received_events_url": "https://api.github.com/users/antonfirsov/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "author_association": "MEMBER", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "_From @gdoron on October 31, 2016 12:57_\n\nHi James @JimBobSquarePants,\r\n\r\nThis specific image: \r\n![image](https://cloud.githubusercontent.com/assets/6141009/19854753/59fbad1a-9f79-11e6-91bc-bdb8f6421ee4.png)\r\nfails when trying to load it.\r\n\r\nStacktrace:\r\n\r\n>ImageProcessorCore.Formats.JpegDecoderCore+EOFException: Exception of type 'ImageProcessorCore.Formats.JpegDecoderCore+EOFException' was thrown.\r\n   at ImageProcessorCore.Formats.JpegDecoderCore.Fill()\r\n   at ImageProcessorCore.Formats.JpegDecoderCore.ReadByte()\r\n   at ImageProcessorCore.Formats.JpegDecoderCore.ReadByteStuffedByte()\r\n   at ImageProcessorCore.Formats.JpegDecoderCore.EnsureNBits(Int32 n)\r\n   at ImageProcessorCore.Formats.JpegDecoderCore.DecodeHuffman(Huffman huffman)\r\n   at ImageProcessorCore.Formats.JpegDecoderCore.Refine(Block b, Huffman h, Int32 zigStart, Int32 zigEnd, Int32 delta)\r\n   at ImageProcessorCore.Formats.JpegDecoderCore.ProcessStartOfScan(Int32 n)\r\n   at ImageProcessorCore.Formats.JpegDecoderCore.Decode[TColor,TPacked](Image`2 image, Stream stream, Boolean configOnly)\r\n   at ImageProcessorCore.Image`2.Decode(Stream stream)\r\n   at ImageProcessorCore.Image`2.Load(Stream stream)\r\n   at Yooocan.Logic.ImageLogic.Resize(Stream stream, Int32 quality, Nullable`1 width, Nullable`1 height)\r\n\r\nAny clue?\r\n\r\nBy the way, checkout this story: https://yooocan.com/Story/329/Having-Wheels-Has-Its-Perks\r\nAmazing people, and you're helping them James!\r\n\r\nTHANKS A LOT!\n\n_Copied from original issue: JimBobSquarePants/ImageProcessor#505_", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/18/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/18/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2297", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2297/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2297/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2297/events", "html_url": "https://github.com/SixLabors/ImageSharp/issues/2297", "id": 1451947685, "node_id": "I_kwDOBE1KVM5Wival", "number": 2297, "title": "created/overwritten/copied TIFF images are invalid for Adobe Premiere Pro", "user": {"login": "MaciejSzulborski", "id": 77407760, "node_id": "MDQ6VXNlcjc3NDA3NzYw", "avatar_url": "https://avatars.githubusercontent.com/u/77407760?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MaciejSzulborski", "html_url": "https://github.com/MaciejSzulborski", "followers_url": "https://api.github.com/users/MaciejSzulborski/followers", "following_url": "https://api.github.com/users/MaciejSzulborski/following{/other_user}", "gists_url": "https://api.github.com/users/MaciejSzulborski/gists{/gist_id}", "starred_url": "https://api.github.com/users/MaciejSzulborski/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MaciejSzulborski/subscriptions", "organizations_url": "https://api.github.com/users/MaciejSzulborski/orgs", "repos_url": "https://api.github.com/users/MaciejSzulborski/repos", "events_url": "https://api.github.com/users/MaciejSzulborski/events{/privacy}", "received_events_url": "https://api.github.com/users/MaciejSzulborski/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 592896550, "node_id": "MDU6TGFiZWw1OTI4OTY1NTA=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/formats:tiff", "name": "formats:tiff", "color": "bfdadc", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 20, "created_at": "2022-11-16T16:53:50Z", "updated_at": "2022-11-21T05:12:29Z", "closed_at": "2022-11-21T05:12:29Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "### Prerequisites\n\n- [X] I have written a descriptive issue title\n- [X] I have verified that I am running the latest version of ImageSharp\n- [X] I have verified if the problem exist in both `DEBUG` and `RELEASE` mode\n- [X] I have searched [open](https://github.com/SixLabors/ImageSharp/issues) and [closed](https://github.com/SixLabors/ImageSharp/issues?q=is%3Aissue+is%3Aclosed) issues to ensure it has not already been reported\n\n### ImageSharp version\n\n2.1.3\n\n### Other ImageSharp packages and versions\n\nSixLabors.ImageSharp 2.1.3, SixLabors.ImageSharp.Drawing 1.0.0-beta14, SixLabors.Fonts 1.0.0-beta17\n\n### Environment (Operating system, version and so on)\n\nWindows Server 2019 Standard 1809\n\n### .NET Framework version\n\n.Net 6.0, .Net Framework 4.8\n\n### Description\n\nTiff files created by ImageSharp are not recognized by Adobe Premiere Pro on any try of import.\r\nIf you try to import a tiff file an error will pop up: \"The file cannot be opened because of a header error\"\r\nIf you take a tiff file created by ImageSharp, open it with Paint or Adobe Photoshop and save it without any changes, choosing TIFF format, Importing files to Premiere Pro becomes possible.\r\nIt seems there is an issue, when encoding the tiff image by ImageSharp since other software can save the image in format properly. I could not find any differences in metadata that would indicate which parameter is invalid.\n\n### Steps to Reproduce\n\n`using Image<Rgba32> image = new(1920, 1080);`\r\n`using MemoryStream stream = new();`\r\n`image.SaveAsTiff(output);`\n\n### Images\n\n![Premiere Pro error](https://user-images.githubusercontent.com/77407760/202243562-ef7ccfb3-580e-426d-814c-be6606d5eddf.png)\r\n", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2297/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2297/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/572", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/572/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/572/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/572/events", "html_url": "https://github.com/SixLabors/ImageSharp/issues/572", "id": 322512884, "node_id": "MDU6SXNzdWUzMjI1MTI4ODQ=", "number": 572, "title": "Font rendering artifacts when calling DrawText() with a long multi-line string", "user": {"login": "FisherMS", "id": 12068896, "node_id": "MDQ6VXNlcjEyMDY4ODk2", "avatar_url": "https://avatars.githubusercontent.com/u/12068896?v=4", "gravatar_id": "", "url": "https://api.github.com/users/FisherMS", "html_url": "https://github.com/FisherMS", "followers_url": "https://api.github.com/users/FisherMS/followers", "following_url": "https://api.github.com/users/FisherMS/following{/other_user}", "gists_url": "https://api.github.com/users/FisherMS/gists{/gist_id}", "starred_url": "https://api.github.com/users/FisherMS/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/FisherMS/subscriptions", "organizations_url": "https://api.github.com/users/FisherMS/orgs", "repos_url": "https://api.github.com/users/FisherMS/repos", "events_url": "https://api.github.com/users/FisherMS/events{/privacy}", "received_events_url": "https://api.github.com/users/FisherMS/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/milestones/5", "html_url": "https://github.com/SixLabors/ImageSharp/milestone/5", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/milestones/5/labels", "id": 3331764, "node_id": "MDk6TWlsZXN0b25lMzMzMTc2NA==", "number": 5, "title": "1.0.0-beta4", "description": "Beta to test against .NET Core 2.1 Rc1", "creator": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 6, "state": "closed", "created_at": "2018-05-09T00:30:22Z", "updated_at": "2020-01-17T22:24:17Z", "due_on": "2018-05-18T00:00:00Z", "closed_at": "2018-05-30T08:41:11Z"}, "comments": 20, "created_at": "2018-05-12T13:48:21Z", "updated_at": "2018-05-26T21:46:09Z", "closed_at": "2018-05-26T21:46:09Z", "assignee": null, "author_association": "NONE", "type": null, "active_lock_reason": null, "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "issue_dependencies_summary": {"blocked_by": 0, "total_blocked_by": 0, "blocking": 0, "total_blocking": 0}, "body": "\r\n### Prerequisites\r\n\r\n- [x] I have written a descriptive issue title\r\n- [x] I have verified that I am running the latest version of ImageSharp\r\n- [x] I have verified if the problem exist in both `DEBUG` and `RELEASE` mode\r\n- [x] I have searched [open](https://github.com/SixLabors/ImageSharp/issues) and [closed](https://github.com/SixLabors/ImageSharp/issues?q=is%3Aissue+is%3Aclosed) issues to ensure it has not already been reported\r\n\r\n### Description\r\nIf the texts are covered with the entire A4 paper(300dpi), the words on the bottom right becomes pasted.\r\n\r\n### Steps to Reproduce\r\nKey code:\r\n```C#\r\nTextOptions = new TextGraphicsOptions\r\n            {\r\n                Antialias = true,\r\n                ApplyKerning = true, \r\n                VerticalAlignment = VerticalAlignment.Top,\r\n                HorizontalAlignment = HorizontalAlignment.Left,\r\n                WrapTextWidth = PageSize.Width\r\n            };\r\n\r\n\r\n using (Image<Rgba32> img = new Image<Rgba32>(PageSize.Width, PageSize.Height))\r\n            {\r\n                img.MetaData.HorizontalResolution = 300;\r\n                img.MetaData.VerticalResolution = 300;\r\n\r\n                img.Mutate(x =>\r\n                    x.Fill(Rgba32.White)\r\n                        .DrawText(TextOptions, text, Font, Rgba32.Black, new PointF(10, 5))\r\n\r\n                );\r\n                img.Save($\"output/0.png\");            \r\n\r\n```\r\n\r\n### System Configuration\r\n<!-- Tell us about the environment where you are experiencing the bug -->\r\n\r\n- ImageSharp version: SixLabors.ImageSharp.Drawing 1.0.0-beta0003\r\n- Environment (Operating system, version and so on):win10 + vs2017\r\n- .NET Framework version: .Net Core 2.0\r\n\r\n\r\n", "closed_by": {"login": "antonfirsov", "id": 6835152, "node_id": "MDQ6VXNlcjY4MzUxNTI=", "avatar_url": "https://avatars.githubusercontent.com/u/6835152?v=4", "gravatar_id": "", "url": "https://api.github.com/users/antonfirsov", "html_url": "https://github.com/antonfirsov", "followers_url": "https://api.github.com/users/antonfirsov/followers", "following_url": "https://api.github.com/users/antonfirsov/following{/other_user}", "gists_url": "https://api.github.com/users/antonfirsov/gists{/gist_id}", "starred_url": "https://api.github.com/users/antonfirsov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/antonfirsov/subscriptions", "organizations_url": "https://api.github.com/users/antonfirsov/orgs", "repos_url": "https://api.github.com/users/antonfirsov/repos", "events_url": "https://api.github.com/users/antonfirsov/events{/privacy}", "received_events_url": "https://api.github.com/users/antonfirsov/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/572/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/572/timeline", "performed_via_github_app": null, "state_reason": "completed", "pinned_comment": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2172", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2172/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2172/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2172/events", "html_url": "https://github.com/SixLabors/ImageSharp/pull/2172", "id": 1303112153, "node_id": "PR_kwDOBE1KVM47Ubfm", "number": 2172, "title": "Fix run-length encode compression implementation mistake in tga encoder", "user": {"login": "l1nxy", "id": 12152770, "node_id": "MDQ6VXNlcjEyMTUyNzcw", "avatar_url": "https://avatars.githubusercontent.com/u/12152770?v=4", "gravatar_id": "", "url": "https://api.github.com/users/l1nxy", "html_url": "https://github.com/l1nxy", "followers_url": "https://api.github.com/users/l1nxy/followers", "following_url": "https://api.github.com/users/l1nxy/following{/other_user}", "gists_url": "https://api.github.com/users/l1nxy/gists{/gist_id}", "starred_url": "https://api.github.com/users/l1nxy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/l1nxy/subscriptions", "organizations_url": "https://api.github.com/users/l1nxy/orgs", "repos_url": "https://api.github.com/users/l1nxy/repos", "events_url": "https://api.github.com/users/l1nxy/events{/privacy}", "received_events_url": "https://api.github.com/users/l1nxy/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 1673050000, "node_id": "MDU6TGFiZWwxNjczMDUwMDAw", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/formats:tga", "name": "formats:tga", "color": "ff82be", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 15, "created_at": "2022-07-13T08:47:13Z", "updated_at": "2022-07-30T14:52:52Z", "closed_at": "2022-07-30T14:52:52Z", "assignee": null, "author_association": "CONTRIBUTOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/pulls/2172", "html_url": "https://github.com/SixLabors/ImageSharp/pull/2172", "diff_url": "https://github.com/SixLabors/ImageSharp/pull/2172.diff", "patch_url": "https://github.com/SixLabors/ImageSharp/pull/2172.patch", "merged_at": "2022-07-30T14:52:52Z"}, "body": "### Prerequisites\r\n\r\n- [X] I have written a descriptive pull-request title\r\n- [X] I have verified that there are no overlapping [pull-requests](https://github.com/SixLabors/ImageSharp/pulls) open\r\n- [X] I have verified that I am following the existing coding patterns and practice as demonstrated in the repository. These follow strict Stylecop rules :cop:.\r\n- [X] I have provided test coverage for my change (where applicable)\r\n\r\n### Description\r\n<!-- A description of the changes proposed in the pull-request -->\r\nAccording to the [Tga format spec](https://www.dca.fee.unicamp.br/~martino/disciplinas/ea978/tgaffs.pdf) page 24:\r\n\r\n> Run-length Packets should never encode pixels from more than one scan line. Even if the end of one\r\nscan line and the beginning of the next contain pixels of the same value, the two should be encoded\r\nas separate packets. In other words, Run-length Packets should not wrap from one line to another.\r\nThis scheme allows software to create and use a scan line table for rapid, random access of\r\nindividual lines. Scan line tables are discussed in further detail in the Extension Area section of this\r\ndocument.\r\n\r\n\r\nIt should not cross multiple lines when using Run-length encode compression. Some libraries can not fix the rle mistake when importing images saved by ImageSharp, and will throw an exception.\r\n\r\n<!-- Thanks for contributing to ImageSharp! -->\r\n", "closed_by": {"login": "brianpopow", "id": 38701097, "node_id": "MDQ6VXNlcjM4NzAxMDk3", "avatar_url": "https://avatars.githubusercontent.com/u/38701097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brianpopow", "html_url": "https://github.com/brianpopow", "followers_url": "https://api.github.com/users/brianpopow/followers", "following_url": "https://api.github.com/users/brianpopow/following{/other_user}", "gists_url": "https://api.github.com/users/brianpopow/gists{/gist_id}", "starred_url": "https://api.github.com/users/brianpopow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brianpopow/subscriptions", "organizations_url": "https://api.github.com/users/brianpopow/orgs", "repos_url": "https://api.github.com/users/brianpopow/repos", "events_url": "https://api.github.com/users/brianpopow/events{/privacy}", "received_events_url": "https://api.github.com/users/brianpopow/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2172/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/2172/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1431", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1431/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1431/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1431/events", "html_url": "https://github.com/SixLabors/ImageSharp/pull/1431", "id": 743899296, "node_id": "MDExOlB1bGxSZXF1ZXN0NTIxNzEzNTM1", "number": 1431, "title": "Use GetPixelRowSpan to access pixel data in Histogram equalization", "user": {"login": "brianpopow", "id": 38701097, "node_id": "MDQ6VXNlcjM4NzAxMDk3", "avatar_url": "https://avatars.githubusercontent.com/u/38701097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brianpopow", "html_url": "https://github.com/brianpopow", "followers_url": "https://api.github.com/users/brianpopow/followers", "following_url": "https://api.github.com/users/brianpopow/following{/other_user}", "gists_url": "https://api.github.com/users/brianpopow/gists{/gist_id}", "starred_url": "https://api.github.com/users/brianpopow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brianpopow/subscriptions", "organizations_url": "https://api.github.com/users/brianpopow/orgs", "repos_url": "https://api.github.com/users/brianpopow/repos", "events_url": "https://api.github.com/users/brianpopow/events{/privacy}", "received_events_url": "https://api.github.com/users/brianpopow/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": null, "comments": 8, "created_at": "2020-11-16T14:51:27Z", "updated_at": "2020-11-16T18:18:57Z", "closed_at": "2020-11-16T18:18:56Z", "assignee": null, "author_association": "COLLABORATOR", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/pulls/1431", "html_url": "https://github.com/SixLabors/ImageSharp/pull/1431", "diff_url": "https://github.com/SixLabors/ImageSharp/pull/1431.diff", "patch_url": "https://github.com/SixLabors/ImageSharp/pull/1431.patch", "merged_at": "2020-11-16T18:18:56Z"}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive pull-request title\r\n- [x] I have verified that there are no overlapping [pull-requests](https://github.com/SixLabors/ImageSharp/pulls) open\r\n- [x] I have verified that I am following matches the existing coding patterns and practice as demonstrated in the repository. These follow strict Stylecop rules :cop:.\r\n- [x] I have provided test coverage for my change (where applicable)\r\n\r\n### Description\r\n\r\nThis PR changes the histogram equalization to use GetPixelRowSpan to access pixel data to fix an Access Violation issue for very large images reported in #1429.", "closed_by": {"login": "brianpopow", "id": 38701097, "node_id": "MDQ6VXNlcjM4NzAxMDk3", "avatar_url": "https://avatars.githubusercontent.com/u/38701097?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brianpopow", "html_url": "https://github.com/brianpopow", "followers_url": "https://api.github.com/users/brianpopow/followers", "following_url": "https://api.github.com/users/brianpopow/following{/other_user}", "gists_url": "https://api.github.com/users/brianpopow/gists{/gist_id}", "starred_url": "https://api.github.com/users/brianpopow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brianpopow/subscriptions", "organizations_url": "https://api.github.com/users/brianpopow/orgs", "repos_url": "https://api.github.com/users/brianpopow/repos", "events_url": "https://api.github.com/users/brianpopow/events{/privacy}", "received_events_url": "https://api.github.com/users/brianpopow/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1431/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1431/timeline", "performed_via_github_app": null, "state_reason": null}, {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1114", "repository_url": "https://api.github.com/repos/SixLabors/ImageSharp", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1114/labels{/name}", "comments_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1114/comments", "events_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1114/events", "html_url": "https://github.com/SixLabors/ImageSharp/pull/1114", "id": 565896909, "node_id": "MDExOlB1bGxSZXF1ZXN0Mzc1ODE5Nzgy", "number": 1114, "title": "Fix quantization and dithering.", "user": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 470481754, "node_id": "MDU6TGFiZWw0NzA0ODE3NTQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/bug", "name": "bug", "color": "ee0701", "default": true, "description": ""}, {"id": 470481756, "node_id": "MDU6TGFiZWw0NzA0ODE3NTY=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/enhancement", "name": "enhancement", "color": "84b6eb", "default": true, "description": ""}, {"id": 471129207, "node_id": "MDU6TGFiZWw0NzExMjkyMDc=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/area:performance", "name": "area:performance", "color": "006b75", "default": false, "description": ""}, {"id": 471597544, "node_id": "MDU6TGFiZWw0NzE1OTc1NDQ=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/area:formats", "name": "area:formats", "color": "5319e7", "default": false, "description": null}, {"id": 949144023, "node_id": "MDU6TGFiZWw5NDkxNDQwMjM=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/area:quantizers", "name": "area:quantizers", "color": "bfd4f2", "default": false, "description": ""}, {"id": 987707507, "node_id": "MDU6TGFiZWw5ODc3MDc1MDc=", "url": "https://api.github.com/repos/SixLabors/ImageSharp/labels/API", "name": "API", "color": "f23cd0", "default": false, "description": ""}], "state": "closed", "locked": false, "assignees": [], "milestone": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/milestones/6", "html_url": "https://github.com/SixLabors/ImageSharp/milestone/6", "labels_url": "https://api.github.com/repos/SixLabors/ImageSharp/milestones/6/labels", "id": 3386731, "node_id": "MDk6TWlsZXN0b25lMzM4NjczMQ==", "number": 6, "title": "1.0.0-rc1", "description": "The first Release Candidate. With Go-Live license!", "creator": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "open_issues": 0, "closed_issues": 222, "state": "closed", "created_at": "2018-05-30T08:58:52Z", "updated_at": "2020-05-01T09:42:54Z", "due_on": "2020-05-01T00:00:00Z", "closed_at": "2020-05-01T09:42:54Z"}, "comments": 1, "created_at": "2020-02-16T12:23:40Z", "updated_at": "2020-02-20T04:45:00Z", "closed_at": "2020-02-20T04:44:58Z", "assignee": null, "author_association": "MEMBER", "type": null, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/pulls/1114", "html_url": "https://github.com/SixLabors/ImageSharp/pull/1114", "diff_url": "https://github.com/SixLabors/ImageSharp/pull/1114.diff", "patch_url": "https://github.com/SixLabors/ImageSharp/pull/1114.patch", "merged_at": "2020-02-20T04:44:58Z"}, "body": "### Prerequisites\r\n\r\n- [x] I have written a descriptive pull-request title\r\n- [x] I have verified that there are no overlapping [pull-requests](https://github.com/SixLabors/ImageSharp/pulls) open\r\n- [x] I have verified that I am following matches the existing coding patterns and practice as demonstrated in the repository. These follow strict Stylecop rules :cop:.\r\n- [x] I have provided test coverage for my change (where applicable)\r\n\r\n### Description\r\nA deep investigation into our quantization and dithering algorithms yielded issues we needed to fix.\r\n\r\n- Error Diffusion algorithm offset was incorrect.\r\n- Ordered Dithering algorithm was completely incorrect. \r\n- Quantization could not utilize both algorithms.\r\n- Quantization could not be isolated to a given bounds.\r\n- `Color.Transparent` did not match W3C specification, rather copied incorrect System.Drawing value.\r\n- Tests were leaking memory.\r\n\r\nThis PR:\r\n\r\n- Updates Error Diffusion algorithm with correct implementation.\r\n- Updates Ordered Dithering algorithm with correct implementation.\r\n- Merges `IErrorDiffusion` and `IOrderedDither` APIs into new `IDither` api.\r\n- Updates and simplifies dithering processor to use new API\r\n- Updates and simplifies format quantization and quantization processor to use new API.\r\n- Introduces new `QuantizerOptions` for easier bundling of options.\r\n- Introduces new dither scaling options to allow variable dithering.\r\n- Fixed `Color.Transparent` value.\r\n- Improves performance across the board.\r\n- Fixes memory leak in Bitmap Encoder\r\n- Fixes memory leak in Quantizer tests.\r\n\r\n### Examples\r\nHere's an example of the new dithering output vs the old using `BayerDither8x8` ordered dithering. Note the much improved handling of gradients.\r\n\r\n**Old**\r\n![DitherFilter_WorksWithAllDitherers_Bike_BayerDither8x8-Old](https://user-images.githubusercontent.com/385879/74604186-8a027e80-510f-11ea-86c2-bd5704365fa4.png)\r\n\r\n**New**\r\n![DitherFilter_WorksWithAllDitherers_Bike_BayerDither8x8-New](https://user-images.githubusercontent.com/385879/74604208-b4543c00-510f-11ea-9e5a-37c6584cc5a5.png)\r\n\r\nWith the new `DitherScale` options built into `QuantizerOptions` it's possible to incrementally dither output.\r\n\r\nHere's incremental quantization and dithering of a sample image. I've used the websafe palette to accentuate differences.\r\n\r\n**Original**\r\n![david](https://user-images.githubusercontent.com/385879/74604246-1614a600-5110-11ea-8fc8-e9a67c3d6318.png)\r\n\r\n**0%**\r\n![FloydSteinbergDither 0%](https://user-images.githubusercontent.com/385879/74604326-0ba6dc00-5111-11ea-9298-7b29302fdfc5.png)\r\n\r\n**25%**\r\n![FloydSteinbergDither 25%](https://user-images.githubusercontent.com/385879/74604324-0a75af00-5111-11ea-9c51-3931310183ce.png)\r\n\r\n**50%**\r\n![FloydSteinbergDither 50%](https://user-images.githubusercontent.com/385879/74604323-09448200-5111-11ea-81bf-6203db14f900.png)\r\n\r\n**75%**\r\n![FloydSteinbergDither 75%](https://user-images.githubusercontent.com/385879/74604325-0b0e4580-5111-11ea-86fd-16892de03cef.png)\r\n\r\n**100%**\r\n![FloydSteinbergDither 100%](https://user-images.githubusercontent.com/385879/74604327-0c3f7280-5111-11ea-9385-c841fb843d91.png)\r\n\r\n### Benchmarks\r\n\r\n_Note: Previous benchmarks did not have Core 3.1 versions. Memory increase is due to changing of color lookup caching strategy._\r\n\r\n``` bash\r\nBenchmarkDotNet=v0.12.0, OS=Windows 10.0.18363\r\nIntel Core i7-8650U CPU 1.90GHz(Kaby Lake R), 1 CPU, 8 logical and 4 physical cores\r\n.NET Core SDK = 3.1.101\r\n\r\n[Host]     : .NET Core 3.1.1 (CoreCLR 4.700.19.60701, CoreFX 4.700.19.60801), X64 RyuJIT\r\nJob-OJKYBT : .NET Framework 4.8 (4.8.4121.0), X64 RyuJIT\r\nJob-RZWLFP : .NET Core 2.1.15 (CoreCLR 4.6.28325.01, CoreFX 4.6.28327.02), X64 RyuJIT\r\nJob-NUYUQV : .NET Core 3.1.1 (CoreCLR 4.700.19.60701, CoreFX 4.700.19.60801), X64 RyuJIT\r\n\r\nIterationCount=3  LaunchCount=1  WarmupCount=3\r\n```\r\n**Before**\r\n|    Method |  Job | Runtime |      Mean |     Error |    StdDev | Gen 0 | Gen 1 | Gen 2 | Allocated |\r\n|---------- |----- |-------- |----------:|----------:|----------:|------:|------:|------:|----------:|\r\n| DoDiffuse |  Clr |     Clr | 124.93 ms | 33.297 ms | 1.8251 ms |     - |     - |     - |      2 KB |\r\n| DoDiffuse | Core |    Core |  89.63 ms |  9.895 ms | 0.5424 ms |     - |     - |     - |   1.91 KB |\r\n\r\n**After**\r\n|    Method |       Runtime |      Mean |     Error |    StdDev | Gen 0 | Gen 1 | Gen 2 | Allocated |\r\n|---------- |-------------- |----------:|----------:|----------:|------:|------:|------:|----------:|\r\n| DoDiffuse |    .NET 4.7.2 | 30.535 ms | 19.217 ms | 1.0534 ms |     - |     - |     - |  26.25 KB |\r\n|  DoDither |    .NET 4.7.2 | 14.174 ms |  1.625 ms | 0.0891 ms |     - |     - |     - |  31.38 KB |\r\n| DoDiffuse | .NET Core 2.1 | 15.984 ms |  3.686 ms | 0.2020 ms |     - |     - |     - |  25.98 KB |\r\n|  DoDither | .NET Core 2.1 |  8.646 ms |  1.635 ms | 0.0896 ms |     - |     - |     - |  28.99 KB |\r\n| DoDiffuse | .NET Core 3.1 | 16.235 ms |  9.612 ms | 0.5269 ms |     - |     - |     - |  25.96 KB |\r\n|  DoDither | .NET Core 3.1 |  8.429 ms |  1.270 ms | 0.0696 ms |     - |     - |     - |  31.61 KB |\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<!-- Thanks for contributing to ImageSharp! -->\r\n", "closed_by": {"login": "JimBobSquarePants", "id": 385879, "node_id": "MDQ6VXNlcjM4NTg3OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/385879?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JimBobSquarePants", "html_url": "https://github.com/JimBobSquarePants", "followers_url": "https://api.github.com/users/JimBobSquarePants/followers", "following_url": "https://api.github.com/users/JimBobSquarePants/following{/other_user}", "gists_url": "https://api.github.com/users/JimBobSquarePants/gists{/gist_id}", "starred_url": "https://api.github.com/users/JimBobSquarePants/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JimBobSquarePants/subscriptions", "organizations_url": "https://api.github.com/users/JimBobSquarePants/orgs", "repos_url": "https://api.github.com/users/JimBobSquarePants/repos", "events_url": "https://api.github.com/users/JimBobSquarePants/events{/privacy}", "received_events_url": "https://api.github.com/users/JimBobSquarePants/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "reactions": {"url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1114/reactions", "total_count": 2, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 2, "eyes": 0}, "timeline_url": "https://api.github.com/repos/SixLabors/ImageSharp/issues/1114/timeline", "performed_via_github_app": null, "state_reason": null}]}